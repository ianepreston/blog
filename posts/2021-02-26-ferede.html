<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2021-02-26">
<meta name="description" content="I wanted to practice my python and econometrics, found a data error that invalidated the paper’s findings as well.">

<title>Alberta’s Fiscal Responses To Fluctuations In Non-Renewable-Resource Revenue – Ian’s blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-659650fc26dc25888fc1474f317bb8ac.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Ian’s blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ianepreston"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Alberta’s Fiscal Responses To Fluctuations In Non-Renewable-Resource Revenue</h1>
                  <div>
        <div class="description">
          I wanted to practice my python and econometrics, found a data error that invalidated the paper’s findings as well.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">econometrics</div>
                <div class="quarto-category">jupyter</div>
                <div class="quarto-category">python</div>
                <div class="quarto-category">Alberta</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 26, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#setup-and-data-acquisition" id="toc-setup-and-data-acquisition" class="nav-link" data-scroll-target="#setup-and-data-acquisition">Setup and data acquisition</a>
  <ul class="collapse">
  <li><a href="#historical-budget-data" id="toc-historical-budget-data" class="nav-link" data-scroll-target="#historical-budget-data">Historical budget data</a></li>
  <li><a href="#real-per-capita-budget" id="toc-real-per-capita-budget" class="nav-link" data-scroll-target="#real-per-capita-budget">Real Per Capita budget</a></li>
  <li><a href="#exogenous-factors" id="toc-exogenous-factors" class="nav-link" data-scroll-target="#exogenous-factors">Exogenous factors</a></li>
  </ul></li>
  <li><a href="#exploratory-figures" id="toc-exploratory-figures" class="nav-link" data-scroll-target="#exploratory-figures">Exploratory Figures</a>
  <ul class="collapse">
  <li><a href="#figure-1" id="toc-figure-1" class="nav-link" data-scroll-target="#figure-1">Figure 1</a></li>
  <li><a href="#figure-2" id="toc-figure-2" class="nav-link" data-scroll-target="#figure-2">Figure 2</a></li>
  </ul></li>
  <li><a href="#model-specification-and-estimation" id="toc-model-specification-and-estimation" class="nav-link" data-scroll-target="#model-specification-and-estimation">Model Specification and estimation</a>
  <ul class="collapse">
  <li><a href="#sumary-statistics-for-key-variables-1970-71-2016-17-in-levels" id="toc-sumary-statistics-for-key-variables-1970-71-2016-17-in-levels" class="nav-link" data-scroll-target="#sumary-statistics-for-key-variables-1970-71-2016-17-in-levels">Sumary statistics for key variables, 1970-71, 2016-17 in levels</a></li>
  <li><a href="#sumary-statistics-for-key-variables-1970-71-2016-17-first-difference" id="toc-sumary-statistics-for-key-variables-1970-71-2016-17-first-difference" class="nav-link" data-scroll-target="#sumary-statistics-for-key-variables-1970-71-2016-17-first-difference">Sumary statistics for key variables, 1970-71, 2016-17, first difference</a></li>
  <li><a href="#unit-root-tests" id="toc-unit-root-tests" class="nav-link" data-scroll-target="#unit-root-tests">Unit-Root Tests</a></li>
  <li><a href="#the-model" id="toc-the-model" class="nav-link" data-scroll-target="#the-model">The Model</a></li>
  <li><a href="#impulse-response-functions" id="toc-impulse-response-functions" class="nav-link" data-scroll-target="#impulse-response-functions">Impulse Response Functions</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#appendix-raw-tables" id="toc-appendix-raw-tables" class="nav-link" data-scroll-target="#appendix-raw-tables">Appendix: Raw tables</a></li>
  </ul>
<div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="https://mybinder.org/v2/gh/ianepreston/blog/HEAD?urlpath=vscode" target="_blank"><i class="bi bi-journals"></i>Launch Binder</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This is my replication of the empirical results, tables, and figures produced in a paper by Dr.&nbsp;Ergete Ferede, published by the University of Calgary school of public policy in Volume 11:24, September 2018.</p>
<p>The original paper is here: <a href="https://www.policyschool.ca/wp-content/uploads/2018/09/NRR-Ferede.pdf">https://www.policyschool.ca/wp-content/uploads/2018/09/NRR-Ferede.pdf</a></p>
<p>I chose this paper to reproduce for two reasons. The first is pragmatic; the data it uses is all publicly available, so I actually can. The second is that it describes a topic of importance in the province of Alberta, where I live.</p>
<p>You can read the details of what the paper sets out to show in the paper itself, but in brief the idea is to show that provincial government spending increases in the year following an increase in non-renewable resource revenue, but it does not decrease accordingly in the year following declines in the same revenue source. This has a ratcheting effect on public finance that is a contributor to the “royalty rollercoaster” that is Alberta’s public finance.</p>
<p>In the following sections I’ll go through the code necessary to extract and transform the data set used in the paper, as well as reproduce its key empirical results. Since most economists don’t use python, and they make up a key part of my intended audience for this, I’ll be adding comments to my code that explicitly describe what some of the functions and methods I’m calling do.</p>
<p>I’m including all of the code necessary to produce this reproduction, since that’s a big part of why I’m doing this exercise, but if you’re just interested in seeing how my reproduced results compare to the original paper you can skip all the code blocks. You can find the code for this notebook on <a href="https://github.com/ianepreston/scratch/tree/main/ferede_1124_reproduction">my github</a></p>
<p>A surprising result of this reproduction is that I’ve identified a single data point error in the original paper that negates its results. Read on to find out what the error was and the impact it had on the results.</p>
</section>
<section id="setup-and-data-acquisition" class="level2">
<h2 class="anchored" data-anchor-id="setup-and-data-acquisition">Setup and data acquisition</h2>
<p>This section of the code loads required modules, downloads the required data sets, and reads them into DataFrames.</p>
<div id="cell-3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> chain</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> arch.unitroot <span class="im">import</span> DFGLS, ADF, PhillipsPerron</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas_datareader <span class="im">as</span> pdr</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> stats_can</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.api <span class="im">import</span> VAR</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>alt.renderers.enable(<span class="st">"jupyterlab"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We start by loading the required libraries that will be used to support the analysis. For reference here are links to the libraries that are being used:</p>
<ul>
<li><a href="https://docs.python.org/3/library/pathlib.html">Pathlib</a></li>
<li><a href="https://docs.python.org/3/library/datetime.html">datetime</a></li>
<li><a href="https://requests.readthedocs.io/en/master/">requests</a></li>
<li><a href="https://pandas.pydata.org/">pandas</a></li>
<li><a href="https://pandas-datareader.readthedocs.io/en/latest/">pandas_datareader</a></li>
<li><a href="https://numpy.org/">numpy</a></li>
<li><a href="https://stats-can.readthedocs.io/en/latest/">stats_can</a></li>
<li><a href="https://altair-viz.github.io/">altair</a></li>
<li><a href="https://seaborn.pydata.org/">seaborn</a></li>
<li><a href="https://arch.readthedocs.io/en/latest/index.html">arch</a></li>
<li><a href="https://www.statsmodels.org/stable/index.html">statsmodels</a></li>
<li><a href="https://matplotlib.org/stable/index.html">matplotlib</a></li>
</ul>
<section id="historical-budget-data" class="level3">
<h3 class="anchored" data-anchor-id="historical-budget-data">Historical budget data</h3>
<p>Functions in this section are concerned with acquiring historical Alberta budget data and reading it into a DataFrame</p>
<div id="cell-6" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_budget_data() <span class="op">-&gt;</span> Path:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Download the excel file for the analysis from the policy school page.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Note the readme sheet on the first file. Credit to Kneebone and Wilkins for</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    assembling it, and policy school for hosting it.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Originally used this URL, but found it was missing some later heritage</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">    contributions. After discussion with Dr. Kneebone an updated set has been provided</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">    https://www.policyschool.ca/wp-content/uploads/2019/01/Provincial-Government-Budget-Data-January-2019FINAL-USE.xlsx</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">    pathlib.Path</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">        A path object with the location and name of the data</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Downloading data set'</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">'https://www.policyschool.ca/wp-content/uploads/2019/03/Provincial-Government-Budget-Data-March-2019.xlsx'</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># send a request to the url for the file</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        url,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        stream<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        headers<span class="op">=</span>{<span class="st">'user-agent'</span>: <span class="va">None</span>}</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create a path object for the file in the data folder above</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># where this notebook is saved with the file named</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># budget.xlsx for easy later access.</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    fname <span class="op">=</span> Path(<span class="st">'.'</span>).joinpath(<span class="st">'data'</span>).joinpath(<span class="st">'budgets.xlsx'</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># write the response from the request to the file in the path specified above</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span> (fname, <span class="st">'wb'</span>) <span class="im">as</span> outfile:</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> chunk <span class="kw">in</span> response.iter_content(chunk_size<span class="op">=</span><span class="dv">512</span>):</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> chunk: <span class="co"># filter out keep-alive new chunks</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>                outfile.write(chunk)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the location of the file so we can load it later easily</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fname</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_budget_file(force_update: <span class="bu">bool</span><span class="op">=</span><span class="va">False</span>) <span class="op">-&gt;</span> Path:</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get the budget file, downloading if required.</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co">    force_update: bool</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co">        Download the data file even if you already have it</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="co">    pathlib.Path</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co">        A path object with the location and name of the data</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is where we're expecting the file to be saved if it exists</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    fname <span class="op">=</span> Path(<span class="st">'.'</span>).joinpath(<span class="st">'data'</span>).joinpath(<span class="st">'budgets.xlsx'</span>)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> fname.exists() <span class="kw">or</span> force_update:</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        download_budget_data()</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fname</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_date_index(df: pd.DataFrame) <span class="op">-&gt;</span> pd.DatetimeIndex:</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Helper function to turn budget year strings into datetimes.</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="co">    The Fiscal year columns span across years, e.g. 1965-66. In order</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="co">    to use all the date indexed functionality I want to convert them into</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co">    an actual datetime format. This function accomplishes that</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="co">    df: pd.DataFrame</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="co">        The budget dataframe with the fiscal year style columns</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DatetimeIndex</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="co">        A datetime index showing January 1 of the beginning of each</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="co">        fiscal year for each period.    </span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    date_index <span class="op">=</span> pd.to_datetime(</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>        df</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>        .assign(year<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'budget_yr'</span>].<span class="bu">str</span>[<span class="dv">0</span>:<span class="dv">4</span>].astype(<span class="bu">int</span>))</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>        .assign(month<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>        .assign(day<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>        [[<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>]]</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> date_index</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_ab_budget() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Read Alberta budget data.</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="co">    Downloads the data if necessary, reads it in and gives</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="co">    the variables easier to work with names</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a><span class="co">        Alberta's revenue and expenditure tables</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the budget file, download if necessary  using functions</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="co"># defined above</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>    fname <span class="op">=</span> get_budget_file()</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>        pd.read_excel(</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>            fname,</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>            sheet_name<span class="op">=</span><span class="st">'Alberta'</span>,</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>            <span class="co"># column titles are spaced over 3 rows</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>            header<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>            <span class="co"># first column of data is B</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>            index_col<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>            <span class="co"># there's a big footnote at the bottom we want to skip</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>            skipfooter<span class="op">=</span><span class="dv">21</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Because of the merged cells we get an empty first row</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="kw">lambda</span> x: x.index.notnull()]</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Not sure where the empty first column comes from but drop it</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>        .drop(columns<span class="op">=</span><span class="st">'Unnamed: 0'</span>)</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>        .reset_index()</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>            <span class="st">'index'</span>: <span class="st">'budget_yr'</span>,</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Personal Income Tax'</span>: <span class="st">'personal_income_tax'</span>,</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Corporation Income Tax'</span>: <span class="st">'corporate_income_tax'</span>,</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Retail Sales Tax'</span>: <span class="st">'retail_sales_tax'</span>,</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Federal Cash Transfers'</span>: <span class="st">'federal_cash_transfers'</span>,</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Natural Resource Revenue'</span>: <span class="st">'natural_resource_revenue'</span>,</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Other Own-Source Revenue'</span>: <span class="st">'other_own_source_revenue'</span>,</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total Revenue'</span>: <span class="st">'total_revenue'</span>,</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Health'</span>: <span class="st">'health_exp'</span>,</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Social Services'</span>: <span class="st">'social_services_exp'</span>,</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Education'</span>: <span class="st">'education_exp'</span>,</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Other Program Expenditures'</span>: <span class="st">'other_program_exp'</span>,</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total Program Expenditures'</span>: <span class="st">'total_prog_exp'</span>,</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Debt Service'</span>: <span class="st">'debt_service'</span>,</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total  Expenditures'</span>: <span class="st">'total_exp'</span>,</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Unnamed: 16'</span>: <span class="st">'annual_deficit'</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Turn the fiscal year string into a datetime object</span></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>        .assign(budget_dt<span class="op">=</span><span class="kw">lambda</span> df: get_date_index(df))</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>        .set_index(<span class="st">'budget_dt'</span>)</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_heritage() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Read deposits to the heritage trust fund from a separate table.</span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a><span class="co">    The paper nets out contributions to the heritage trust fund when they are</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a><span class="co">    made, so we have to read them in to be able to net them out of resource revenue.</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a><span class="co">    They're stored in the same sheet of the workbook, just down below the big table we</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a><span class="co">    read in with the function above.</span></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>    fname <span class="op">=</span> get_budget_file()</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>        pd.read_excel(</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>            fname,</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>            sheet_name<span class="op">=</span><span class="st">'Alberta'</span>,</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Have to manually specify column names because of</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>            <span class="co"># how the table is laid out</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>            header<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>            usecols<span class="op">=</span><span class="st">'D:G'</span>,</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>            names<span class="op">=</span>[<span class="st">'budget_yr'</span>, <span class="st">'resource_allocation'</span>, <span class="st">'deposits'</span>, <span class="st">'advance_edu'</span>],</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>            skiprows<span class="op">=</span><span class="dv">71</span>,</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>            skipfooter<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>        <span class="co"># more fiddly cleaning because of how the table is set up</span></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>        <span class="co"># there's a blank row between 1986-87 and when</span></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>        <span class="co"># contributions resume in 2005-06</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="kw">lambda</span> df: <span class="op">~</span>df[<span class="st">'budget_yr'</span>].isna()]</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>        .set_index(<span class="st">'budget_yr'</span>)</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>        <span class="co"># missing entries have 0 contributions for that</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>        <span class="co"># category in that year</span></span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>        .fillna(<span class="dv">0</span>)</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>        <span class="co"># The three columns are all counted the same</span></span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for the purposes of this analysis, they just have</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>        <span class="co"># different labels/classifications depending on the year</span></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>        .assign(total_heritage<span class="op">=</span><span class="kw">lambda</span> df: df.<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">'columns'</span>))</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add a dummy variable to indicate heritage fund deposit years</span></span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>        .assign(heritage_dummy<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>        .reset_index()</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>        <span class="co"># convert the fiscal year column to a datetime index</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>        .assign(budget_dt<span class="op">=</span><span class="kw">lambda</span> df: get_date_index(df))</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>        .drop(columns<span class="op">=</span><span class="st">'budget_yr'</span>)</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>        .set_index(<span class="st">'budget_dt'</span>)</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_budget() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Combine base budget with heritage deposits.</span></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a><span class="co">    Pull all the logic together to create one dataframe with all the</span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a><span class="co">    fiscal data for the period of interest.</span></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a><span class="co">        The full nominal budget data set.</span></span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>    budg <span class="op">=</span> read_ab_budget()</span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>    heritage <span class="op">=</span> read_heritage()</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>    budg_clean <span class="op">=</span> (</span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Start with the budget dataframe</span></span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>        budg</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>        <span class="co"># consolidate some revenue categories</span></span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>        .assign(other_revenue<span class="op">=</span><span class="kw">lambda</span> df: df[[<span class="st">'retail_sales_tax'</span>, <span class="st">'federal_cash_transfers'</span>, <span class="st">'other_own_source_revenue'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">'columns'</span>))</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Just keep the columns we still need</span></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>        .reindex(columns<span class="op">=</span>[<span class="st">'personal_income_tax'</span>, <span class="st">'corporate_income_tax'</span>, <span class="st">'natural_resource_revenue'</span>, <span class="st">'other_revenue'</span>, <span class="st">'total_prog_exp'</span>, <span class="st">'debt_service'</span>])</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>        <span class="co"># add in the heritage contributions data</span></span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>        .merge(heritage[[<span class="st">'total_heritage'</span>, <span class="st">'heritage_dummy'</span>]], how<span class="op">=</span><span class="st">'left'</span>, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set contributions and the heritage dummy to 0 for years where there were no contributions</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>        .fillna(<span class="dv">0</span>)</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Net out heritage contributions from natural resources revenue</span></span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>        .assign(natural_resource_revenue_before_heritage<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'natural_resource_revenue'</span>])</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>        .assign(natural_resource_revenue<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'natural_resource_revenue'</span>] <span class="op">-</span> df[<span class="st">'total_heritage'</span>])</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>        <span class="co"># consolidate revenue</span></span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>        .assign(total_revenue<span class="op">=</span><span class="kw">lambda</span> df: df[[<span class="st">'personal_income_tax'</span>, <span class="st">'corporate_income_tax'</span>, <span class="st">'natural_resource_revenue'</span>, <span class="st">'other_revenue'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">'columns'</span>))</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>        <span class="co"># consolidate expenditure</span></span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>        .assign(total_expenditure<span class="op">=</span><span class="kw">lambda</span> df: df[[<span class="st">'total_prog_exp'</span>, <span class="st">'debt_service'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="st">'columns'</span>))</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculate the deficit</span></span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>        .assign(deficit<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'total_expenditure'</span>] <span class="op">-</span> df[<span class="st">'total_revenue'</span>])</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>        <span class="co"># make all the budget numbers floating point</span></span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>        .astype(<span class="st">'float64'</span>)</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> budg_clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="real-per-capita-budget" class="level3">
<h3 class="anchored" data-anchor-id="real-per-capita-budget">Real Per Capita budget</h3>
<p>All of the analysis in the paper is done in terms of real per-capita data. Functions in this section transform the nominal total budget numbers acquired in the previous section into real per-capita figures.</p>
<div id="cell-8" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> periodic_to_budget_annual(df: pd.DataFrame, index_name: <span class="bu">str</span>, year_periods: <span class="bu">int</span> <span class="op">=</span> <span class="dv">4</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Take a monthly or quarterly indexed dataframe and annualize it by budget period.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">    The inflation and population data we need to convert the budget into</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    real per-capita figures are monthly series. We need to get the average</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">    population and price level for each fiscal year in the data set.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Rolling mean indexed on January year N+1 is the March to March</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    average population for fiscal year N</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Applying a date offset of -1 year and taking only</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">    January data of these rolling means gives us an average on the</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">    same basis as the budget dates.</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">    df: pandas.DataFrame</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">        DataFrame to be piped into this function</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">    index_name: str</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">        The name of the date index</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">    year_periods: int, default 4</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">        4 for quarterly data (population), 12 for monthly (inflation)</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">        An annualized dataframe on a fiscal year basis for comparison</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">        to annual budget figures.</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        df</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>        .copy()</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        .rolling(year_periods, closed<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        .mean()</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        .reset_index()</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        .assign(budget_dt<span class="op">=</span><span class="kw">lambda</span> df: df[index_name] <span class="op">-</span> pd.DateOffset(years<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="kw">lambda</span> x: x[<span class="st">'budget_dt'</span>].dt.year <span class="op">&gt;=</span> <span class="dv">1965</span>]</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="kw">lambda</span> x: x[<span class="st">'budget_dt'</span>].dt.month <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        .drop(columns<span class="op">=</span>index_name)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        .set_index(<span class="st">'budget_dt'</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        .copy()</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> per_capita_data() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Read in population data to calculate per capita estimates.</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co">    Quarterly population estimates for Alberta from Statistics Canada</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co">        Fiscal year annualized population estimates for Alberta over the</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co">        reference period.</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    table <span class="op">=</span> <span class="st">'17-10-0009-01'</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        stats_can.table_to_df(table, path<span class="op">=</span><span class="st">'data'</span>)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="kw">lambda</span> x: x[<span class="st">'GEO'</span>] <span class="op">==</span> <span class="st">'Alberta'</span>]</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="kw">lambda</span> x: x[<span class="st">'REF_DATE'</span>] <span class="op">&gt;=</span> <span class="st">'1965'</span>]</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        .set_index(<span class="st">'REF_DATE'</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        [[<span class="st">'VALUE'</span>]]</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{<span class="st">'VALUE'</span> : <span class="st">'population'</span>})</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>        .pipe(periodic_to_budget_annual, <span class="st">'REF_DATE'</span>, <span class="dv">4</span>)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> inflation_data() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Read in inflation data to calculate real dollar estimates.</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="co">    The whole series is scaled so 2017 budget year is = 1</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="co">        Fiscal year annualized inflation data for Alberta over</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="co">        the reference period. Normalized to 2017 = 1</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Alberta inflation doesn't go back far enough, use Canada for earlier dates</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    vecs <span class="op">=</span> (<span class="st">'v41692327'</span>, <span class="st">'v41690973'</span>)</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>        stats_can.vectors_to_df_local(vecs, path<span class="op">=</span><span class="st">'data'</span>, start_date<span class="op">=</span>dt.date(<span class="dv">1965</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{<span class="st">'v41692327'</span>: <span class="st">'ab_inflation'</span>, <span class="st">'v41690973'</span>: <span class="st">'ca_inflation'</span>})</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill in with Canadian inflation data where (early) Alberta inflation data is missing.</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> df[<span class="st">'ab_inflation'</span>].isna()</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Could probably do some interpolation or scaling before this, but I looked</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># at the raw series and they were pretty comparable</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    df.loc[mask, <span class="st">'ab_inflation'</span>] <span class="op">=</span> df.loc[mask, <span class="st">'ca_inflation'</span>]</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>        df</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        .drop(columns<span class="op">=</span><span class="st">'ca_inflation'</span>)</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>        .pipe(periodic_to_budget_annual, <span class="st">'REF_DATE'</span>, <span class="dv">12</span>)</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rescale to 2017 = 100 (this is fiscal year 2017,</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># original may have done calendar year)</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>    inf_2017 <span class="op">=</span> <span class="bu">float</span>(df.loc[<span class="st">'2017'</span>, <span class="st">'ab_inflation'</span>])</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df <span class="op">/</span> inf_2017</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> budget_real_per_capita() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get budget data in real per-capita terms.</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a><span class="co">        Budget data in real per-capita terms.</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read in budget data using the function defined in the </span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>    <span class="co"># previous section</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>    clean_budget_df <span class="op">=</span> clean_budget()</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Everything except the dummy variable gets turned into</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>    <span class="co"># real per-capita terms</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>    scale_cols <span class="op">=</span> clean_budget_df.columns.drop(<span class="st">'heritage_dummy'</span>).tolist()</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get population</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>    per_capita <span class="op">=</span> per_capita_data()</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get inflation</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>    inflation <span class="op">=</span> inflation_data()</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine the datasets, can just use assign because they all</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>    <span class="co"># have a datetime index</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>    dfpc <span class="op">=</span> (</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>        clean_budget_df</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>        .assign(pop<span class="op">=</span>per_capita)</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>        .assign(cpi<span class="op">=</span>inflation)</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rescale to real per capita</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>    dfpc[scale_cols] <span class="op">=</span> (</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>        dfpc[scale_cols]</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>        <span class="co"># original data was in millions of dollars</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>        .mul(<span class="dv">1_000_000</span>)</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>        <span class="co"># divide by population and inflation for</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>        <span class="co"># real per-capita</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>        .div(dfpc[<span class="st">'pop'</span>], axis<span class="op">=</span><span class="st">'index'</span>)</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>        .div(dfpc[<span class="st">'cpi'</span>], axis<span class="op">=</span><span class="st">'index'</span>)</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dfpc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exogenous-factors" class="level3">
<h3 class="anchored" data-anchor-id="exogenous-factors">Exogenous factors</h3>
<p>The paper lists the Alberta employment rate, the Alberta unemployment rate, and the CAD/USD exchange rate as exogenous factors included in the model. Functions in this section acquire that data. I had to do some fiddling to get long enough historical series for some of the factors as you’ll note in the code. It’s hard to say for sure how the original author sourced this data. I’ll just have to compare my tables and charts to his to see if I got close enough.</p>
<div id="cell-10" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_historical_cad_usd() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get exchange rates from before 1971.</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">    FRED live data only goes back to 1971, I need a longer series</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">    This was what I could find. It's annual only, so I can't do it on a budget</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">    year basis, but hopefully it will be close enough</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">    This whole function is just some gross munging to read in a table from a web page.</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Once it's called we save it to the data folder so I don't have to re-call it every</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">    time I run this notebook.</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">'https://fxtop.com/en/historical-exchange-rates.php?YA=1&amp;C1=USD&amp;C2=CAD&amp;A=1&amp;YYYY1=1953&amp;MM1=01&amp;DD1=01&amp;YYYY2=2019&amp;MM2=04&amp;DD2=01&amp;LANG=en'</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_html(url)[<span class="dv">29</span>]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    headers <span class="op">=</span> df.iloc[<span class="dv">0</span>]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    new_df  <span class="op">=</span> (</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        pd.DataFrame(df.values[<span class="dv">1</span>:], columns<span class="op">=</span>headers)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{<span class="st">'Year'</span>: <span class="st">'year'</span>, <span class="st">'Average USD/CAD'</span>: <span class="st">'EXCAUS'</span>})</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        .assign(month<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        .assign(day<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        .assign(budget_dt<span class="op">=</span><span class="kw">lambda</span> df: pd.to_datetime(df[[<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>]]))</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        .set_index(<span class="st">'budget_dt'</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        .reindex(columns<span class="op">=</span>[<span class="st">'EXCAUS'</span>])</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    new_df.to_csv(<span class="st">'./data/early_cad_usd.csv'</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_df</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_historical_cad_usd(force_update: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get exchange rates before 1971.</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">    This wraps the above function to read in the downloaded data</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">    if it's available and download and then read it if required.</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co">    force_update: bool</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co">        Download the data set even if you already have it</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="co">        Exchange rates from 1965 to 1971</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    fname <span class="op">=</span> Path(<span class="st">'.'</span>).joinpath(<span class="st">'data'</span>).joinpath(<span class="st">'early_cad_usd.csv'</span>)</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> fname.exists() <span class="kw">or</span> force_update:</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> download_historical_cad_usd()</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.read_csv(fname).set_index(<span class="st">'budget_dt'</span>)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_cad_usd() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Download monthly exchange data from FRED.</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="co">    For most of the period of interest I can get monthly</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="co">    data from FRED, so I'll do that where possible.</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a><span class="co">        Most of the CAD/USD exchange data I need for this analysis.</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pdr.get_data_fred(<span class="st">'EXCAUS'</span>, start<span class="op">=</span>dt.date(<span class="dv">1970</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    df.to_csv(<span class="st">'./data/cad_usd.csv'</span>)</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_cad_usd(force_update<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get monthly exchange data from FRED.</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a><span class="co">    This wraps the above function to read in the downloaded data</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="co">    if it's available and download and then read it if required.</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a><span class="co">    force_update: bool</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a><span class="co">        Download the data set even if you already have it</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a><span class="co">        Exchange rate data</span></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>    fname <span class="op">=</span> Path(<span class="st">'.'</span>).joinpath(<span class="st">'data'</span>).joinpath(<span class="st">'cad_usd.csv'</span>)</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> fname.exists() <span class="kw">or</span> force_update:</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> download_cad_usd()</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.read_csv(fname, parse_dates<span class="op">=</span>[<span class="st">'DATE'</span>]).set_index(<span class="st">'DATE'</span>)</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> annual_cad_usd() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Full series of CAD/USD in fiscal year format.</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a><span class="co">    Get FRED data and turn the monthly values into annualized on a budget</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a><span class="co">    basis for as much as possible. Fill in the remainder with calendar annual</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a><span class="co">    data from fxtop</span></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a><span class="co">        Exchange data on an annualized basis.</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a datetime index of all the points we need</span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>    annual_date_range <span class="op">=</span> pd.date_range(<span class="st">'1964-01-01'</span>, <span class="st">'2018-01-01'</span>, freq<span class="op">=</span><span class="st">'AS'</span>, name<span class="op">=</span><span class="st">'budget_dt'</span>)</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the old annual stuff to fill in later</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>    old_df <span class="op">=</span> read_historical_cad_usd()</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get the monthly series</span></span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>        read_cad_usd()</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>        <span class="co"># annualize it</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>        .pipe(periodic_to_budget_annual, <span class="st">'DATE'</span>, <span class="dv">12</span>)</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>        <span class="co"># add in all the missing dates we need</span></span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>        .reindex(annual_date_range)</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># fill those missing dates from the old annual data set.</span></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>        .fillna(old_df)</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stats_can_exog() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Bring in exogenous StatsCan data. Employment and Unemployment rates.</span></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a><span class="co">        Exogenous data required from StatsCan</span></span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vectors for monthly series where available</span></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>    ur_vec <span class="op">=</span> <span class="st">"v2064516"</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>    er_vec <span class="op">=</span> <span class="st">"v2064518"</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>    annual_date_range <span class="op">=</span> pd.date_range(<span class="st">'1964-01-01'</span>, <span class="st">'2018-01-01'</span>, freq<span class="op">=</span><span class="st">'AS'</span>, name<span class="op">=</span><span class="st">'budget_dt'</span>)</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for the earlier periods we only have annual data</span></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>    old_df <span class="op">=</span> (</span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>        stats_can.table_to_df(<span class="st">'36-10-0345-01'</span>, path<span class="op">=</span><span class="st">'data'</span>)</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get Alberta data only</span></span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="kw">lambda</span> x: x[<span class="st">'GEO'</span>] <span class="op">==</span> <span class="st">'Alberta'</span>]</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Keep only the categories we care about</span></span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="kw">lambda</span> x: x[<span class="st">'Economic indicators'</span>].isin([<span class="st">'Population'</span>, <span class="st">'Total employment'</span>, <span class="st">'Unemployment rate'</span>])]</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pivot so the year is the row and the variables are the columns</span></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>        .pivot_table(index<span class="op">=</span><span class="st">'REF_DATE'</span>, columns<span class="op">=</span><span class="st">'Economic indicators'</span>, values<span class="op">=</span><span class="st">'VALUE'</span>)</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{<span class="st">'Unemployment rate'</span>: <span class="st">'unemployment_rate'</span>})</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculate the employment rate</span></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>        .assign(employment_rate<span class="op">=</span><span class="kw">lambda</span> x: (x[<span class="st">'Total employment'</span>] <span class="op">/</span> x[<span class="st">'Population'</span>]) <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>        <span class="co"># drop the population, just used for calculating employment rate</span></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>        .reindex(columns<span class="op">=</span>[<span class="st">'unemployment_rate'</span>, <span class="st">'employment_rate'</span>])</span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>        .rename_axis(<span class="st">'budget_dt'</span>, axis<span class="op">=</span><span class="st">'index'</span>)</span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>        .rename_axis(<span class="va">None</span>, axis<span class="op">=</span><span class="st">'columns'</span>)</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get monthly data where available</span></span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>        stats_can.vectors_to_df_local([ur_vec, er_vec], path<span class="op">=</span><span class="st">'data'</span>, start_date<span class="op">=</span>dt.date(<span class="dv">1964</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{ur_vec: <span class="st">'unemployment_rate'</span>, er_vec: <span class="st">'employment_rate'</span>})</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>        <span class="co"># annualize</span></span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>        .pipe(periodic_to_budget_annual, <span class="st">'REF_DATE'</span>, <span class="dv">12</span>)</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get the full range of data we want</span></span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>        .reindex(annual_date_range)</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>        <span class="co"># fill in the gaps with the old annual series</span></span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>        .fillna(old_df)</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Not ideal but even the annual series doesn't go quite back</span></span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>        <span class="co"># far enough so we have to backfill the earliest available</span></span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>        <span class="co"># data point</span></span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>        .fillna(method<span class="op">=</span><span class="st">'bfill'</span>)</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> exogenous_variables() <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Bring in exogenous parameters together.</span></span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a><span class="co">    From the paper:</span></span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a><span class="co">    We also include other exogenous variables that are likely to affect</span></span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a><span class="co">    the province’s budget. It is known that the various components of the</span></span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a><span class="co">    provincial budget can be influenced by the business cycle. Thus, following</span></span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a><span class="co">    Buettner and Wildsain (2006), we account for the potential effects of the</span></span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a><span class="co">    business cycle by including one-period lagged changes in the provincial</span></span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a><span class="co">    employment and unemployment rates. Another important exogenous factor</span></span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a><span class="co">    that is often cited in provincial budget documents as being important in</span></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a><span class="co">    influencing the provincial government’s oil royalty revenue is the Canadian-U.S.</span></span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a><span class="co">    dollar exchange rate. For this reason, we control for this factor by</span></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a><span class="co">    including one period lagged changes in the Canadian-U.S. dollar exchange rate</span></span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a><span class="co">        All the necessary exogenous factors for reproducing the paper.</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>    cadusd <span class="op">=</span> annual_cad_usd()</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>    ur_er <span class="op">=</span> stats_can_exog()</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.concat([cadusd, ur_er], axis<span class="op">=</span><span class="st">'columns'</span>)</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="exploratory-figures" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-figures">Exploratory Figures</h2>
<section id="figure-1" class="level3">
<h3 class="anchored" data-anchor-id="figure-1">Figure 1</h3>
<p>Page 5 of the report charts Non-renewable Resource Revenue, Total Expenditure, and Total Revenue. All are in per-capita 2017 dollars. Reproducing this chart will be a good starting check that my data extraction and transformation matches the original author’s strategy.</p>
<div id="cell-12" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fig1(df: pd.DataFrame) <span class="op">-&gt;</span> alt.Chart:</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Reproduce Figure 1 from the paper.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">    df: pd.DataFrame</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">        A dataframe with non-renewable resource revenue, total expenditure, and total revenue time series</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    chart_df <span class="op">=</span> (</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        df</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="st">'1970'</span>:<span class="st">'2016'</span>, [<span class="st">'natural_resource_revenue'</span>, <span class="st">'total_revenue'</span>, <span class="st">'total_expenditure'</span>]]</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">'natural_resource_revenue'</span>: <span class="st">'Non-renewable Resource Revenue'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">'total_revenue'</span>: <span class="st">'Total Revenue'</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">'total_expenditure'</span>: <span class="st">'Total Expenditure'</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        .reset_index()</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        .melt(id_vars<span class="op">=</span><span class="st">'budget_dt'</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    c_domain <span class="op">=</span> [<span class="st">"Non-renewable Resource Revenue"</span>, <span class="st">"Total Expenditure"</span>, <span class="st">"Total Revenue"</span>]</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    c_range <span class="op">=</span> [<span class="st">"green"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>]</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    chart <span class="op">=</span> (</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        alt.Chart(chart_df)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        .mark_line()</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        .encode(</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span>alt.X(<span class="st">'budget_dt:T'</span>, axis<span class="op">=</span>alt.Axis(title<span class="op">=</span><span class="va">None</span>)),</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span>alt.Y(<span class="st">'value:Q'</span>, axis<span class="op">=</span>alt.Axis(title<span class="op">=</span><span class="st">'Per capita in 2017 dollars'</span>), scale<span class="op">=</span>alt.Scale(domain<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">14_000</span>))),</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>alt.Color(<span class="st">'variable:N'</span>, legend<span class="op">=</span>alt.Legend(title<span class="op">=</span><span class="va">None</span>, orient<span class="op">=</span><span class="st">'bottom'</span>), scale<span class="op">=</span>alt.Scale(domain<span class="op">=</span>c_domain, <span class="bu">range</span><span class="op">=</span>c_range))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        .properties(width<span class="op">=</span><span class="dv">1250</span>, height<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here’s the original chart from the paper:</p>
<div id="cell-14" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">"img/ferede_fig_1.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>And here’s mine:</p>
<div id="cell-16" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> budget_real_per_capita()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fig1(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This graph looks very similar to the chart in the paper, with a notable exception of the 1976/1977 budget year. My chart shows Non-renewable Resource Revenue as slightly negative, whereas the original chart has it largely in line with 1975/1976 and 1977/1978. NRR is negative in my chart because I have netted out contributions to the Alberta Heritage Savings Trust Fund (AHSTF). To the best of my understanding, the original paper does the same, and the consistent values between the two in all other years supports that. Quoting the original paper:</p>
<blockquote class="blockquote">
<p>The part of resource revenue that is saved in the AHSTF is not expected to influence the provincial government’s spending and revenue-raising choices. For this reason, in our analysis, we exclude the part of the resource revenue that is saved in the AHSTF from the non-renewable-resource revenue data.</p>
</blockquote>
<p>For comparison, here is the same chart, but without netting AHSTF contributions from revenue:</p>
<div id="cell-18" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>no_net_df <span class="op">=</span> (</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    .assign(total_revenue<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">"total_revenue"</span>] <span class="op">+</span> df[<span class="st">"total_heritage"</span>])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    .assign(natural_resource_revenue<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">"natural_resource_revenue"</span>] <span class="op">+</span> df[<span class="st">"total_heritage"</span>])</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    .assign(deficit<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">"total_expenditure"</span>] <span class="op">-</span> df[<span class="st">"total_revenue"</span>])</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>fig1(no_net_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>1976/1977 more closely matches the original chart in the paper, but the remaining years in the period of mid 70s to mid 80s when there were significant contributions clearly do not match. Let’s try one more where I just substitute that one year.</p>
<div id="cell-20" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>error_df <span class="op">=</span> df.copy()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>heritage_76 <span class="op">=</span> error_df.loc[<span class="st">"1976"</span>, <span class="st">"total_heritage"</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>error_df.loc[<span class="st">"1976"</span>, <span class="st">"natural_resource_revenue"</span>] <span class="op">+=</span> heritage_76</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>error_df.loc[<span class="st">"1976"</span>, <span class="st">"total_revenue"</span>] <span class="op">+=</span> heritage_76</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>error_df.loc[<span class="st">"1976"</span>, <span class="st">"deficit"</span>] <span class="op">-=</span> heritage_76</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>fig1(error_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here’s the original figure again for easier comparison</p>
<div id="cell-22" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">"img/ferede_fig_1.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>From eyeballing it that looks exactly like Figure 1 in the paper. It appears there’s a data error in the original paper. For the rest of this analysis I’ll compare both my base implementation of the data, as well as the one with the data error.</p>
</section>
<section id="figure-2" class="level3">
<h3 class="anchored" data-anchor-id="figure-2">Figure 2</h3>
<p>Page 6 of the paper produces a scatter plot of Real per capita non-renewable resource revenue on the X axis vs.&nbsp;Real per capita budget balance on the Y, along with a linear trend fit.</p>
<div id="cell-25" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fig2(df: pd.DataFrame) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Reproduce Figure 2 from the paper.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">    df: pd.DataFrame</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The table with historical revenue and expenditure data.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    sns.<span class="bu">set</span>(rc<span class="op">=</span>{<span class="st">'figure.figsize'</span>:(<span class="fl">11.7</span>,<span class="fl">8.27</span>)})</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    chart_df <span class="op">=</span> (</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        df</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="st">'1970'</span>:<span class="st">'2016'</span>, [<span class="st">'natural_resource_revenue'</span>, <span class="st">'deficit'</span>]]</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">'natural_resource_revenue'</span>: <span class="st">'Non-renewable Resource Revenue'</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">'deficit'</span>: <span class="st">'Deficit'</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        .assign(balance<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'Deficit'</span>] <span class="op">*</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{<span class="st">'balance'</span>: <span class="st">'Budget Balance'</span>})</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        .copy()</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    sns.regplot(x<span class="op">=</span><span class="st">'Non-renewable Resource Revenue'</span>, y<span class="op">=</span><span class="st">'Budget Balance'</span>, data<span class="op">=</span>chart_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here’s the original figure</p>
<div id="cell-27" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">"img/ferede_fig_2.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here’s the figure using my original data:</p>
<div id="cell-29" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig2(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>And here’s the figure using the version with a data error:</p>
<div id="cell-31" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig2(error_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Again, this chart is more consistent with the dataframe where I don’t net heritage fund contributions out of 1976 but do for all other years</p>
</section>
</section>
<section id="model-specification-and-estimation" class="level2">
<h2 class="anchored" data-anchor-id="model-specification-and-estimation">Model Specification and estimation</h2>
<p>This section combines the previously specified data extraction with transformations necessary to produce summary statistics, statistical tests, and the VAR model itself.</p>
<div id="cell-34" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_df_levels(budg: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Combine real per capita budget data to get model data in levels.</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">    lag exogenous variables (unemployment and employment rates, CAD/USD exchange)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">    budg: pd.DataFrame</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Budget data, either with or without data error</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Budget data combined with exogenous factors</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    exog <span class="op">=</span> exogenous_variables()</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        pd.concat([budg, exog], axis<span class="op">=</span><span class="st">'columns'</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        .rename(columns<span class="op">=</span>{<span class="st">'total_prog_exp'</span>: <span class="st">'program_expenditure'</span>, <span class="st">'EXCAUS'</span>: <span class="st">'cad_usd'</span>})</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        .assign(ur_lag<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'unemployment_rate'</span>].shift(periods<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        .assign(er_lag<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'employment_rate'</span>].shift(periods<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        .assign(cad_usd_lag<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'cad_usd'</span>].shift(periods<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        .reindex(columns<span class="op">=</span>[</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">'program_expenditure'</span>, <span class="st">'debt_service'</span>, <span class="st">'corporate_income_tax'</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">'personal_income_tax'</span>, <span class="st">'other_revenue'</span>, <span class="st">'natural_resource_revenue'</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'deficit'</span>, <span class="st">'heritage_dummy'</span>, <span class="st">'ur_lag'</span>, <span class="st">'er_lag'</span>, <span class="st">'cad_usd_lag'</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mdfl <span class="op">=</span> model_df_levels(df)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mdfl_err <span class="op">=</span> model_df_levels(error_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sumary-statistics-for-key-variables-1970-71-2016-17-in-levels" class="level3">
<h3 class="anchored" data-anchor-id="sumary-statistics-for-key-variables-1970-71-2016-17-in-levels">Sumary statistics for key variables, 1970-71, 2016-17 in levels</h3>
<p>Prior to any modeling, let’s compare the summary statistics for the data sets I’ve created against those in the paper:</p>
<div id="cell-37" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>number <span class="op">=</span> <span class="st">"</span><span class="sc">{:0&lt;4,.1f}</span><span class="st">"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>percent <span class="op">=</span> <span class="st">'</span><span class="sc">{:.1%}</span><span class="st">'</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> <span class="st">"</span><span class="sc">{:0.0f}</span><span class="st">"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tbl1_level(model_df: pd.DataFrame):</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Produce summary statistics of the input data in levels.</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">    model_df: pd.DataFrame</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Input data set</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.io.formats.style.Styler:</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">        Nicely formatted summary statistics</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        model_df</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="st">'1970'</span>:<span class="st">'2016'</span>]</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        .copy()</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        .drop(columns<span class="op">=</span>[<span class="st">'heritage_dummy'</span>])</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>        .reindex(columns<span class="op">=</span>[</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">'natural_resource_revenue'</span>, <span class="st">'corporate_income_tax'</span>, <span class="st">'personal_income_tax'</span>,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'other_revenue'</span>, <span class="st">'debt_service'</span>, <span class="st">'program_expenditure'</span>, <span class="st">'deficit'</span>, <span class="st">'ur_lag'</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">'er_lag'</span>, <span class="st">'cad_usd_lag'</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>        .describe()</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>        .T</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>        .style.<span class="bu">format</span>({</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'count'</span>: count,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'mean'</span>: number,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'std'</span>: number,</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">'min'</span>: number,</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">'25%'</span>: number,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">'50%'</span>: number,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">'75%'</span>: number,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">'max'</span>: number</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here’s Table 1 from the paper:</p>
<div id="cell-39" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">"img/ferede_tbl_1.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here’s my summary of the top half</p>
<div id="cell-41" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tbl1_level(mdfl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<style type="text/css">
</style>
<table id="T_16831_" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th"></th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">count</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">mean</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">std</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">min</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">25%</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">50%</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">75%</th>
<th class="col_heading level0 col7" data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_16831_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">natural_resource_revenue</td>
<td id="T_16831_row0_col0" class="data row0 col0">47</td>
<td id="T_16831_row0_col1" class="data row0 col1">2,737.2</td>
<td id="T_16831_row0_col2" class="data row0 col2">1,358.9</td>
<td id="T_16831_row0_col3" class="data row0 col3">-125.3</td>
<td id="T_16831_row0_col4" class="data row0 col4">1,726.4</td>
<td id="T_16831_row0_col5" class="data row0 col5">2,371.7</td>
<td id="T_16831_row0_col6" class="data row0 col6">3,941.6</td>
<td id="T_16831_row0_col7" class="data row0 col7">5,181.6</td>
</tr>
<tr class="even">
<td id="T_16831_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">corporate_income_tax</td>
<td id="T_16831_row1_col0" class="data row1 col0">47</td>
<td id="T_16831_row1_col1" class="data row1 col1">792.1</td>
<td id="T_16831_row1_col2" class="data row1 col2">349.6</td>
<td id="T_16831_row1_col3" class="data row1 col3">245.8</td>
<td id="T_16831_row1_col4" class="data row1 col4">544.6</td>
<td id="T_16831_row1_col5" class="data row1 col5">723.6</td>
<td id="T_16831_row1_col6" class="data row1 col6">1,010.9</td>
<td id="T_16831_row1_col7" class="data row1 col7">1,560.6</td>
</tr>
<tr class="odd">
<td id="T_16831_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">personal_income_tax</td>
<td id="T_16831_row2_col0" class="data row2 col0">47</td>
<td id="T_16831_row2_col1" class="data row2 col1">1,862.1</td>
<td id="T_16831_row2_col2" class="data row2 col2">607.8</td>
<td id="T_16831_row2_col3" class="data row2 col3">767.1</td>
<td id="T_16831_row2_col4" class="data row2 col4">1,403.8</td>
<td id="T_16831_row2_col5" class="data row2 col5">1,889.6</td>
<td id="T_16831_row2_col6" class="data row2 col6">2,359.8</td>
<td id="T_16831_row2_col7" class="data row2 col7">2,830.0</td>
</tr>
<tr class="even">
<td id="T_16831_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">other_revenue</td>
<td id="T_16831_row3_col0" class="data row3 col0">47</td>
<td id="T_16831_row3_col1" class="data row3 col1">4,394.6</td>
<td id="T_16831_row3_col2" class="data row3 col2">1,084.9</td>
<td id="T_16831_row3_col3" class="data row3 col3">2,352.8</td>
<td id="T_16831_row3_col4" class="data row3 col4">3,632.2</td>
<td id="T_16831_row3_col5" class="data row3 col5">4,699.2</td>
<td id="T_16831_row3_col6" class="data row3 col6">5,209.2</td>
<td id="T_16831_row3_col7" class="data row3 col7">5,818.2</td>
</tr>
<tr class="odd">
<td id="T_16831_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">debt_service</td>
<td id="T_16831_row4_col0" class="data row4 col0">47</td>
<td id="T_16831_row4_col1" class="data row4 col1">322.8</td>
<td id="T_16831_row4_col2" class="data row4 col2">334.9</td>
<td id="T_16831_row4_col3" class="data row4 col3">31.4</td>
<td id="T_16831_row4_col4" class="data row4 col4">82.7</td>
<td id="T_16831_row4_col5" class="data row4 col5">158.5</td>
<td id="T_16831_row4_col6" class="data row4 col6">486.9</td>
<td id="T_16831_row4_col7" class="data row4 col7">1,075.6</td>
</tr>
<tr class="even">
<td id="T_16831_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">program_expenditure</td>
<td id="T_16831_row5_col0" class="data row5 col0">47</td>
<td id="T_16831_row5_col1" class="data row5 col1">9,399.1</td>
<td id="T_16831_row5_col2" class="data row5 col2">2,161.2</td>
<td id="T_16831_row5_col3" class="data row5 col3">4,745.8</td>
<td id="T_16831_row5_col4" class="data row5 col4">7,623.0</td>
<td id="T_16831_row5_col5" class="data row5 col5">10,060.9</td>
<td id="T_16831_row5_col6" class="data row5 col6">11,142.6</td>
<td id="T_16831_row5_col7" class="data row5 col7">12,869.2</td>
</tr>
<tr class="odd">
<td id="T_16831_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">deficit</td>
<td id="T_16831_row6_col0" class="data row6 col0">47</td>
<td id="T_16831_row6_col1" class="data row6 col1">-64.0</td>
<td id="T_16831_row6_col2" class="data row6 col2">1,618.0</td>
<td id="T_16831_row6_col3" class="data row6 col3">-3,184.0</td>
<td id="T_16831_row6_col4" class="data row6 col4">-1,320.5</td>
<td id="T_16831_row6_col5" class="data row6 col5">-140.6</td>
<td id="T_16831_row6_col6" class="data row6 col6">1,092.3</td>
<td id="T_16831_row6_col7" class="data row6 col7">3,775.8</td>
</tr>
<tr class="even">
<td id="T_16831_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">ur_lag</td>
<td id="T_16831_row7_col0" class="data row7 col0">47</td>
<td id="T_16831_row7_col1" class="data row7 col1">6.10</td>
<td id="T_16831_row7_col2" class="data row7 col2">2.20</td>
<td id="T_16831_row7_col3" class="data row7 col3">3.40</td>
<td id="T_16831_row7_col4" class="data row7 col4">4.50</td>
<td id="T_16831_row7_col5" class="data row7 col5">5.40</td>
<td id="T_16831_row7_col6" class="data row7 col6">7.50</td>
<td id="T_16831_row7_col7" class="data row7 col7">11.4</td>
</tr>
<tr class="odd">
<td id="T_16831_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">er_lag</td>
<td id="T_16831_row8_col0" class="data row8 col0">47</td>
<td id="T_16831_row8_col1" class="data row8 col1">63.7</td>
<td id="T_16831_row8_col2" class="data row8 col2">9.90</td>
<td id="T_16831_row8_col3" class="data row8 col3">38.5</td>
<td id="T_16831_row8_col4" class="data row8 col4">65.1</td>
<td id="T_16831_row8_col5" class="data row8 col5">67.3</td>
<td id="T_16831_row8_col6" class="data row8 col6">69.0</td>
<td id="T_16831_row8_col7" class="data row8 col7">71.8</td>
</tr>
<tr class="even">
<td id="T_16831_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">cad_usd_lag</td>
<td id="T_16831_row9_col0" class="data row9 col0">45</td>
<td id="T_16831_row9_col1" class="data row9 col1">1.20</td>
<td id="T_16831_row9_col2" class="data row9 col2">0.20</td>
<td id="T_16831_row9_col3" class="data row9 col3">1.00</td>
<td id="T_16831_row9_col4" class="data row9 col4">1.10</td>
<td id="T_16831_row9_col5" class="data row9 col5">1.20</td>
<td id="T_16831_row9_col6" class="data row9 col6">1.40</td>
<td id="T_16831_row9_col7" class="data row9 col7">1.60</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>And the same summary on the data with the introduced error</p>
<div id="cell-43" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tbl1_level(mdfl_err)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<style type="text/css">
</style>
<table id="T_a9fa3_" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th"></th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">count</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">mean</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">std</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">min</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">25%</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">50%</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">75%</th>
<th class="col_heading level0 col7" data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_a9fa3_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">natural_resource_revenue</td>
<td id="T_a9fa3_row0_col0" class="data row0 col0">47</td>
<td id="T_a9fa3_row0_col1" class="data row0 col1">2,843.8</td>
<td id="T_a9fa3_row0_col2" class="data row0 col2">1,325.6</td>
<td id="T_a9fa3_row0_col3" class="data row0 col3">691.9</td>
<td id="T_a9fa3_row0_col4" class="data row0 col4">1,760.7</td>
<td id="T_a9fa3_row0_col5" class="data row0 col5">2,532.1</td>
<td id="T_a9fa3_row0_col6" class="data row0 col6">3,972.6</td>
<td id="T_a9fa3_row0_col7" class="data row0 col7">5,181.6</td>
</tr>
<tr class="even">
<td id="T_a9fa3_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">corporate_income_tax</td>
<td id="T_a9fa3_row1_col0" class="data row1 col0">47</td>
<td id="T_a9fa3_row1_col1" class="data row1 col1">792.1</td>
<td id="T_a9fa3_row1_col2" class="data row1 col2">349.6</td>
<td id="T_a9fa3_row1_col3" class="data row1 col3">245.8</td>
<td id="T_a9fa3_row1_col4" class="data row1 col4">544.6</td>
<td id="T_a9fa3_row1_col5" class="data row1 col5">723.6</td>
<td id="T_a9fa3_row1_col6" class="data row1 col6">1,010.9</td>
<td id="T_a9fa3_row1_col7" class="data row1 col7">1,560.6</td>
</tr>
<tr class="odd">
<td id="T_a9fa3_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">personal_income_tax</td>
<td id="T_a9fa3_row2_col0" class="data row2 col0">47</td>
<td id="T_a9fa3_row2_col1" class="data row2 col1">1,862.1</td>
<td id="T_a9fa3_row2_col2" class="data row2 col2">607.8</td>
<td id="T_a9fa3_row2_col3" class="data row2 col3">767.1</td>
<td id="T_a9fa3_row2_col4" class="data row2 col4">1,403.8</td>
<td id="T_a9fa3_row2_col5" class="data row2 col5">1,889.6</td>
<td id="T_a9fa3_row2_col6" class="data row2 col6">2,359.8</td>
<td id="T_a9fa3_row2_col7" class="data row2 col7">2,830.0</td>
</tr>
<tr class="even">
<td id="T_a9fa3_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">other_revenue</td>
<td id="T_a9fa3_row3_col0" class="data row3 col0">47</td>
<td id="T_a9fa3_row3_col1" class="data row3 col1">4,394.6</td>
<td id="T_a9fa3_row3_col2" class="data row3 col2">1,084.9</td>
<td id="T_a9fa3_row3_col3" class="data row3 col3">2,352.8</td>
<td id="T_a9fa3_row3_col4" class="data row3 col4">3,632.2</td>
<td id="T_a9fa3_row3_col5" class="data row3 col5">4,699.2</td>
<td id="T_a9fa3_row3_col6" class="data row3 col6">5,209.2</td>
<td id="T_a9fa3_row3_col7" class="data row3 col7">5,818.2</td>
</tr>
<tr class="odd">
<td id="T_a9fa3_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">debt_service</td>
<td id="T_a9fa3_row4_col0" class="data row4 col0">47</td>
<td id="T_a9fa3_row4_col1" class="data row4 col1">322.8</td>
<td id="T_a9fa3_row4_col2" class="data row4 col2">334.9</td>
<td id="T_a9fa3_row4_col3" class="data row4 col3">31.4</td>
<td id="T_a9fa3_row4_col4" class="data row4 col4">82.7</td>
<td id="T_a9fa3_row4_col5" class="data row4 col5">158.5</td>
<td id="T_a9fa3_row4_col6" class="data row4 col6">486.9</td>
<td id="T_a9fa3_row4_col7" class="data row4 col7">1,075.6</td>
</tr>
<tr class="even">
<td id="T_a9fa3_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">program_expenditure</td>
<td id="T_a9fa3_row5_col0" class="data row5 col0">47</td>
<td id="T_a9fa3_row5_col1" class="data row5 col1">9,399.1</td>
<td id="T_a9fa3_row5_col2" class="data row5 col2">2,161.2</td>
<td id="T_a9fa3_row5_col3" class="data row5 col3">4,745.8</td>
<td id="T_a9fa3_row5_col4" class="data row5 col4">7,623.0</td>
<td id="T_a9fa3_row5_col5" class="data row5 col5">10,060.9</td>
<td id="T_a9fa3_row5_col6" class="data row5 col6">11,142.6</td>
<td id="T_a9fa3_row5_col7" class="data row5 col7">12,869.2</td>
</tr>
<tr class="odd">
<td id="T_a9fa3_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">deficit</td>
<td id="T_a9fa3_row6_col0" class="data row6 col0">47</td>
<td id="T_a9fa3_row6_col1" class="data row6 col1">-170.7</td>
<td id="T_a9fa3_row6_col2" class="data row6 col2">1,587.7</td>
<td id="T_a9fa3_row6_col3" class="data row6 col3">-3,184.0</td>
<td id="T_a9fa3_row6_col4" class="data row6 col4">-1,425.7</td>
<td id="T_a9fa3_row6_col5" class="data row6 col5">-202.8</td>
<td id="T_a9fa3_row6_col6" class="data row6 col6">945.9</td>
<td id="T_a9fa3_row6_col7" class="data row6 col7">3,775.8</td>
</tr>
<tr class="even">
<td id="T_a9fa3_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">ur_lag</td>
<td id="T_a9fa3_row7_col0" class="data row7 col0">47</td>
<td id="T_a9fa3_row7_col1" class="data row7 col1">6.10</td>
<td id="T_a9fa3_row7_col2" class="data row7 col2">2.20</td>
<td id="T_a9fa3_row7_col3" class="data row7 col3">3.40</td>
<td id="T_a9fa3_row7_col4" class="data row7 col4">4.50</td>
<td id="T_a9fa3_row7_col5" class="data row7 col5">5.40</td>
<td id="T_a9fa3_row7_col6" class="data row7 col6">7.50</td>
<td id="T_a9fa3_row7_col7" class="data row7 col7">11.4</td>
</tr>
<tr class="odd">
<td id="T_a9fa3_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">er_lag</td>
<td id="T_a9fa3_row8_col0" class="data row8 col0">47</td>
<td id="T_a9fa3_row8_col1" class="data row8 col1">63.7</td>
<td id="T_a9fa3_row8_col2" class="data row8 col2">9.90</td>
<td id="T_a9fa3_row8_col3" class="data row8 col3">38.5</td>
<td id="T_a9fa3_row8_col4" class="data row8 col4">65.1</td>
<td id="T_a9fa3_row8_col5" class="data row8 col5">67.3</td>
<td id="T_a9fa3_row8_col6" class="data row8 col6">69.0</td>
<td id="T_a9fa3_row8_col7" class="data row8 col7">71.8</td>
</tr>
<tr class="even">
<td id="T_a9fa3_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">cad_usd_lag</td>
<td id="T_a9fa3_row9_col0" class="data row9 col0">45</td>
<td id="T_a9fa3_row9_col1" class="data row9 col1">1.20</td>
<td id="T_a9fa3_row9_col2" class="data row9 col2">0.20</td>
<td id="T_a9fa3_row9_col3" class="data row9 col3">1.00</td>
<td id="T_a9fa3_row9_col4" class="data row9 col4">1.10</td>
<td id="T_a9fa3_row9_col5" class="data row9 col5">1.20</td>
<td id="T_a9fa3_row9_col6" class="data row9 col6">1.40</td>
<td id="T_a9fa3_row9_col7" class="data row9 col7">1.60</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>All the figures that I can validate against (exogenous variables aren’t reported in the paper) are reasonably close. The one noted difference is the previously described outlier in natural resource revenue which leads to my minimum for that variable being significantly lower than in the paper. That large one goes away again if I introduce the same data error described above. My guess for the remaining small discrepancies are differences in calculating population or CPI.</p>
</section>
<section id="sumary-statistics-for-key-variables-1970-71-2016-17-first-difference" class="level3">
<h3 class="anchored" data-anchor-id="sumary-statistics-for-key-variables-1970-71-2016-17-first-difference">Sumary statistics for key variables, 1970-71, 2016-17, first difference</h3>
<p>Reproduce the bottom half of table 1 from the paper</p>
<div id="cell-46" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_df_first_diff(mdfl: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Produce the first difference of the level model df.</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">    mdfl: pd.DataFrame</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The model dataframe in levels</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The first differenced model dataframe</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        mdfl</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        .diff()</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        .loc[<span class="st">'1970'</span>:<span class="st">'2016'</span>]</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        .copy()</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        .assign(heritage_dummy<span class="op">=</span>mdfl[<span class="st">'heritage_dummy'</span>]) <span class="co"># don't want to lag diff this</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        .assign(constant<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        .assign(zero<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        .assign(nrrd<span class="op">=</span><span class="kw">lambda</span> df: df[[<span class="st">'natural_resource_revenue'</span>, <span class="st">'zero'</span>]].<span class="bu">min</span>(axis<span class="op">=</span><span class="st">'columns'</span>))</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        .assign(nrri<span class="op">=</span><span class="kw">lambda</span> df: df[[<span class="st">'natural_resource_revenue'</span>, <span class="st">'zero'</span>]].<span class="bu">max</span>(axis<span class="op">=</span><span class="st">'columns'</span>))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        .reindex(columns<span class="op">=</span>[</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">'natural_resource_revenue'</span>, <span class="st">'nrri'</span>, <span class="st">'nrrd'</span>, <span class="st">'corporate_income_tax'</span>, <span class="st">'personal_income_tax'</span>,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'other_revenue'</span>, <span class="st">'debt_service'</span>, <span class="st">'program_expenditure'</span>, <span class="st">'deficit'</span>, <span class="st">'ur_lag'</span>,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">'er_lag'</span>, <span class="st">'cad_usd_lag'</span>, <span class="st">'heritage_dummy'</span>, <span class="st">'constant'</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-47" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tbl1_diff(model_df: pd.DataFrame) <span class="op">-&gt;</span> pd.io.formats.style.Styler:</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Produce summary statistics of the first differenced data set.</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">    model_df: pd.DataFrame</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Input data set</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.io.formats.style.Styler:</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Nicely styled summary statistics</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> (</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        model_df_first_diff(model_df)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>        .drop(columns<span class="op">=</span>[<span class="st">'heritage_dummy'</span>, <span class="st">'constant'</span>])</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        .describe()</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>        .T</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>        .style.<span class="bu">format</span>({</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">'count'</span>: count,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'mean'</span>: number,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">'std'</span>: number,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">'min'</span>: number,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">'25%'</span>: number,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'50%'</span>: number,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">'75%'</span>: number,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">'max'</span>: number</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here’s Table 1 from the paper again:</p>
<div id="cell-49" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">"img/ferede_tbl_1.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here’s mine:</p>
<div id="cell-51" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tbl1_diff(mdfl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<style type="text/css">
</style>
<table id="T_dfab2_" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th"></th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">count</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">mean</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">std</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">min</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">25%</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">50%</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">75%</th>
<th class="col_heading level0 col7" data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_dfab2_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">natural_resource_revenue</td>
<td id="T_dfab2_row0_col0" class="data row0 col0">47</td>
<td id="T_dfab2_row0_col1" class="data row0 col1">-8.3</td>
<td id="T_dfab2_row0_col2" class="data row0 col2">1,365.3</td>
<td id="T_dfab2_row0_col3" class="data row0 col3">-4,543.2</td>
<td id="T_dfab2_row0_col4" class="data row0 col4">-551.3</td>
<td id="T_dfab2_row0_col5" class="data row0 col5">64.2</td>
<td id="T_dfab2_row0_col6" class="data row0 col6">463.5</td>
<td id="T_dfab2_row0_col7" class="data row0 col7">4,638.7</td>
</tr>
<tr class="even">
<td id="T_dfab2_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">nrri</td>
<td id="T_dfab2_row1_col0" class="data row1 col0">47</td>
<td id="T_dfab2_row1_col1" class="data row1 col1">437.8</td>
<td id="T_dfab2_row1_col2" class="data row1 col2">852.9</td>
<td id="T_dfab2_row1_col3" class="data row1 col3">0.00</td>
<td id="T_dfab2_row1_col4" class="data row1 col4">0.00</td>
<td id="T_dfab2_row1_col5" class="data row1 col5">64.2</td>
<td id="T_dfab2_row1_col6" class="data row1 col6">463.5</td>
<td id="T_dfab2_row1_col7" class="data row1 col7">4,638.7</td>
</tr>
<tr class="odd">
<td id="T_dfab2_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">nrrd</td>
<td id="T_dfab2_row2_col0" class="data row2 col0">47</td>
<td id="T_dfab2_row2_col1" class="data row2 col1">-446.1</td>
<td id="T_dfab2_row2_col2" class="data row2 col2">858.9</td>
<td id="T_dfab2_row2_col3" class="data row2 col3">-4,543.2</td>
<td id="T_dfab2_row2_col4" class="data row2 col4">-551.3</td>
<td id="T_dfab2_row2_col5" class="data row2 col5">0.00</td>
<td id="T_dfab2_row2_col6" class="data row2 col6">0.00</td>
<td id="T_dfab2_row2_col7" class="data row2 col7">0.00</td>
</tr>
<tr class="even">
<td id="T_dfab2_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">corporate_income_tax</td>
<td id="T_dfab2_row3_col0" class="data row3 col0">47</td>
<td id="T_dfab2_row3_col1" class="data row3 col1">13.3</td>
<td id="T_dfab2_row3_col2" class="data row3 col2">201.2</td>
<td id="T_dfab2_row3_col3" class="data row3 col3">-463.0</td>
<td id="T_dfab2_row3_col4" class="data row3 col4">-108.5</td>
<td id="T_dfab2_row3_col5" class="data row3 col5">25.9</td>
<td id="T_dfab2_row3_col6" class="data row3 col6">137.8</td>
<td id="T_dfab2_row3_col7" class="data row3 col7">447.1</td>
</tr>
<tr class="odd">
<td id="T_dfab2_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">personal_income_tax</td>
<td id="T_dfab2_row4_col0" class="data row4 col0">47</td>
<td id="T_dfab2_row4_col1" class="data row4 col1">42.7</td>
<td id="T_dfab2_row4_col2" class="data row4 col2">227.2</td>
<td id="T_dfab2_row4_col3" class="data row4 col3">-690.7</td>
<td id="T_dfab2_row4_col4" class="data row4 col4">-28.7</td>
<td id="T_dfab2_row4_col5" class="data row4 col5">40.0</td>
<td id="T_dfab2_row4_col6" class="data row4 col6">154.2</td>
<td id="T_dfab2_row4_col7" class="data row4 col7">936.9</td>
</tr>
<tr class="even">
<td id="T_dfab2_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">other_revenue</td>
<td id="T_dfab2_row5_col0" class="data row5 col0">47</td>
<td id="T_dfab2_row5_col1" class="data row5 col1">41.8</td>
<td id="T_dfab2_row5_col2" class="data row5 col2">577.2</td>
<td id="T_dfab2_row5_col3" class="data row5 col3">-1,268.7</td>
<td id="T_dfab2_row5_col4" class="data row5 col4">-288.9</td>
<td id="T_dfab2_row5_col5" class="data row5 col5">-28.0</td>
<td id="T_dfab2_row5_col6" class="data row5 col6">162.8</td>
<td id="T_dfab2_row5_col7" class="data row5 col7">2,417.6</td>
</tr>
<tr class="odd">
<td id="T_dfab2_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">debt_service</td>
<td id="T_dfab2_row6_col0" class="data row6 col0">47</td>
<td id="T_dfab2_row6_col1" class="data row6 col1">4.50</td>
<td id="T_dfab2_row6_col2" class="data row6 col2">86.2</td>
<td id="T_dfab2_row6_col3" class="data row6 col3">-247.5</td>
<td id="T_dfab2_row6_col4" class="data row6 col4">-21.6</td>
<td id="T_dfab2_row6_col5" class="data row6 col5">2.00</td>
<td id="T_dfab2_row6_col6" class="data row6 col6">36.0</td>
<td id="T_dfab2_row6_col7" class="data row6 col7">222.3</td>
</tr>
<tr class="even">
<td id="T_dfab2_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">program_expenditure</td>
<td id="T_dfab2_row7_col0" class="data row7 col0">47</td>
<td id="T_dfab2_row7_col1" class="data row7 col1">147.4</td>
<td id="T_dfab2_row7_col2" class="data row7 col2">734.5</td>
<td id="T_dfab2_row7_col3" class="data row7 col3">-1,263.2</td>
<td id="T_dfab2_row7_col4" class="data row7 col4">-245.9</td>
<td id="T_dfab2_row7_col5" class="data row7 col5">202.7</td>
<td id="T_dfab2_row7_col6" class="data row7 col6">552.7</td>
<td id="T_dfab2_row7_col7" class="data row7 col7">2,477.9</td>
</tr>
<tr class="odd">
<td id="T_dfab2_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">deficit</td>
<td id="T_dfab2_row8_col0" class="data row8 col0">47</td>
<td id="T_dfab2_row8_col1" class="data row8 col1">62.3</td>
<td id="T_dfab2_row8_col2" class="data row8 col2">1,578.2</td>
<td id="T_dfab2_row8_col3" class="data row8 col3">-4,722.8</td>
<td id="T_dfab2_row8_col4" class="data row8 col4">-806.6</td>
<td id="T_dfab2_row8_col5" class="data row8 col5">-39.0</td>
<td id="T_dfab2_row8_col6" class="data row8 col6">836.0</td>
<td id="T_dfab2_row8_col7" class="data row8 col7">4,431.3</td>
</tr>
<tr class="even">
<td id="T_dfab2_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">ur_lag</td>
<td id="T_dfab2_row9_col0" class="data row9 col0">47</td>
<td id="T_dfab2_row9_col1" class="data row9 col1">0.10</td>
<td id="T_dfab2_row9_col2" class="data row9 col2">1.10</td>
<td id="T_dfab2_row9_col3" class="data row9 col3">-1.8</td>
<td id="T_dfab2_row9_col4" class="data row9 col4">-0.7</td>
<td id="T_dfab2_row9_col5" class="data row9 col5">-0.1</td>
<td id="T_dfab2_row9_col6" class="data row9 col6">0.30</td>
<td id="T_dfab2_row9_col7" class="data row9 col7">3.90</td>
</tr>
<tr class="odd">
<td id="T_dfab2_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">er_lag</td>
<td id="T_dfab2_row10_col0" class="data row10 col0">47</td>
<td id="T_dfab2_row10_col1" class="data row10 col1">0.60</td>
<td id="T_dfab2_row10_col2" class="data row10 col2">3.30</td>
<td id="T_dfab2_row10_col3" class="data row10 col3">-3.2</td>
<td id="T_dfab2_row10_col4" class="data row10 col4">-0.2</td>
<td id="T_dfab2_row10_col5" class="data row10 col5">0.40</td>
<td id="T_dfab2_row10_col6" class="data row10 col6">0.90</td>
<td id="T_dfab2_row10_col7" class="data row10 col7">21.4</td>
</tr>
<tr class="even">
<td id="T_dfab2_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">cad_usd_lag</td>
<td id="T_dfab2_row11_col0" class="data row11 col0">44</td>
<td id="T_dfab2_row11_col1" class="data row11 col1">0.00</td>
<td id="T_dfab2_row11_col2" class="data row11 col2">0.10</td>
<td id="T_dfab2_row11_col3" class="data row11 col3">-0.2</td>
<td id="T_dfab2_row11_col4" class="data row11 col4">-0.0</td>
<td id="T_dfab2_row11_col5" class="data row11 col5">0.00</td>
<td id="T_dfab2_row11_col6" class="data row11 col6">0.10</td>
<td id="T_dfab2_row11_col7" class="data row11 col7">0.20</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>And with the data error:</p>
<div id="cell-53" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>tbl1_diff(mdfl_err)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<style type="text/css">
</style>
<table id="T_e3dc6_" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th"></th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">count</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">mean</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">std</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">min</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">25%</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">50%</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">75%</th>
<th class="col_heading level0 col7" data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_e3dc6_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">natural_resource_revenue</td>
<td id="T_e3dc6_row0_col0" class="data row0 col0">47</td>
<td id="T_e3dc6_row0_col1" class="data row0 col1">-8.3</td>
<td id="T_e3dc6_row0_col2" class="data row0 col2">977.5</td>
<td id="T_e3dc6_row0_col3" class="data row0 col3">-2,451.6</td>
<td id="T_e3dc6_row0_col4" class="data row0 col4">-471.1</td>
<td id="T_e3dc6_row0_col5" class="data row0 col5">64.2</td>
<td id="T_e3dc6_row0_col6" class="data row0 col6">458.3</td>
<td id="T_e3dc6_row0_col7" class="data row0 col7">2,757.8</td>
</tr>
<tr class="even">
<td id="T_e3dc6_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">nrri</td>
<td id="T_e3dc6_row1_col0" class="data row1 col0">47</td>
<td id="T_e3dc6_row1_col1" class="data row1 col1">349.1</td>
<td id="T_e3dc6_row1_col2" class="data row1 col2">579.4</td>
<td id="T_e3dc6_row1_col3" class="data row1 col3">0.00</td>
<td id="T_e3dc6_row1_col4" class="data row1 col4">0.00</td>
<td id="T_e3dc6_row1_col5" class="data row1 col5">64.2</td>
<td id="T_e3dc6_row1_col6" class="data row1 col6">458.3</td>
<td id="T_e3dc6_row1_col7" class="data row1 col7">2,757.8</td>
</tr>
<tr class="odd">
<td id="T_e3dc6_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">nrrd</td>
<td id="T_e3dc6_row2_col0" class="data row2 col0">47</td>
<td id="T_e3dc6_row2_col1" class="data row2 col1">-357.4</td>
<td id="T_e3dc6_row2_col2" class="data row2 col2">604.0</td>
<td id="T_e3dc6_row2_col3" class="data row2 col3">-2,451.6</td>
<td id="T_e3dc6_row2_col4" class="data row2 col4">-471.1</td>
<td id="T_e3dc6_row2_col5" class="data row2 col5">0.00</td>
<td id="T_e3dc6_row2_col6" class="data row2 col6">0.00</td>
<td id="T_e3dc6_row2_col7" class="data row2 col7">0.00</td>
</tr>
<tr class="even">
<td id="T_e3dc6_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">corporate_income_tax</td>
<td id="T_e3dc6_row3_col0" class="data row3 col0">47</td>
<td id="T_e3dc6_row3_col1" class="data row3 col1">13.3</td>
<td id="T_e3dc6_row3_col2" class="data row3 col2">201.2</td>
<td id="T_e3dc6_row3_col3" class="data row3 col3">-463.0</td>
<td id="T_e3dc6_row3_col4" class="data row3 col4">-108.5</td>
<td id="T_e3dc6_row3_col5" class="data row3 col5">25.9</td>
<td id="T_e3dc6_row3_col6" class="data row3 col6">137.8</td>
<td id="T_e3dc6_row3_col7" class="data row3 col7">447.1</td>
</tr>
<tr class="odd">
<td id="T_e3dc6_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">personal_income_tax</td>
<td id="T_e3dc6_row4_col0" class="data row4 col0">47</td>
<td id="T_e3dc6_row4_col1" class="data row4 col1">42.7</td>
<td id="T_e3dc6_row4_col2" class="data row4 col2">227.2</td>
<td id="T_e3dc6_row4_col3" class="data row4 col3">-690.7</td>
<td id="T_e3dc6_row4_col4" class="data row4 col4">-28.7</td>
<td id="T_e3dc6_row4_col5" class="data row4 col5">40.0</td>
<td id="T_e3dc6_row4_col6" class="data row4 col6">154.2</td>
<td id="T_e3dc6_row4_col7" class="data row4 col7">936.9</td>
</tr>
<tr class="even">
<td id="T_e3dc6_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">other_revenue</td>
<td id="T_e3dc6_row5_col0" class="data row5 col0">47</td>
<td id="T_e3dc6_row5_col1" class="data row5 col1">41.8</td>
<td id="T_e3dc6_row5_col2" class="data row5 col2">577.2</td>
<td id="T_e3dc6_row5_col3" class="data row5 col3">-1,268.7</td>
<td id="T_e3dc6_row5_col4" class="data row5 col4">-288.9</td>
<td id="T_e3dc6_row5_col5" class="data row5 col5">-28.0</td>
<td id="T_e3dc6_row5_col6" class="data row5 col6">162.8</td>
<td id="T_e3dc6_row5_col7" class="data row5 col7">2,417.6</td>
</tr>
<tr class="odd">
<td id="T_e3dc6_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">debt_service</td>
<td id="T_e3dc6_row6_col0" class="data row6 col0">47</td>
<td id="T_e3dc6_row6_col1" class="data row6 col1">4.50</td>
<td id="T_e3dc6_row6_col2" class="data row6 col2">86.2</td>
<td id="T_e3dc6_row6_col3" class="data row6 col3">-247.5</td>
<td id="T_e3dc6_row6_col4" class="data row6 col4">-21.6</td>
<td id="T_e3dc6_row6_col5" class="data row6 col5">2.00</td>
<td id="T_e3dc6_row6_col6" class="data row6 col6">36.0</td>
<td id="T_e3dc6_row6_col7" class="data row6 col7">222.3</td>
</tr>
<tr class="even">
<td id="T_e3dc6_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">program_expenditure</td>
<td id="T_e3dc6_row7_col0" class="data row7 col0">47</td>
<td id="T_e3dc6_row7_col1" class="data row7 col1">147.4</td>
<td id="T_e3dc6_row7_col2" class="data row7 col2">734.5</td>
<td id="T_e3dc6_row7_col3" class="data row7 col3">-1,263.2</td>
<td id="T_e3dc6_row7_col4" class="data row7 col4">-245.9</td>
<td id="T_e3dc6_row7_col5" class="data row7 col5">202.7</td>
<td id="T_e3dc6_row7_col6" class="data row7 col6">552.7</td>
<td id="T_e3dc6_row7_col7" class="data row7 col7">2,477.9</td>
</tr>
<tr class="odd">
<td id="T_e3dc6_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">deficit</td>
<td id="T_e3dc6_row8_col0" class="data row8 col0">47</td>
<td id="T_e3dc6_row8_col1" class="data row8 col1">62.3</td>
<td id="T_e3dc6_row8_col2" class="data row8 col2">1,260.2</td>
<td id="T_e3dc6_row8_col3" class="data row8 col3">-2,615.7</td>
<td id="T_e3dc6_row8_col4" class="data row8 col4">-758.1</td>
<td id="T_e3dc6_row8_col5" class="data row8 col5">-39.0</td>
<td id="T_e3dc6_row8_col6" class="data row8 col6">747.4</td>
<td id="T_e3dc6_row8_col7" class="data row8 col7">3,117.0</td>
</tr>
<tr class="even">
<td id="T_e3dc6_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">ur_lag</td>
<td id="T_e3dc6_row9_col0" class="data row9 col0">47</td>
<td id="T_e3dc6_row9_col1" class="data row9 col1">0.10</td>
<td id="T_e3dc6_row9_col2" class="data row9 col2">1.10</td>
<td id="T_e3dc6_row9_col3" class="data row9 col3">-1.8</td>
<td id="T_e3dc6_row9_col4" class="data row9 col4">-0.7</td>
<td id="T_e3dc6_row9_col5" class="data row9 col5">-0.1</td>
<td id="T_e3dc6_row9_col6" class="data row9 col6">0.30</td>
<td id="T_e3dc6_row9_col7" class="data row9 col7">3.90</td>
</tr>
<tr class="odd">
<td id="T_e3dc6_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">er_lag</td>
<td id="T_e3dc6_row10_col0" class="data row10 col0">47</td>
<td id="T_e3dc6_row10_col1" class="data row10 col1">0.60</td>
<td id="T_e3dc6_row10_col2" class="data row10 col2">3.30</td>
<td id="T_e3dc6_row10_col3" class="data row10 col3">-3.2</td>
<td id="T_e3dc6_row10_col4" class="data row10 col4">-0.2</td>
<td id="T_e3dc6_row10_col5" class="data row10 col5">0.40</td>
<td id="T_e3dc6_row10_col6" class="data row10 col6">0.90</td>
<td id="T_e3dc6_row10_col7" class="data row10 col7">21.4</td>
</tr>
<tr class="even">
<td id="T_e3dc6_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">cad_usd_lag</td>
<td id="T_e3dc6_row11_col0" class="data row11 col0">44</td>
<td id="T_e3dc6_row11_col1" class="data row11 col1">0.00</td>
<td id="T_e3dc6_row11_col2" class="data row11 col2">0.10</td>
<td id="T_e3dc6_row11_col3" class="data row11 col3">-0.2</td>
<td id="T_e3dc6_row11_col4" class="data row11 col4">-0.0</td>
<td id="T_e3dc6_row11_col5" class="data row11 col5">0.00</td>
<td id="T_e3dc6_row11_col6" class="data row11 col6">0.10</td>
<td id="T_e3dc6_row11_col7" class="data row11 col7">0.20</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As with everything so far, the data overall matches, and Natural Resource Revenue matches a lot better if I neglect to net out the heritage fund in 1976.</p>
</section>
<section id="unit-root-tests" class="level3">
<h3 class="anchored" data-anchor-id="unit-root-tests">Unit-Root Tests</h3>
<p>Table A1 in the paper shows the results of unit root tests for both the level and first differenced variables in the model. This section will reproduce those tables</p>
<div id="cell-56" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stationarity_tests(df: pd.DataFrame, first_diff: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute stationarity test statistics.</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">    df: pd.DataFrame</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The model input data</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">    first_diff: bool, default False</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Perform tests on first differenced version of the data</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> first_diff:</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> (</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>            model_df_first_diff(df)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>            .drop(columns<span class="op">=</span>[<span class="st">"heritage_dummy"</span>, <span class="st">"constant"</span>])</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> (</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>            df</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>            .loc[<span class="st">'1970'</span>:<span class="st">'2016'</span>]</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>            .copy()</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>            .drop(columns<span class="op">=</span>[<span class="st">'heritage_dummy'</span>])</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>            .reindex(</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>                columns<span class="op">=</span>[</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'natural_resource_revenue'</span>,</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'corporate_income_tax'</span>,</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'personal_income_tax'</span>,</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'other_revenue'</span>,</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'debt_service'</span>,</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'program_expenditure'</span>,</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'deficit'</span>,</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'ur_lag'</span>,</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'er_lag'</span>,</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'cad_usd_lag'</span>,</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    tests_dict <span class="op">=</span> {<span class="st">'ADF'</span>: ADF, <span class="st">'Phillips-Perron'</span>: PhillipsPerron, <span class="st">'DF-GLS'</span>: DFGLS}</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    cols <span class="op">=</span> df.columns</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    tests_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> test_label, test <span class="kw">in</span> tests_dict.items():</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> cols:</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> test_label <span class="op">!=</span> <span class="st">'Phillips-Perron'</span>:</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>                col_test <span class="op">=</span> test(df[col].dropna(), method<span class="op">=</span><span class="st">'BIC'</span>)</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>                col_test <span class="op">=</span> test(df[col].dropna())</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>            test_val <span class="op">=</span> col_test.stat</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>            test_p <span class="op">=</span> col_test.pvalue</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>            test_summary <span class="op">=</span> <span class="ss">f'val: </span><span class="sc">{</span>test_val<span class="sc">:0.3f}</span><span class="ss">, p: </span><span class="sc">{</span>test_p<span class="sc">:.1%}</span><span class="ss">'</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>            tests_df.loc[col, test_label] <span class="op">=</span> test_summary</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tests_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s the table from the paper:</p>
<div id="cell-58" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">"img/ferede_tbl_a1.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here is mine with my data set</p>
<div id="cell-60" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>stationarity_tests(mdfl, first_diff<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ADF</th>
<th data-quarto-table-cell-role="th">Phillips-Perron</th>
<th data-quarto-table-cell-role="th">DF-GLS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">natural_resource_revenue</td>
<td>val: -3.927, p: 0.2%</td>
<td>val: -4.056, p: 0.1%</td>
<td>val: -3.125, p: 0.2%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">corporate_income_tax</td>
<td>val: -2.340, p: 15.9%</td>
<td>val: -2.285, p: 17.7%</td>
<td>val: -1.676, p: 9.2%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">personal_income_tax</td>
<td>val: -1.650, p: 45.7%</td>
<td>val: -1.440, p: 56.3%</td>
<td>val: -0.688, p: 43.2%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">other_revenue</td>
<td>val: -2.196, p: 20.8%</td>
<td>val: -2.057, p: 26.2%</td>
<td>val: -1.585, p: 11.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">debt_service</td>
<td>val: -1.548, p: 51.0%</td>
<td>val: -1.697, p: 43.3%</td>
<td>val: -1.377, p: 16.2%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">program_expenditure</td>
<td>val: -2.966, p: 3.8%</td>
<td>val: -2.137, p: 23.0%</td>
<td>val: -0.682, p: 43.4%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">deficit</td>
<td>val: -3.510, p: 0.8%</td>
<td>val: -3.924, p: 0.2%</td>
<td>val: -3.537, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ur_lag</td>
<td>val: -2.709, p: 7.3%</td>
<td>val: -2.071, p: 25.6%</td>
<td>val: -2.319, p: 2.1%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">er_lag</td>
<td>val: -10.652, p: 0.0%</td>
<td>val: -2.931, p: 4.2%</td>
<td>val: -0.763, p: 39.7%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">cad_usd_lag</td>
<td>val: -2.454, p: 12.7%</td>
<td>val: -1.796, p: 38.2%</td>
<td>val: -1.870, p: 6.1%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-61" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>stationarity_tests(mdfl, first_diff<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ADF</th>
<th data-quarto-table-cell-role="th">Phillips-Perron</th>
<th data-quarto-table-cell-role="th">DF-GLS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">natural_resource_revenue</td>
<td>val: -7.403, p: 0.0%</td>
<td>val: -10.300, p: 0.0%</td>
<td>val: -7.430, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">nrri</td>
<td>val: -6.885, p: 0.0%</td>
<td>val: -6.896, p: 0.0%</td>
<td>val: -6.533, p: 0.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">nrrd</td>
<td>val: -7.835, p: 0.0%</td>
<td>val: -9.218, p: 0.0%</td>
<td>val: -7.634, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">corporate_income_tax</td>
<td>val: -7.228, p: 0.0%</td>
<td>val: -8.484, p: 0.0%</td>
<td>val: -7.103, p: 0.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">personal_income_tax</td>
<td>val: -5.560, p: 0.0%</td>
<td>val: -8.831, p: 0.0%</td>
<td>val: -6.703, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">other_revenue</td>
<td>val: -7.914, p: 0.0%</td>
<td>val: -8.169, p: 0.0%</td>
<td>val: -7.717, p: 0.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">debt_service</td>
<td>val: -3.918, p: 0.2%</td>
<td>val: -4.252, p: 0.1%</td>
<td>val: -3.931, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">program_expenditure</td>
<td>val: -2.545, p: 10.5%</td>
<td>val: -6.105, p: 0.0%</td>
<td>val: -2.461, p: 1.4%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">deficit</td>
<td>val: -2.485, p: 11.9%</td>
<td>val: -10.105, p: 0.0%</td>
<td>val: -2.509, p: 1.2%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ur_lag</td>
<td>val: -4.924, p: 0.0%</td>
<td>val: -4.056, p: 0.1%</td>
<td>val: -4.901, p: 0.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">er_lag</td>
<td>val: -2.697, p: 7.5%</td>
<td>val: -6.507, p: 0.0%</td>
<td>val: -2.742, p: 0.6%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">cad_usd_lag</td>
<td>val: -3.318, p: 1.4%</td>
<td>val: -3.042, p: 3.1%</td>
<td>val: -3.384, p: 0.1%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>And with the error data set:</p>
<div id="cell-63" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>stationarity_tests(mdfl_err, first_diff<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ADF</th>
<th data-quarto-table-cell-role="th">Phillips-Perron</th>
<th data-quarto-table-cell-role="th">DF-GLS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">natural_resource_revenue</td>
<td>val: -2.652, p: 8.3%</td>
<td>val: -2.875, p: 4.8%</td>
<td>val: -2.113, p: 3.5%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">corporate_income_tax</td>
<td>val: -2.340, p: 15.9%</td>
<td>val: -2.285, p: 17.7%</td>
<td>val: -1.676, p: 9.2%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">personal_income_tax</td>
<td>val: -1.650, p: 45.7%</td>
<td>val: -1.440, p: 56.3%</td>
<td>val: -0.688, p: 43.2%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">other_revenue</td>
<td>val: -2.196, p: 20.8%</td>
<td>val: -2.057, p: 26.2%</td>
<td>val: -1.585, p: 11.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">debt_service</td>
<td>val: -1.548, p: 51.0%</td>
<td>val: -1.697, p: 43.3%</td>
<td>val: -1.377, p: 16.2%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">program_expenditure</td>
<td>val: -2.966, p: 3.8%</td>
<td>val: -2.137, p: 23.0%</td>
<td>val: -0.682, p: 43.4%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">deficit</td>
<td>val: -2.566, p: 10.0%</td>
<td>val: -2.763, p: 6.4%</td>
<td>val: -2.606, p: 0.9%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ur_lag</td>
<td>val: -2.709, p: 7.3%</td>
<td>val: -2.071, p: 25.6%</td>
<td>val: -2.319, p: 2.1%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">er_lag</td>
<td>val: -10.652, p: 0.0%</td>
<td>val: -2.931, p: 4.2%</td>
<td>val: -0.763, p: 39.7%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">cad_usd_lag</td>
<td>val: -2.454, p: 12.7%</td>
<td>val: -1.796, p: 38.2%</td>
<td>val: -1.870, p: 6.1%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-64" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>stationarity_tests(mdfl_err, first_diff<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ADF</th>
<th data-quarto-table-cell-role="th">Phillips-Perron</th>
<th data-quarto-table-cell-role="th">DF-GLS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">natural_resource_revenue</td>
<td>val: -5.913, p: 0.0%</td>
<td>val: -7.791, p: 0.0%</td>
<td>val: -5.925, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">nrri</td>
<td>val: -6.119, p: 0.0%</td>
<td>val: -6.149, p: 0.0%</td>
<td>val: -5.731, p: 0.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">nrrd</td>
<td>val: -7.846, p: 0.0%</td>
<td>val: -8.008, p: 0.0%</td>
<td>val: -7.640, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">corporate_income_tax</td>
<td>val: -7.228, p: 0.0%</td>
<td>val: -8.484, p: 0.0%</td>
<td>val: -7.103, p: 0.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">personal_income_tax</td>
<td>val: -5.560, p: 0.0%</td>
<td>val: -8.831, p: 0.0%</td>
<td>val: -6.703, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">other_revenue</td>
<td>val: -7.914, p: 0.0%</td>
<td>val: -8.169, p: 0.0%</td>
<td>val: -7.717, p: 0.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">debt_service</td>
<td>val: -3.918, p: 0.2%</td>
<td>val: -4.252, p: 0.1%</td>
<td>val: -3.931, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">program_expenditure</td>
<td>val: -2.545, p: 10.5%</td>
<td>val: -6.105, p: 0.0%</td>
<td>val: -2.461, p: 1.4%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">deficit</td>
<td>val: -6.642, p: 0.0%</td>
<td>val: -8.574, p: 0.0%</td>
<td>val: -6.609, p: 0.0%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ur_lag</td>
<td>val: -4.924, p: 0.0%</td>
<td>val: -4.056, p: 0.1%</td>
<td>val: -4.901, p: 0.0%</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">er_lag</td>
<td>val: -2.697, p: 7.5%</td>
<td>val: -6.507, p: 0.0%</td>
<td>val: -2.742, p: 0.6%</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">cad_usd_lag</td>
<td>val: -3.318, p: 1.4%</td>
<td>val: -3.042, p: 3.1%</td>
<td>val: -3.384, p: 0.1%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Documentation on the test tools I used can be found <a href="https://arch.readthedocs.io/en/latest/unitroot/tests.html">here</a></p>
<p>There are some interesting differences. Most notable is that on the levels of the deficit series I reject the null hypothesis of a unit root using all three tests at a significance level &lt; 1%. The paper specifically notes that if the deficit is stationary in levels then a Vector Error Correction model can be applied. As the original author’s fails to reject the null he implements a Vector AutoRegression model on the first differenced data. In levels the only other series that I find to be stationary is natural resource revenue. ADF on program expenditure would also reject the null at 5% significance, but would fail to reject it using the other two tests.</p>
<p>Looking at the first differenced series, since that’s what the paper ultimately ends up using, I also reject the null hypothesis of a unit root for all variables using all tests at a 1% significant <em>except</em> program expenditure and deficit using Augmented Dickey Fuller. Those last two tests differ from what’s reported in the paper.</p>
<p>The paper notes that it uses the Schwarz Information Criterion (SIC) for determining optimal lags in the DF-GLS test. It doesn’t specify what it’s using in the other two tests. For ADF and DF-GLS I used the Schwarz/Bayesian IC (BIC), <a href="https://en.wikipedia.org/wiki/Bayesian_information_criterion">which is just another name for SIC</a>. Phillips-Perron only uses 1 lag and then Newey-West for a long run variance estimator. I also ran these tests using Akaike IC (AIC) for optimal lags for ADF and DF-GLS, with similar results.</p>
<p>Again we can see that using the results with the data error more closely matches the table in the paper, specifically around resource revenue and deficits.</p>
</section>
<section id="the-model" class="level3">
<h3 class="anchored" data-anchor-id="the-model">The Model</h3>
<p>The conclusions from the paper are based on fitting a <a href="https://en.wikipedia.org/wiki/Vector_autoregression">VAR</a> to the first differenced data set we’ve been analyzing above. Let’s do that now and compare the results to the paper.</p>
<div id="cell-67" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fit_var(mdfl: pd.DataFrame) <span class="op">-&gt;</span> statsmodels.tsa.vector_ar.var_model.VARResults:</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Fit a VAR to the model data.</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">    mdfl: pd.DataFrame</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Input model data</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">    statsmodels.tsa.vector_ar.var_model.VarResults</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The fitted model</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    vec_df <span class="op">=</span> (</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        model_df_first_diff(mdfl)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        .drop(columns<span class="op">=</span><span class="st">'natural_resource_revenue'</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        .dropna()</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    endog_df <span class="op">=</span> vec_df[[</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'nrri'</span>, <span class="st">'nrrd'</span>, <span class="st">'program_expenditure'</span>, <span class="st">'debt_service'</span>, <span class="st">'corporate_income_tax'</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">'personal_income_tax'</span>, <span class="st">'other_revenue'</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    exog_df <span class="op">=</span> vec_df[[<span class="st">'ur_lag'</span>, <span class="st">'er_lag'</span>, <span class="st">'cad_usd_lag'</span>, <span class="st">'heritage_dummy'</span>]]</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> VAR(endog<span class="op">=</span>endog_df, exog<span class="op">=</span>exog_df, freq<span class="op">=</span><span class="st">'AS'</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the model with 2 lags</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> model.fit(<span class="dv">2</span>)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-68" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> highlight_significance(val):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Colour code statistical significance.</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Takes a scalar and returns a string with</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">    the css property `'color: &lt;color&gt;'` where</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">    color is maroon for 1% significance, </span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">    red for 5% significance,</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">    orange for 10%, and black otherwise</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">    val: float</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">        The p value of a test</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">    str:</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">        A formatted colour coded p value</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="op">&lt;=</span> <span class="fl">0.01</span>:</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'maroon'</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> val <span class="op">&lt;=</span> <span class="fl">0.05</span>:</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> val <span class="op">&lt;=</span> <span class="fl">0.1</span>:</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'orange'</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'black'</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f'color: </span><span class="sc">{</span>color<span class="sc">}</span><span class="ss">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-69" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> fit_var(mdfl)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>results_err <span class="op">=</span> fit_var(mdfl_err)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> results.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-70" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the rows and columns of my parameters to match the paper</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>reindex_cols <span class="op">=</span> [<span class="st">"program_expenditure"</span>, <span class="st">"debt_service"</span>, <span class="st">"corporate_income_tax"</span>, <span class="st">"personal_income_tax"</span>, <span class="st">"other_revenue"</span>, <span class="st">"nrri"</span>, <span class="st">"nrrd"</span>]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>index_order <span class="op">=</span> [<span class="st">"nrri"</span>, <span class="st">"nrrd"</span>, <span class="st">"program_expenditure"</span>, <span class="st">"debt_service"</span>, <span class="st">"corporate_income_tax"</span>, <span class="st">"personal_income_tax"</span>, <span class="st">"other_revenue"</span>]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>reindex_rows <span class="op">=</span> <span class="bu">list</span>(chain.from_iterable((<span class="ss">f"L1.</span><span class="sc">{</span>row<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"L2.</span><span class="sc">{</span>row<span class="sc">}</span><span class="ss">"</span>) <span class="cf">for</span> row <span class="kw">in</span> index_order))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s the table from the paper:</p>
<div id="cell-72" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">"img/ferede_tbl_a2.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-73" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>results.params.reindex(index<span class="op">=</span>reindex_rows, columns<span class="op">=</span>reindex_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">program_expenditure</th>
<th data-quarto-table-cell-role="th">debt_service</th>
<th data-quarto-table-cell-role="th">corporate_income_tax</th>
<th data-quarto-table-cell-role="th">personal_income_tax</th>
<th data-quarto-table-cell-role="th">other_revenue</th>
<th data-quarto-table-cell-role="th">nrri</th>
<th data-quarto-table-cell-role="th">nrrd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.nrri</td>
<td>0.307014</td>
<td>-0.028267</td>
<td>0.081846</td>
<td>-0.052581</td>
<td>-0.197417</td>
<td>0.157775</td>
<td>0.002814</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.nrri</td>
<td>0.328607</td>
<td>0.006210</td>
<td>-0.044256</td>
<td>-0.031283</td>
<td>-0.073461</td>
<td>0.059988</td>
<td>-0.052033</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.nrrd</td>
<td>0.131802</td>
<td>-0.034380</td>
<td>0.026578</td>
<td>-0.144894</td>
<td>0.193682</td>
<td>-0.067386</td>
<td>-0.333322</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.nrrd</td>
<td>0.353466</td>
<td>-0.020362</td>
<td>0.089569</td>
<td>-0.037287</td>
<td>-0.147460</td>
<td>0.110970</td>
<td>-0.055394</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.program_expenditure</td>
<td>-0.089949</td>
<td>0.024739</td>
<td>-0.000802</td>
<td>-0.053868</td>
<td>0.070080</td>
<td>-0.065026</td>
<td>-0.105625</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.program_expenditure</td>
<td>-0.262484</td>
<td>0.009716</td>
<td>-0.031223</td>
<td>0.042743</td>
<td>0.410439</td>
<td>0.025392</td>
<td>-0.456895</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.debt_service</td>
<td>0.794685</td>
<td>0.401266</td>
<td>-0.108643</td>
<td>0.336733</td>
<td>0.400447</td>
<td>-2.370450</td>
<td>-0.278888</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.debt_service</td>
<td>-2.693856</td>
<td>0.228409</td>
<td>-0.088742</td>
<td>-0.179124</td>
<td>-0.041884</td>
<td>0.290135</td>
<td>-0.215989</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.corporate_income_tax</td>
<td>-0.972853</td>
<td>-0.092308</td>
<td>-0.210123</td>
<td>0.169059</td>
<td>-0.071714</td>
<td>-0.914462</td>
<td>0.730905</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.corporate_income_tax</td>
<td>0.088413</td>
<td>-0.199031</td>
<td>-0.206852</td>
<td>0.245321</td>
<td>-0.509617</td>
<td>-0.683630</td>
<td>-0.578293</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.personal_income_tax</td>
<td>0.959002</td>
<td>-0.041882</td>
<td>0.292569</td>
<td>-0.378646</td>
<td>-0.250158</td>
<td>0.347750</td>
<td>0.862515</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.personal_income_tax</td>
<td>0.814557</td>
<td>0.084507</td>
<td>-0.112748</td>
<td>-0.099020</td>
<td>-0.528812</td>
<td>0.385575</td>
<td>-0.226230</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.other_revenue</td>
<td>0.347131</td>
<td>-0.015834</td>
<td>-0.042866</td>
<td>-0.022883</td>
<td>-0.296401</td>
<td>0.224576</td>
<td>-0.102018</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.other_revenue</td>
<td>-0.140592</td>
<td>-0.010601</td>
<td>-0.009822</td>
<td>-0.010749</td>
<td>-0.339955</td>
<td>0.385613</td>
<td>0.043835</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-74" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>results.pvalues.reindex(index<span class="op">=</span>reindex_rows, columns<span class="op">=</span>reindex_cols).style.applymap(highlight_significance).<span class="bu">format</span>(<span class="st">"</span><span class="sc">{:.2%}</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<style type="text/css">
#T_b41d0_row0_col0,#T_b41d0_row0_col1,#T_b41d0_row0_col2,#T_b41d0_row0_col3,#T_b41d0_row0_col4,#T_b41d0_row0_col5,#T_b41d0_row0_col6,#T_b41d0_row1_col1,#T_b41d0_row1_col2,#T_b41d0_row1_col3,#T_b41d0_row1_col4,#T_b41d0_row1_col5,#T_b41d0_row1_col6,#T_b41d0_row2_col0,#T_b41d0_row2_col1,#T_b41d0_row2_col2,#T_b41d0_row2_col4,#T_b41d0_row2_col5,#T_b41d0_row2_col6,#T_b41d0_row3_col1,#T_b41d0_row3_col2,#T_b41d0_row3_col3,#T_b41d0_row3_col4,#T_b41d0_row3_col5,#T_b41d0_row3_col6,#T_b41d0_row4_col0,#T_b41d0_row4_col1,#T_b41d0_row4_col2,#T_b41d0_row4_col3,#T_b41d0_row4_col4,#T_b41d0_row4_col5,#T_b41d0_row4_col6,#T_b41d0_row5_col0,#T_b41d0_row5_col1,#T_b41d0_row5_col2,#T_b41d0_row5_col3,#T_b41d0_row5_col5,#T_b41d0_row6_col0,#T_b41d0_row6_col2,#T_b41d0_row6_col3,#T_b41d0_row6_col4,#T_b41d0_row6_col6,#T_b41d0_row7_col1,#T_b41d0_row7_col2,#T_b41d0_row7_col3,#T_b41d0_row7_col4,#T_b41d0_row7_col5,#T_b41d0_row7_col6,#T_b41d0_row8_col0,#T_b41d0_row8_col1,#T_b41d0_row8_col2,#T_b41d0_row8_col3,#T_b41d0_row8_col4,#T_b41d0_row8_col6,#T_b41d0_row9_col0,#T_b41d0_row9_col2,#T_b41d0_row9_col3,#T_b41d0_row9_col4,#T_b41d0_row9_col5,#T_b41d0_row9_col6,#T_b41d0_row10_col0,#T_b41d0_row10_col1,#T_b41d0_row10_col4,#T_b41d0_row10_col5,#T_b41d0_row10_col6,#T_b41d0_row11_col0,#T_b41d0_row11_col1,#T_b41d0_row11_col2,#T_b41d0_row11_col3,#T_b41d0_row11_col4,#T_b41d0_row11_col5,#T_b41d0_row11_col6,#T_b41d0_row12_col0,#T_b41d0_row12_col1,#T_b41d0_row12_col2,#T_b41d0_row12_col3,#T_b41d0_row12_col4,#T_b41d0_row12_col5,#T_b41d0_row12_col6,#T_b41d0_row13_col0,#T_b41d0_row13_col1,#T_b41d0_row13_col2,#T_b41d0_row13_col3,#T_b41d0_row13_col6{
            color:  black;
        }#T_b41d0_row1_col0,#T_b41d0_row2_col3,#T_b41d0_row5_col4,#T_b41d0_row6_col1,#T_b41d0_row9_col1,#T_b41d0_row13_col5{
            color:  red;
        }#T_b41d0_row3_col0,#T_b41d0_row5_col6,#T_b41d0_row6_col5,#T_b41d0_row7_col0,#T_b41d0_row8_col5,#T_b41d0_row10_col2,#T_b41d0_row10_col3,#T_b41d0_row13_col4{
            color:  orange;
        }</style>
<table id="T_b41d0_" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th"></th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">program_expenditure</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">debt_service</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">corporate_income_tax</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">personal_income_tax</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">other_revenue</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">nrri</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">nrrd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b41d0_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">L1.nrri</td>
<td id="T_b41d0_row0_col0" class="data row0 col0">17.85%</td>
<td id="T_b41d0_row0_col1" class="data row0 col1">28.23%</td>
<td id="T_b41d0_row0_col2" class="data row0 col2">19.05%</td>
<td id="T_b41d0_row0_col3" class="data row0 col3">46.54%</td>
<td id="T_b41d0_row0_col4" class="data row0 col4">31.40%</td>
<td id="T_b41d0_row0_col5" class="data row0 col5">35.35%</td>
<td id="T_b41d0_row0_col6" class="data row0 col6">99.27%</td>
</tr>
<tr class="even">
<td id="T_b41d0_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">L2.nrri</td>
<td id="T_b41d0_row1_col0" class="data row1 col0">3.41%</td>
<td id="T_b41d0_row1_col1" class="data row1 col1">72.82%</td>
<td id="T_b41d0_row1_col2" class="data row1 col2">29.76%</td>
<td id="T_b41d0_row1_col3" class="data row1 col3">52.28%</td>
<td id="T_b41d0_row1_col4" class="data row1 col4">58.14%</td>
<td id="T_b41d0_row1_col5" class="data row1 col5">60.37%</td>
<td id="T_b41d0_row1_col6" class="data row1 col6">80.42%</td>
</tr>
<tr class="odd">
<td id="T_b41d0_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">L1.nrrd</td>
<td id="T_b41d0_row2_col0" class="data row2 col0">54.73%</td>
<td id="T_b41d0_row2_col1" class="data row2 col1">17.31%</td>
<td id="T_b41d0_row2_col2" class="data row2 col2">65.78%</td>
<td id="T_b41d0_row2_col3" class="data row2 col3">3.61%</td>
<td id="T_b41d0_row2_col4" class="data row2 col4">30.34%</td>
<td id="T_b41d0_row2_col5" class="data row2 col5">67.97%</td>
<td id="T_b41d0_row2_col6" class="data row2 col6">26.07%</td>
</tr>
<tr class="even">
<td id="T_b41d0_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">L2.nrrd</td>
<td id="T_b41d0_row3_col0" class="data row3 col0">8.86%</td>
<td id="T_b41d0_row3_col1" class="data row3 col1">39.46%</td>
<td id="T_b41d0_row3_col2" class="data row3 col2">11.53%</td>
<td id="T_b41d0_row3_col3" class="data row3 col3">56.93%</td>
<td id="T_b41d0_row3_col4" class="data row3 col4">40.83%</td>
<td id="T_b41d0_row3_col5" class="data row3 col5">47.32%</td>
<td id="T_b41d0_row3_col6" class="data row3 col6">84.37%</td>
</tr>
<tr class="odd">
<td id="T_b41d0_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">L1.program_expenditure</td>
<td id="T_b41d0_row4_col0" class="data row4 col0">63.72%</td>
<td id="T_b41d0_row4_col1" class="data row4 col1">26.03%</td>
<td id="T_b41d0_row4_col2" class="data row4 col2">98.78%</td>
<td id="T_b41d0_row4_col3" class="data row4 col3">37.09%</td>
<td id="T_b41d0_row4_col4" class="data row4 col4">66.89%</td>
<td id="T_b41d0_row4_col5" class="data row4 col5">64.73%</td>
<td id="T_b41d0_row4_col6" class="data row4 col6">68.24%</td>
</tr>
<tr class="even">
<td id="T_b41d0_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">L2.program_expenditure</td>
<td id="T_b41d0_row5_col0" class="data row5 col0">16.67%</td>
<td id="T_b41d0_row5_col1" class="data row5 col1">65.69%</td>
<td id="T_b41d0_row5_col2" class="data row5 col2">54.83%</td>
<td id="T_b41d0_row5_col3" class="data row5 col3">47.56%</td>
<td id="T_b41d0_row5_col4" class="data row5 col4">1.18%</td>
<td id="T_b41d0_row5_col5" class="data row5 col5">85.75%</td>
<td id="T_b41d0_row5_col6" class="data row5 col6">7.53%</td>
</tr>
<tr class="odd">
<td id="T_b41d0_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">L1.debt_service</td>
<td id="T_b41d0_row6_col0" class="data row6 col0">62.80%</td>
<td id="T_b41d0_row6_col1" class="data row6 col1">3.37%</td>
<td id="T_b41d0_row6_col2" class="data row6 col2">80.89%</td>
<td id="T_b41d0_row6_col3" class="data row6 col3">51.54%</td>
<td id="T_b41d0_row6_col4" class="data row6 col4">77.63%</td>
<td id="T_b41d0_row6_col5" class="data row6 col5">5.24%</td>
<td id="T_b41d0_row6_col6" class="data row6 col6">90.00%</td>
</tr>
<tr class="even">
<td id="T_b41d0_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">L2.debt_service</td>
<td id="T_b41d0_row7_col0" class="data row7 col0">9.99%</td>
<td id="T_b41d0_row7_col1" class="data row7 col1">22.60%</td>
<td id="T_b41d0_row7_col2" class="data row7 col2">84.32%</td>
<td id="T_b41d0_row7_col3" class="data row7 col3">72.89%</td>
<td id="T_b41d0_row7_col4" class="data row7 col4">97.63%</td>
<td id="T_b41d0_row7_col5" class="data row7 col5">81.21%</td>
<td id="T_b41d0_row7_col6" class="data row7 col6">92.24%</td>
</tr>
<tr class="odd">
<td id="T_b41d0_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">L1.corporate_income_tax</td>
<td id="T_b41d0_row8_col0" class="data row8 col0">17.66%</td>
<td id="T_b41d0_row8_col1" class="data row8 col1">26.58%</td>
<td id="T_b41d0_row8_col2" class="data row8 col2">28.68%</td>
<td id="T_b41d0_row8_col3" class="data row8 col3">45.69%</td>
<td id="T_b41d0_row8_col4" class="data row8 col4">90.77%</td>
<td id="T_b41d0_row8_col5" class="data row8 col5">8.83%</td>
<td id="T_b41d0_row8_col6" class="data row8 col6">45.31%</td>
</tr>
<tr class="even">
<td id="T_b41d0_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">L2.corporate_income_tax</td>
<td id="T_b41d0_row9_col0" class="data row9 col0">90.24%</td>
<td id="T_b41d0_row9_col1" class="data row9 col1">1.66%</td>
<td id="T_b41d0_row9_col2" class="data row9 col2">29.52%</td>
<td id="T_b41d0_row9_col3" class="data row9 col3">28.12%</td>
<td id="T_b41d0_row9_col4" class="data row9 col4">41.09%</td>
<td id="T_b41d0_row9_col5" class="data row9 col5">20.34%</td>
<td id="T_b41d0_row9_col6" class="data row9 col6">55.35%</td>
</tr>
<tr class="odd">
<td id="T_b41d0_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">L1.personal_income_tax</td>
<td id="T_b41d0_row10_col0" class="data row10 col0">11.91%</td>
<td id="T_b41d0_row10_col1" class="data row10 col1">55.47%</td>
<td id="T_b41d0_row10_col2" class="data row10 col2">8.27%</td>
<td id="T_b41d0_row10_col3" class="data row10 col3">5.12%</td>
<td id="T_b41d0_row10_col4" class="data row10 col4">63.61%</td>
<td id="T_b41d0_row10_col5" class="data row10 col5">44.83%</td>
<td id="T_b41d0_row10_col6" class="data row10 col6">30.03%</td>
</tr>
<tr class="even">
<td id="T_b41d0_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">L2.personal_income_tax</td>
<td id="T_b41d0_row11_col0" class="data row11 col0">12.28%</td>
<td id="T_b41d0_row11_col1" class="data row11 col1">16.47%</td>
<td id="T_b41d0_row11_col2" class="data row11 col2">43.56%</td>
<td id="T_b41d0_row11_col3" class="data row11 col3">55.23%</td>
<td id="T_b41d0_row11_col4" class="data row11 col4">24.36%</td>
<td id="T_b41d0_row11_col5" class="data row11 col5">32.70%</td>
<td id="T_b41d0_row11_col6" class="data row11 col6">75.15%</td>
</tr>
<tr class="odd">
<td id="T_b41d0_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">L1.other_revenue</td>
<td id="T_b41d0_row12_col0" class="data row12 col0">11.25%</td>
<td id="T_b41d0_row12_col1" class="data row12 col1">52.98%</td>
<td id="T_b41d0_row12_col2" class="data row12 col2">47.45%</td>
<td id="T_b41d0_row12_col3" class="data row12 col3">74.03%</td>
<td id="T_b41d0_row12_col4" class="data row12 col4">11.48%</td>
<td id="T_b41d0_row12_col5" class="data row12 col5">16.83%</td>
<td id="T_b41d0_row12_col6" class="data row12 col6">73.04%</td>
</tr>
<tr class="even">
<td id="T_b41d0_level0_row13" class="row_heading level0 row13" data-quarto-table-cell-role="th">L2.other_revenue</td>
<td id="T_b41d0_row13_col0" class="data row13 col0">54.20%</td>
<td id="T_b41d0_row13_col1" class="data row13 col1">68.98%</td>
<td id="T_b41d0_row13_col2" class="data row13 col2">87.64%</td>
<td id="T_b41d0_row13_col3" class="data row13 col3">88.26%</td>
<td id="T_b41d0_row13_col4" class="data row13 col4">8.61%</td>
<td id="T_b41d0_row13_col5" class="data row13 col5">2.48%</td>
<td id="T_b41d0_row13_col6" class="data row13 col6">88.83%</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-75" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>results_err.params.reindex(index<span class="op">=</span>reindex_rows, columns<span class="op">=</span>reindex_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">program_expenditure</th>
<th data-quarto-table-cell-role="th">debt_service</th>
<th data-quarto-table-cell-role="th">corporate_income_tax</th>
<th data-quarto-table-cell-role="th">personal_income_tax</th>
<th data-quarto-table-cell-role="th">other_revenue</th>
<th data-quarto-table-cell-role="th">nrri</th>
<th data-quarto-table-cell-role="th">nrrd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.nrri</td>
<td>0.531582</td>
<td>-0.024542</td>
<td>0.107731</td>
<td>-0.123072</td>
<td>-0.150617</td>
<td>0.208281</td>
<td>-0.080868</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.nrri</td>
<td>-0.184916</td>
<td>-0.003392</td>
<td>-0.079855</td>
<td>-0.031832</td>
<td>-0.134564</td>
<td>0.023580</td>
<td>0.076075</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.nrrd</td>
<td>-0.164689</td>
<td>-0.033454</td>
<td>0.002593</td>
<td>-0.085661</td>
<td>0.110608</td>
<td>-0.058941</td>
<td>-0.105753</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.nrrd</td>
<td>0.179398</td>
<td>-0.020179</td>
<td>0.072508</td>
<td>0.027891</td>
<td>-0.178763</td>
<td>0.081864</td>
<td>-0.032297</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.program_expenditure</td>
<td>-0.148569</td>
<td>0.024375</td>
<td>0.010583</td>
<td>-0.035676</td>
<td>0.095480</td>
<td>-0.051153</td>
<td>-0.027252</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.program_expenditure</td>
<td>-0.274168</td>
<td>0.012469</td>
<td>-0.028204</td>
<td>0.060072</td>
<td>0.419366</td>
<td>0.043190</td>
<td>-0.266589</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.debt_service</td>
<td>-0.138827</td>
<td>0.391381</td>
<td>-0.192682</td>
<td>0.456206</td>
<td>0.250624</td>
<td>-2.379002</td>
<td>0.182134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.debt_service</td>
<td>-1.839879</td>
<td>0.244616</td>
<td>0.030729</td>
<td>-0.321701</td>
<td>0.208719</td>
<td>0.387627</td>
<td>0.026273</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.corporate_income_tax</td>
<td>-0.591167</td>
<td>-0.087419</td>
<td>-0.166213</td>
<td>0.193455</td>
<td>-0.009423</td>
<td>-1.069105</td>
<td>0.084121</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.corporate_income_tax</td>
<td>0.986182</td>
<td>-0.171169</td>
<td>-0.180347</td>
<td>0.219469</td>
<td>-0.439124</td>
<td>-0.441616</td>
<td>0.337464</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.personal_income_tax</td>
<td>0.446547</td>
<td>-0.050872</td>
<td>0.281996</td>
<td>-0.364826</td>
<td>-0.291701</td>
<td>0.365623</td>
<td>0.499642</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.personal_income_tax</td>
<td>0.537147</td>
<td>0.068406</td>
<td>-0.161794</td>
<td>-0.159843</td>
<td>-0.598672</td>
<td>0.542697</td>
<td>-0.054906</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L1.other_revenue</td>
<td>0.319686</td>
<td>-0.014068</td>
<td>-0.036482</td>
<td>-0.021636</td>
<td>-0.280981</td>
<td>0.235076</td>
<td>-0.052564</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L2.other_revenue</td>
<td>-0.328932</td>
<td>-0.009975</td>
<td>-0.017606</td>
<td>0.013375</td>
<td>-0.362590</td>
<td>0.255418</td>
<td>-0.122366</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-76" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>results_err.pvalues.reindex(index<span class="op">=</span>reindex_rows, columns<span class="op">=</span>reindex_cols).style.applymap(highlight_significance).<span class="bu">format</span>(<span class="st">"</span><span class="sc">{:.2%}</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<style type="text/css">
#T_e8301_row0_col0,#T_e8301_row6_col5,#T_e8301_row8_col5,#T_e8301_row10_col3,#T_e8301_row13_col4{
            color:  orange;
        }#T_e8301_row0_col1,#T_e8301_row0_col2,#T_e8301_row0_col3,#T_e8301_row0_col4,#T_e8301_row0_col5,#T_e8301_row0_col6,#T_e8301_row1_col0,#T_e8301_row1_col1,#T_e8301_row1_col2,#T_e8301_row1_col3,#T_e8301_row1_col4,#T_e8301_row1_col5,#T_e8301_row1_col6,#T_e8301_row2_col0,#T_e8301_row2_col1,#T_e8301_row2_col2,#T_e8301_row2_col3,#T_e8301_row2_col4,#T_e8301_row2_col5,#T_e8301_row2_col6,#T_e8301_row3_col0,#T_e8301_row3_col1,#T_e8301_row3_col2,#T_e8301_row3_col3,#T_e8301_row3_col4,#T_e8301_row3_col5,#T_e8301_row3_col6,#T_e8301_row4_col0,#T_e8301_row4_col1,#T_e8301_row4_col2,#T_e8301_row4_col3,#T_e8301_row4_col4,#T_e8301_row4_col5,#T_e8301_row4_col6,#T_e8301_row5_col0,#T_e8301_row5_col1,#T_e8301_row5_col2,#T_e8301_row5_col3,#T_e8301_row5_col5,#T_e8301_row5_col6,#T_e8301_row6_col0,#T_e8301_row6_col2,#T_e8301_row6_col3,#T_e8301_row6_col4,#T_e8301_row6_col6,#T_e8301_row7_col0,#T_e8301_row7_col1,#T_e8301_row7_col2,#T_e8301_row7_col3,#T_e8301_row7_col4,#T_e8301_row7_col5,#T_e8301_row7_col6,#T_e8301_row8_col0,#T_e8301_row8_col1,#T_e8301_row8_col2,#T_e8301_row8_col3,#T_e8301_row8_col4,#T_e8301_row8_col6,#T_e8301_row9_col0,#T_e8301_row9_col2,#T_e8301_row9_col3,#T_e8301_row9_col4,#T_e8301_row9_col5,#T_e8301_row9_col6,#T_e8301_row10_col0,#T_e8301_row10_col1,#T_e8301_row10_col2,#T_e8301_row10_col4,#T_e8301_row10_col5,#T_e8301_row10_col6,#T_e8301_row11_col0,#T_e8301_row11_col1,#T_e8301_row11_col2,#T_e8301_row11_col3,#T_e8301_row11_col4,#T_e8301_row11_col5,#T_e8301_row11_col6,#T_e8301_row12_col0,#T_e8301_row12_col1,#T_e8301_row12_col2,#T_e8301_row12_col3,#T_e8301_row12_col4,#T_e8301_row12_col5,#T_e8301_row12_col6,#T_e8301_row13_col0,#T_e8301_row13_col1,#T_e8301_row13_col2,#T_e8301_row13_col3,#T_e8301_row13_col5,#T_e8301_row13_col6{
            color:  black;
        }#T_e8301_row5_col4,#T_e8301_row6_col1,#T_e8301_row9_col1{
            color:  red;
        }</style>
<table id="T_e8301_" class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th"></th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">program_expenditure</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">debt_service</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">corporate_income_tax</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">personal_income_tax</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">other_revenue</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">nrri</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">nrrd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_e8301_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">L1.nrri</td>
<td id="T_e8301_row0_col0" class="data row0 col0">6.09%</td>
<td id="T_e8301_row0_col1" class="data row0 col1">42.34%</td>
<td id="T_e8301_row0_col2" class="data row0 col2">12.95%</td>
<td id="T_e8301_row0_col3" class="data row0 col3">12.90%</td>
<td id="T_e8301_row0_col4" class="data row0 col4">50.73%</td>
<td id="T_e8301_row0_col5" class="data row0 col5">26.95%</td>
<td id="T_e8301_row0_col6" class="data row0 col6">75.32%</td>
</tr>
<tr class="even">
<td id="T_e8301_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">L2.nrri</td>
<td id="T_e8301_row1_col0" class="data row1 col0">53.56%</td>
<td id="T_e8301_row1_col1" class="data row1 col1">91.63%</td>
<td id="T_e8301_row1_col2" class="data row1 col2">28.56%</td>
<td id="T_e8301_row1_col3" class="data row1 col3">70.91%</td>
<td id="T_e8301_row1_col4" class="data row1 col4">57.36%</td>
<td id="T_e8301_row1_col5" class="data row1 col5">90.54%</td>
<td id="T_e8301_row1_col6" class="data row1 col6">77.87%</td>
</tr>
<tr class="odd">
<td id="T_e8301_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">L1.nrrd</td>
<td id="T_e8301_row2_col0" class="data row2 col0">54.19%</td>
<td id="T_e8301_row2_col1" class="data row2 col1">25.17%</td>
<td id="T_e8301_row2_col2" class="data row2 col2">96.94%</td>
<td id="T_e8301_row2_col3" class="data row2 col3">26.71%</td>
<td id="T_e8301_row2_col4" class="data row2 col4">60.91%</td>
<td id="T_e8301_row2_col5" class="data row2 col5">74.28%</td>
<td id="T_e8301_row2_col6" class="data row2 col6">66.59%</td>
</tr>
<tr class="even">
<td id="T_e8301_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">L2.nrrd</td>
<td id="T_e8301_row3_col0" class="data row3 col0">49.68%</td>
<td id="T_e8301_row3_col1" class="data row3 col1">47.94%</td>
<td id="T_e8301_row3_col2" class="data row3 col2">27.30%</td>
<td id="T_e8301_row3_col3" class="data row3 col3">71.17%</td>
<td id="T_e8301_row3_col4" class="data row3 col4">39.79%</td>
<td id="T_e8301_row3_col5" class="data row3 col5">64.10%</td>
<td id="T_e8301_row3_col6" class="data row3 col6">89.27%</td>
</tr>
<tr class="odd">
<td id="T_e8301_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">L1.program_expenditure</td>
<td id="T_e8301_row4_col0" class="data row4 col0">47.97%</td>
<td id="T_e8301_row4_col1" class="data row4 col1">28.33%</td>
<td id="T_e8301_row4_col2" class="data row4 col2">84.07%</td>
<td id="T_e8301_row4_col3" class="data row4 col3">55.26%</td>
<td id="T_e8301_row4_col4" class="data row4 col4">57.06%</td>
<td id="T_e8301_row4_col5" class="data row4 col5">71.44%</td>
<td id="T_e8301_row4_col6" class="data row4 col6">88.63%</td>
</tr>
<tr class="even">
<td id="T_e8301_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">L2.program_expenditure</td>
<td id="T_e8301_row5_col0" class="data row5 col0">18.15%</td>
<td id="T_e8301_row5_col1" class="data row5 col1">57.39%</td>
<td id="T_e8301_row5_col2" class="data row5 col2">58.33%</td>
<td id="T_e8301_row5_col3" class="data row5 col3">30.58%</td>
<td id="T_e8301_row5_col4" class="data row5 col4">1.07%</td>
<td id="T_e8301_row5_col5" class="data row5 col5">75.16%</td>
<td id="T_e8301_row5_col6" class="data row5 col6">15.20%</td>
</tr>
<tr class="odd">
<td id="T_e8301_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">L1.debt_service</td>
<td id="T_e8301_row6_col0" class="data row6 col0">93.96%</td>
<td id="T_e8301_row6_col1" class="data row6 col1">4.82%</td>
<td id="T_e8301_row6_col2" class="data row6 col2">67.48%</td>
<td id="T_e8301_row6_col3" class="data row6 col3">38.39%</td>
<td id="T_e8301_row6_col4" class="data row6 col4">86.44%</td>
<td id="T_e8301_row6_col5" class="data row6 col5">5.10%</td>
<td id="T_e8301_row6_col6" class="data row6 col6">91.27%</td>
</tr>
<tr class="even">
<td id="T_e8301_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">L2.debt_service</td>
<td id="T_e8301_row7_col0" class="data row7 col0">31.50%</td>
<td id="T_e8301_row7_col1" class="data row7 col1">21.64%</td>
<td id="T_e8301_row7_col2" class="data row7 col2">94.66%</td>
<td id="T_e8301_row7_col3" class="data row7 col3">53.88%</td>
<td id="T_e8301_row7_col4" class="data row7 col4">88.68%</td>
<td id="T_e8301_row7_col5" class="data row7 col5">75.02%</td>
<td id="T_e8301_row7_col6" class="data row7 col6">98.74%</td>
</tr>
<tr class="odd">
<td id="T_e8301_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">L1.corporate_income_tax</td>
<td id="T_e8301_row8_col0" class="data row8 col0">47.78%</td>
<td id="T_e8301_row8_col1" class="data row8 col1">33.14%</td>
<td id="T_e8301_row8_col2" class="data row8 col2">42.56%</td>
<td id="T_e8301_row8_col3" class="data row8 col3">41.64%</td>
<td id="T_e8301_row8_col4" class="data row8 col4">98.87%</td>
<td id="T_e8301_row8_col5" class="data row8 col5">5.35%</td>
<td id="T_e8301_row8_col6" class="data row8 col6">91.13%</td>
</tr>
<tr class="even">
<td id="T_e8301_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">L2.corporate_income_tax</td>
<td id="T_e8301_row9_col0" class="data row9 col0">17.90%</td>
<td id="T_e8301_row9_col1" class="data row9 col1">3.09%</td>
<td id="T_e8301_row9_col2" class="data row9 col2">32.66%</td>
<td id="T_e8301_row9_col3" class="data row9 col3">29.54%</td>
<td id="T_e8301_row9_col4" class="data row9 col4">45.50%</td>
<td id="T_e8301_row9_col5" class="data row9 col5">36.55%</td>
<td id="T_e8301_row9_col6" class="data row9 col6">61.21%</td>
</tr>
<tr class="odd">
<td id="T_e8301_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">L1.personal_income_tax</td>
<td id="T_e8301_row10_col0" class="data row10 col0">51.65%</td>
<td id="T_e8301_row10_col1" class="data row10 col1">49.41%</td>
<td id="T_e8301_row10_col2" class="data row10 col2">10.20%</td>
<td id="T_e8301_row10_col3" class="data row10 col3">6.37%</td>
<td id="T_e8301_row10_col4" class="data row10 col4">59.67%</td>
<td id="T_e8301_row10_col5" class="data row10 col5">42.44%</td>
<td id="T_e8301_row10_col6" class="data row10 col6">42.34%</td>
</tr>
<tr class="even">
<td id="T_e8301_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">L2.personal_income_tax</td>
<td id="T_e8301_row11_col0" class="data row11 col0">39.82%</td>
<td id="T_e8301_row11_col1" class="data row11 col1">31.95%</td>
<td id="T_e8301_row11_col2" class="data row11 col2">30.98%</td>
<td id="T_e8301_row11_col3" class="data row11 col3">37.91%</td>
<td id="T_e8301_row11_col4" class="data row11 col4">23.97%</td>
<td id="T_e8301_row11_col5" class="data row11 col5">19.93%</td>
<td id="T_e8301_row11_col6" class="data row11 col6">92.41%</td>
</tr>
<tr class="odd">
<td id="T_e8301_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">L1.other_revenue</td>
<td id="T_e8301_row12_col0" class="data row12 col0">16.84%</td>
<td id="T_e8301_row12_col1" class="data row12 col1">57.49%</td>
<td id="T_e8301_row12_col2" class="data row12 col2">53.04%</td>
<td id="T_e8301_row12_col3" class="data row12 col3">74.43%</td>
<td id="T_e8301_row12_col4" class="data row12 col4">13.07%</td>
<td id="T_e8301_row12_col5" class="data row12 col5">12.78%</td>
<td id="T_e8301_row12_col6" class="data row12 col6">80.28%</td>
</tr>
<tr class="even">
<td id="T_e8301_level0_row13" class="row_heading level0 row13" data-quarto-table-cell-role="th">L2.other_revenue</td>
<td id="T_e8301_row13_col0" class="data row13 col0">18.72%</td>
<td id="T_e8301_row13_col1" class="data row13 col1">71.13%</td>
<td id="T_e8301_row13_col2" class="data row13 col2">77.81%</td>
<td id="T_e8301_row13_col3" class="data row13 col3">85.12%</td>
<td id="T_e8301_row13_col4" class="data row13 col4">6.95%</td>
<td id="T_e8301_row13_col5" class="data row13 col5">12.35%</td>
<td id="T_e8301_row13_col6" class="data row13 col6">58.85%</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Once again, my results with the data error included are much closer to the original paper results. Note that without the data error, program spending is shown to rise in response to an increase <em>or</em> decrease in natural resource revenue, but only on the second lag (at least at a statistically significant level. That’s completely contrary to the main thesis of the paper. Now, given that I’ve shown with the corrected data set that budget deficits are stationary in levels, maybe a more appropriate form of analysis would have been to use a VECM as the paper states it would have been, but from this I can say that the data error has led to a significant change in the outcome of the analysis.</p>
</section>
<section id="impulse-response-functions" class="level3">
<h3 class="anchored" data-anchor-id="impulse-response-functions">Impulse Response Functions</h3>
<p>The actual results of the paper involve taking the estimated impulse response functions derived from the VAR model and examining their implications. Given the results above I’m not sure there’s a lot of value in reproducing all of the other results of this model, but I do want to at least reproduce the IRFs.</p>
<div id="cell-79" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> irf_tbl(result: statsmodels.tsa.vector_ar.var_model.VARResults, impulse: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Show the IRF as in table 3 of the paper.</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co">    result: statsmodels.tsa.vector_ar.var_model.VARResults</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The fitted VAR</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co">    impulse: str</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co">        The impulse function, either an increase or decrease in natural resource revenue</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co">    pd.DataFrame</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co">        A summary table</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    irf <span class="op">=</span> result.irf()</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    irf_stderr <span class="op">=</span> irf.stderr()</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    irfs <span class="op">=</span> irf.irfs</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> <span class="bu">list</span>(results.params.columns)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _impulse_response(impulse: <span class="bu">str</span>, response: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Get a specific IRF out of the big array.</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="co">        ----------</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co">        impulse: str</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="co">            The impulse function</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="co">        response: str</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="co">            The response function</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="co">        -------</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="co">        pd.DataFrame</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="co">            The 3 period IRF</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>        imp_ind <span class="op">=</span> params.index(impulse)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>        res_ind <span class="op">=</span> params.index(response)</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>        ir <span class="op">=</span> irfs[:, res_ind, imp_ind]</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>        se <span class="op">=</span> irf_stderr[:, res_ind, imp_ind]</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>        imp_name <span class="op">=</span> response <span class="op">+</span> <span class="st">'_impulse'</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>        se_name <span class="op">=</span> response <span class="op">+</span> <span class="st">'_se'</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame({imp_name: ir, se_name: se})</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df.loc[<span class="dv">1</span>:<span class="dv">3</span>].T</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>    responses <span class="op">=</span> params[<span class="dv">2</span>:]</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.concat([_impulse_response(impulse, response) <span class="cf">for</span> response <span class="kw">in</span> responses])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="table-3" class="level4">
<h4 class="anchored" data-anchor-id="table-3">Table 3</h4>
<p>IMPACTS ON ALBERTA’S BUDGET OF A ONE-DOLLAR INNOVATION IN NON-RENEWABLE-RESOURCE REVENUE (ASYMMETRIC CASE), 1970/71–2016/17</p>
<div id="cell-81" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">"img/ferede_tbl_3.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-43-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-82" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>irf_tbl(results, <span class="st">"nrrd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">program_expenditure_impulse</td>
<td>0.131802</td>
<td>0.152091</td>
<td>-0.263057</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">program_expenditure_se</td>
<td>0.219009</td>
<td>0.213435</td>
<td>0.189561</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">debt_service_impulse</td>
<td>-0.034380</td>
<td>-0.016984</td>
<td>-0.025572</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">debt_service_se</td>
<td>0.025235</td>
<td>0.026153</td>
<td>0.023777</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">corporate_income_tax_impulse</td>
<td>0.026578</td>
<td>0.022545</td>
<td>0.014045</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">corporate_income_tax_se</td>
<td>0.060010</td>
<td>0.062050</td>
<td>0.049948</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">personal_income_tax_impulse</td>
<td>-0.144894</td>
<td>0.050801</td>
<td>0.023045</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">personal_income_tax_se</td>
<td>0.069135</td>
<td>0.090279</td>
<td>0.082072</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">other_revenue_impulse</td>
<td>0.193682</td>
<td>-0.226313</td>
<td>0.116648</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">other_revenue_se</td>
<td>0.188179</td>
<td>0.190130</td>
<td>0.169276</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-83" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>irf_tbl(results, <span class="st">"nrri"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">program_expenditure_impulse</td>
<td>0.307014</td>
<td>0.128759</td>
<td>0.032942</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">program_expenditure_se</td>
<td>0.228184</td>
<td>0.200129</td>
<td>0.172849</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">debt_service_impulse</td>
<td>-0.028267</td>
<td>-0.004321</td>
<td>-0.011658</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">debt_service_se</td>
<td>0.026292</td>
<td>0.026157</td>
<td>0.025746</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">corporate_income_tax_impulse</td>
<td>0.081846</td>
<td>-0.052562</td>
<td>-0.019982</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">corporate_income_tax_se</td>
<td>0.062524</td>
<td>0.057369</td>
<td>0.041195</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">personal_income_tax_impulse</td>
<td>-0.052581</td>
<td>-0.027779</td>
<td>0.040890</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">personal_income_tax_se</td>
<td>0.072031</td>
<td>0.085436</td>
<td>0.068562</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">other_revenue_impulse</td>
<td>-0.197417</td>
<td>-0.028068</td>
<td>0.187637</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">other_revenue_se</td>
<td>0.196063</td>
<td>0.172347</td>
<td>0.147472</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-84" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>irf_tbl(results_err, <span class="st">"nrrd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">program_expenditure_impulse</td>
<td>-0.164689</td>
<td>0.190170</td>
<td>0.024520</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">program_expenditure_se</td>
<td>0.270039</td>
<td>0.264733</td>
<td>0.231589</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">debt_service_impulse</td>
<td>-0.033454</td>
<td>-0.029727</td>
<td>-0.027865</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">debt_service_se</td>
<td>0.029185</td>
<td>0.033489</td>
<td>0.028892</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">corporate_income_tax_impulse</td>
<td>0.002593</td>
<td>0.041965</td>
<td>0.055297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">corporate_income_tax_se</td>
<td>0.067657</td>
<td>0.068952</td>
<td>0.054178</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">personal_income_tax_impulse</td>
<td>-0.085661</td>
<td>0.064177</td>
<td>-0.029006</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">personal_income_tax_se</td>
<td>0.077188</td>
<td>0.085444</td>
<td>0.072486</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">other_revenue_impulse</td>
<td>0.110608</td>
<td>-0.211807</td>
<td>-0.018863</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">other_revenue_se</td>
<td>0.216285</td>
<td>0.206303</td>
<td>0.197149</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-85" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>irf_tbl(results_err, <span class="st">"nrri"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">program_expenditure_impulse</td>
<td>0.531582</td>
<td>-0.303243</td>
<td>-0.034754</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">program_expenditure_se</td>
<td>0.283645</td>
<td>0.282106</td>
<td>0.247443</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">debt_service_impulse</td>
<td>-0.024542</td>
<td>-0.003484</td>
<td>-0.020839</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">debt_service_se</td>
<td>0.030655</td>
<td>0.033327</td>
<td>0.030126</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">corporate_income_tax_impulse</td>
<td>0.107731</td>
<td>-0.094389</td>
<td>-0.033291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">corporate_income_tax_se</td>
<td>0.071066</td>
<td>0.074045</td>
<td>0.058701</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">personal_income_tax_impulse</td>
<td>-0.123072</td>
<td>-0.011699</td>
<td>0.079664</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">personal_income_tax_se</td>
<td>0.081077</td>
<td>0.093111</td>
<td>0.078465</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">other_revenue_impulse</td>
<td>-0.150617</td>
<td>-0.053069</td>
<td>0.289039</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">other_revenue_se</td>
<td>0.227183</td>
<td>0.225741</td>
<td>0.202924</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Same patters as we’ve seen above, the results with the data error included are pretty close to what the paper reports.</p>
</section>
<section id="plot-the-irfs" class="level4">
<h4 class="anchored" data-anchor-id="plot-the-irfs">Plot the IRFs</h4>
<p>Ok, this is the last bit I want to reproduce, just because IRF charts look cool so it would be a shame to leave them out.</p>
<div id="cell-88" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">"img/ferede_fig_3.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-89" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>results.irf().plot(impulse<span class="op">=</span><span class="st">'nrri'</span>, response<span class="op">=</span><span class="st">'program_expenditure'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-90" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>results.irf().plot(impulse<span class="op">=</span><span class="st">'nrrd'</span>, response<span class="op">=</span><span class="st">'program_expenditure'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-50-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-91" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>results_err.irf().plot(impulse<span class="op">=</span><span class="st">'nrri'</span>, response<span class="op">=</span><span class="st">'program_expenditure'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-51-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-92" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>results_err.irf().plot(impulse<span class="op">=</span><span class="st">'nrrd'</span>, response<span class="op">=</span><span class="st">'program_expenditure'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2021-02-26-ferede_files/figure-html/cell-52-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These are harder to eyeball because I’m showing the individual responses and the paper is showing the cumulative ones. But again, if I think about what adding up the points in my charts would look like, they end up closer to the data set with the error.</p>
</section>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The initial goal of this exercise was to practice my python and econometrics. I’ve certainly done that over the course of working on it, but as a bonus I’ve also demonstrated how sensitive results can be to even a single data point (at least when you have relatively few samples.</p>
</section>
<section id="appendix-raw-tables" class="level2">
<h2 class="anchored" data-anchor-id="appendix-raw-tables">Appendix: Raw tables</h2>
<p>For the purposes of validation, here are the full tables I used to produce both the summary statistics above, as well as all statistical models and tests below</p>
<div id="cell-96" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>mdfl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">program_expenditure</th>
<th data-quarto-table-cell-role="th">debt_service</th>
<th data-quarto-table-cell-role="th">corporate_income_tax</th>
<th data-quarto-table-cell-role="th">personal_income_tax</th>
<th data-quarto-table-cell-role="th">other_revenue</th>
<th data-quarto-table-cell-role="th">natural_resource_revenue</th>
<th data-quarto-table-cell-role="th">deficit</th>
<th data-quarto-table-cell-role="th">heritage_dummy</th>
<th data-quarto-table-cell-role="th">ur_lag</th>
<th data-quarto-table-cell-role="th">er_lag</th>
<th data-quarto-table-cell-role="th">cad_usd_lag</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">budget_dt</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1964-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1965-01-01</td>
<td>2327.844291</td>
<td>11.272854</td>
<td>174.729232</td>
<td>231.093501</td>
<td>1442.925275</td>
<td>1397.833860</td>
<td>-907.464724</td>
<td>0.0</td>
<td>2.500000</td>
<td>37.935748</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1966-01-01</td>
<td>2891.984579</td>
<td>10.750872</td>
<td>145.136773</td>
<td>301.024417</td>
<td>1542.750138</td>
<td>1290.104645</td>
<td>-376.280521</td>
<td>0.0</td>
<td>2.500000</td>
<td>37.935748</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1967-01-01</td>
<td>4436.875339</td>
<td>10.199713</td>
<td>203.994268</td>
<td>407.988537</td>
<td>2351.033944</td>
<td>1116.868620</td>
<td>367.189683</td>
<td>0.0</td>
<td>2.500000</td>
<td>37.935748</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1968-01-01</td>
<td>4368.535726</td>
<td>19.160244</td>
<td>239.503055</td>
<td>469.425988</td>
<td>2639.323668</td>
<td>1360.377353</td>
<td>-320.934094</td>
<td>0.0</td>
<td>2.700000</td>
<td>38.322148</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1969-01-01</td>
<td>4396.849967</td>
<td>17.909776</td>
<td>286.556413</td>
<td>599.977490</td>
<td>2444.684401</td>
<td>1141.748209</td>
<td>-58.206771</td>
<td>0.0</td>
<td>3.300000</td>
<td>39.041995</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1970-01-01</td>
<td>4745.762712</td>
<td>38.135593</td>
<td>245.762712</td>
<td>771.186441</td>
<td>2737.288136</td>
<td>978.813559</td>
<td>50.847458</td>
<td>0.0</td>
<td>3.400000</td>
<td>39.833226</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1971-01-01</td>
<td>4993.823780</td>
<td>67.916003</td>
<td>271.664014</td>
<td>767.051333</td>
<td>2848.477084</td>
<td>1090.651114</td>
<td>83.896240</td>
<td>0.0</td>
<td>5.200000</td>
<td>39.686520</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1972-01-01</td>
<td>4988.477844</td>
<td>85.114978</td>
<td>362.663820</td>
<td>858.551083</td>
<td>2768.087112</td>
<td>1224.915554</td>
<td>-140.624746</td>
<td>0.0</td>
<td>5.700000</td>
<td>38.456938</td>
<td>1.009883</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1973-01-01</td>
<td>5004.356719</td>
<td>81.151731</td>
<td>382.089398</td>
<td>977.202089</td>
<td>2387.213408</td>
<td>2160.664826</td>
<td>-821.661272</td>
<td>0.0</td>
<td>5.700000</td>
<td>39.470588</td>
<td>0.990792</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-01-01</td>
<td>6124.378806</td>
<td>92.793618</td>
<td>829.155879</td>
<td>1038.689856</td>
<td>2352.767225</td>
<td>4549.880638</td>
<td>-2553.321174</td>
<td>0.0</td>
<td>5.300000</td>
<td>40.843443</td>
<td>1.000233</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1975-01-01</td>
<td>7071.218716</td>
<td>84.149869</td>
<td>686.347373</td>
<td>925.648564</td>
<td>2721.722340</td>
<td>4417.868145</td>
<td>-1596.217836</td>
<td>0.0</td>
<td>3.500000</td>
<td>42.840909</td>
<td>0.978133</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1976-01-01</td>
<td>6845.363213</td>
<td>59.113672</td>
<td>326.307469</td>
<td>1038.036080</td>
<td>2830.362613</td>
<td>-125.320985</td>
<td>2835.091707</td>
<td>1.0</td>
<td>4.200000</td>
<td>43.439912</td>
<td>1.017267</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1977-01-01</td>
<td>7061.151803</td>
<td>46.247496</td>
<td>554.969954</td>
<td>1206.639219</td>
<td>2720.193639</td>
<td>4513.335196</td>
<td>-1887.738708</td>
<td>1.0</td>
<td>3.891667</td>
<td>64.800000</td>
<td>0.986075</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1978-01-01</td>
<td>6825.084687</td>
<td>48.260049</td>
<td>545.709790</td>
<td>1225.062794</td>
<td>2643.165786</td>
<td>4701.642511</td>
<td>-2242.236144</td>
<td>1.0</td>
<td>4.475000</td>
<td>64.633333</td>
<td>1.063525</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1979-01-01</td>
<td>9302.990086</td>
<td>32.774318</td>
<td>342.491620</td>
<td>1265.088664</td>
<td>2525.261181</td>
<td>5181.619632</td>
<td>21.303307</td>
<td>1.0</td>
<td>4.750000</td>
<td>65.341667</td>
<td>1.140767</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1980-01-01</td>
<td>9937.742745</td>
<td>31.376340</td>
<td>620.395823</td>
<td>1337.773062</td>
<td>2676.972321</td>
<td>4797.727697</td>
<td>536.250183</td>
<td>1.0</td>
<td>3.966667</td>
<td>67.125000</td>
<td>1.171558</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1981-01-01</td>
<td>10441.551444</td>
<td>109.885646</td>
<td>701.577586</td>
<td>1597.568239</td>
<td>5094.588359</td>
<td>4001.769572</td>
<td>-844.066666</td>
<td>1.0</td>
<td>3.866667</td>
<td>68.050000</td>
<td>1.169408</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1982-01-01</td>
<td>12281.969722</td>
<td>57.716023</td>
<td>639.073783</td>
<td>1731.480694</td>
<td>4808.269418</td>
<td>2887.899921</td>
<td>2272.961929</td>
<td>1.0</td>
<td>3.883333</td>
<td>69.500000</td>
<td>1.198892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1983-01-01</td>
<td>11489.190564</td>
<td>168.596206</td>
<td>771.007210</td>
<td>1488.773513</td>
<td>4813.372379</td>
<td>4001.941517</td>
<td>582.692150</td>
<td>1.0</td>
<td>7.750000</td>
<td>66.275000</td>
<td>1.233858</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1984-01-01</td>
<td>11320.287262</td>
<td>218.545766</td>
<td>793.666203</td>
<td>1396.584127</td>
<td>5529.782999</td>
<td>4306.693537</td>
<td>-487.893837</td>
<td>1.0</td>
<td>11.008333</td>
<td>63.816667</td>
<td>1.232583</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1985-01-01</td>
<td>12869.198063</td>
<td>168.831114</td>
<td>723.561918</td>
<td>1410.945740</td>
<td>5622.447161</td>
<td>3939.701880</td>
<td>1341.372479</td>
<td>1.0</td>
<td>11.408333</td>
<td>63.933333</td>
<td>1.295150</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1986-01-01</td>
<td>11863.166376</td>
<td>263.862833</td>
<td>351.817111</td>
<td>1570.739021</td>
<td>4940.542816</td>
<td>1488.115306</td>
<td>3775.814955</td>
<td>1.0</td>
<td>9.775000</td>
<td>65.491667</td>
<td>1.365900</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1987-01-01</td>
<td>10791.884860</td>
<td>486.136253</td>
<td>505.683690</td>
<td>1900.350807</td>
<td>5480.081397</td>
<td>2231.807343</td>
<td>1160.097876</td>
<td>0.0</td>
<td>10.008333</td>
<td>65.350000</td>
<td>1.389767</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1988-01-01</td>
<td>10774.989850</td>
<td>655.047057</td>
<td>572.857965</td>
<td>1675.835569</td>
<td>5818.165763</td>
<td>1713.642551</td>
<td>1649.535059</td>
<td>0.0</td>
<td>9.525000</td>
<td>65.450000</td>
<td>1.326175</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1989-01-01</td>
<td>10745.455671</td>
<td>865.692419</td>
<td>543.484030</td>
<td>1968.964999</td>
<td>5716.675586</td>
<td>1739.148895</td>
<td>1642.874581</td>
<td>0.0</td>
<td>7.983333</td>
<td>66.925000</td>
<td>1.230942</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1990-01-01</td>
<td>10614.752643</td>
<td>923.523101</td>
<td>578.462597</td>
<td>2014.173627</td>
<td>5689.536231</td>
<td>1936.372929</td>
<td>1319.730359</td>
<td>0.0</td>
<td>7.158333</td>
<td>67.516667</td>
<td>1.184108</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1991-01-01</td>
<td>10060.915107</td>
<td>878.291420</td>
<td>488.608088</td>
<td>2043.330951</td>
<td>5298.490171</td>
<td>1351.526066</td>
<td>1757.251250</td>
<td>0.0</td>
<td>6.916667</td>
<td>67.500000</td>
<td>1.167017</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1992-01-01</td>
<td>10490.255898</td>
<td>920.232018</td>
<td>413.099221</td>
<td>1811.929709</td>
<td>5614.128666</td>
<td>1415.691681</td>
<td>2155.638638</td>
<td>0.0</td>
<td>8.250000</td>
<td>66.591667</td>
<td>1.145975</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1993-01-01</td>
<td>9567.673764</td>
<td>1046.414892</td>
<td>540.289188</td>
<td>1820.154561</td>
<td>5604.076850</td>
<td>1782.195133</td>
<td>867.372924</td>
<td>0.0</td>
<td>9.458333</td>
<td>65.383333</td>
<td>1.208808</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1994-01-01</td>
<td>8304.447335</td>
<td>1075.635389</td>
<td>661.029079</td>
<td>1886.982358</td>
<td>5328.892392</td>
<td>2081.040289</td>
<td>-577.861395</td>
<td>0.0</td>
<td>9.583333</td>
<td>64.875000</td>
<td>1.290167</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1995-01-01</td>
<td>7542.256294</td>
<td>1000.994980</td>
<td>792.231321</td>
<td>1889.578759</td>
<td>4888.995090</td>
<td>1657.024370</td>
<td>-684.578266</td>
<td>0.0</td>
<td>8.783333</td>
<td>65.725000</td>
<td>1.365892</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1996-01-01</td>
<td>7286.510699</td>
<td>838.743299</td>
<td>807.190029</td>
<td>1976.382124</td>
<td>4455.321793</td>
<td>2314.288966</td>
<td>-1427.928914</td>
<td>0.0</td>
<td>7.841667</td>
<td>66.650000</td>
<td>1.372650</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1997-01-01</td>
<td>7598.400009</td>
<td>729.331650</td>
<td>1020.071271</td>
<td>2138.894710</td>
<td>4551.426710</td>
<td>2084.277589</td>
<td>-1466.938621</td>
<td>0.0</td>
<td>6.883333</td>
<td>67.316667</td>
<td>1.363700</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-01-01</td>
<td>7647.600932</td>
<td>735.120709</td>
<td>884.383797</td>
<td>2452.712386</td>
<td>4366.478407</td>
<td>1262.339259</td>
<td>-583.192208</td>
<td>0.0</td>
<td>5.875000</td>
<td>67.925000</td>
<td>1.384867</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1999-01-01</td>
<td>8342.393922</td>
<td>487.608742</td>
<td>640.113987</td>
<td>2601.260027</td>
<td>4640.443868</td>
<td>2371.737084</td>
<td>-1423.552301</td>
<td>0.0</td>
<td>5.583333</td>
<td>68.566667</td>
<td>1.483633</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-01</td>
<td>8710.352822</td>
<td>474.863472</td>
<td>980.253881</td>
<td>1910.598641</td>
<td>4348.877202</td>
<td>5129.494603</td>
<td>-3184.008033</td>
<td>0.0</td>
<td>5.666667</td>
<td>68.500000</td>
<td>1.485825</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2001-01-01</td>
<td>9338.287124</td>
<td>360.113309</td>
<td>1037.070500</td>
<td>1946.193764</td>
<td>4320.894451</td>
<td>2897.190669</td>
<td>-502.948950</td>
<td>0.0</td>
<td>4.966667</td>
<td>68.675000</td>
<td>1.485517</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-01</td>
<td>8826.496403</td>
<td>209.515399</td>
<td>888.679810</td>
<td>2127.725707</td>
<td>3820.134757</td>
<td>3138.329395</td>
<td>-938.857868</td>
<td>0.0</td>
<td>4.725000</td>
<td>68.975000</td>
<td>1.549017</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2003-01-01</td>
<td>8889.845744</td>
<td>112.157737</td>
<td>701.917057</td>
<td>1909.164731</td>
<td>4925.835384</td>
<td>3176.836868</td>
<td>-1711.750559</td>
<td>0.0</td>
<td>5.341667</td>
<td>68.975000</td>
<td>1.570592</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-01-01</td>
<td>9563.476337</td>
<td>121.092191</td>
<td>947.887219</td>
<td>1864.098004</td>
<td>5040.562703</td>
<td>3907.027522</td>
<td>-2075.006920</td>
<td>0.0</td>
<td>5.116667</td>
<td>69.741667</td>
<td>1.401167</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2005-01-01</td>
<td>10252.960247</td>
<td>95.080363</td>
<td>1118.344428</td>
<td>1793.108293</td>
<td>5214.467798</td>
<td>4829.545684</td>
<td>-2607.425593</td>
<td>1.0</td>
<td>4.591667</td>
<td>70.125000</td>
<td>1.301575</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2006-01-01</td>
<td>10491.526962</td>
<td>77.006633</td>
<td>1291.562414</td>
<td>2729.974686</td>
<td>5203.857546</td>
<td>3943.455955</td>
<td>-2600.317006</td>
<td>1.0</td>
<td>3.941667</td>
<td>69.850000</td>
<td>1.211483</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2007-01-01</td>
<td>11093.119793</td>
<td>71.131049</td>
<td>1560.562037</td>
<td>2749.181812</td>
<td>4712.930591</td>
<td>3359.113940</td>
<td>-1217.537538</td>
<td>1.0</td>
<td>3.458333</td>
<td>70.791667</td>
<td>1.134375</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2008-01-01</td>
<td>11481.223206</td>
<td>65.508008</td>
<td>1339.134853</td>
<td>2742.517945</td>
<td>3444.209491</td>
<td>3752.538047</td>
<td>268.330878</td>
<td>0.0</td>
<td>3.566667</td>
<td>71.383333</td>
<td>1.074183</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2009-01-01</td>
<td>11192.177199</td>
<td>111.838586</td>
<td>1464.684956</td>
<td>2426.866512</td>
<td>5009.321141</td>
<td>2085.188848</td>
<td>317.954328</td>
<td>0.0</td>
<td>3.691667</td>
<td>71.800000</td>
<td>1.066767</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2010-01-01</td>
<td>11408.370379</td>
<td>141.808459</td>
<td>1001.672465</td>
<td>2292.670240</td>
<td>4699.207866</td>
<td>2532.122236</td>
<td>1024.506031</td>
<td>0.0</td>
<td>6.575000</td>
<td>69.416667</td>
<td>1.141442</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2011-01-01</td>
<td>11288.615235</td>
<td>144.188676</td>
<td>1062.777455</td>
<td>2474.323912</td>
<td>4526.773140</td>
<td>3362.283433</td>
<td>6.645971</td>
<td>0.0</td>
<td>6.516667</td>
<td>68.133333</td>
<td>1.030125</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2012-01-01</td>
<td>11491.360391</td>
<td>143.201492</td>
<td>1330.207614</td>
<td>2690.901483</td>
<td>4642.860889</td>
<td>2175.711738</td>
<td>794.880159</td>
<td>0.0</td>
<td>5.433333</td>
<td>69.508333</td>
<td>0.989025</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2013-01-01</td>
<td>11803.343431</td>
<td>158.459375</td>
<td>1473.940765</td>
<td>2829.977012</td>
<td>5288.245930</td>
<td>2572.413384</td>
<td>-202.774285</td>
<td>0.0</td>
<td>4.700000</td>
<td>69.958333</td>
<td>0.999408</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2014-01-01</td>
<td>11006.721496</td>
<td>182.199224</td>
<td>1479.028999</td>
<td>2817.708454</td>
<td>4975.008515</td>
<td>2283.359468</td>
<td>-366.184716</td>
<td>0.0</td>
<td>4.658333</td>
<td>69.591667</td>
<td>1.029992</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2015-01-01</td>
<td>10664.784806</td>
<td>176.142114</td>
<td>1040.727000</td>
<td>2817.529567</td>
<td>4492.864354</td>
<td>691.915996</td>
<td>1797.890004</td>
<td>0.0</td>
<td>4.775000</td>
<td>69.058333</td>
<td>1.104683</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2016-01-01</td>
<td>11322.810385</td>
<td>230.029051</td>
<td>913.571647</td>
<td>2608.854241</td>
<td>4407.637789</td>
<td>750.684901</td>
<td>2872.090858</td>
<td>0.0</td>
<td>6.091667</td>
<td>68.408333</td>
<td>1.278808</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2017-01-01</td>
<td>11433.853017</td>
<td>319.856119</td>
<td>813.921696</td>
<td>2543.505301</td>
<td>5094.564399</td>
<td>1175.559759</td>
<td>2126.157981</td>
<td>0.0</td>
<td>8.133333</td>
<td>66.250000</td>
<td>1.325583</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7.883333</td>
<td>66.316667</td>
<td>1.297858</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-97" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>model_df_first_diff(mdfl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">natural_resource_revenue</th>
<th data-quarto-table-cell-role="th">nrri</th>
<th data-quarto-table-cell-role="th">nrrd</th>
<th data-quarto-table-cell-role="th">corporate_income_tax</th>
<th data-quarto-table-cell-role="th">personal_income_tax</th>
<th data-quarto-table-cell-role="th">other_revenue</th>
<th data-quarto-table-cell-role="th">debt_service</th>
<th data-quarto-table-cell-role="th">program_expenditure</th>
<th data-quarto-table-cell-role="th">deficit</th>
<th data-quarto-table-cell-role="th">ur_lag</th>
<th data-quarto-table-cell-role="th">er_lag</th>
<th data-quarto-table-cell-role="th">cad_usd_lag</th>
<th data-quarto-table-cell-role="th">heritage_dummy</th>
<th data-quarto-table-cell-role="th">constant</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">budget_dt</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1970-01-01</td>
<td>-162.934650</td>
<td>0.000000</td>
<td>-162.934650</td>
<td>-40.793701</td>
<td>171.208950</td>
<td>292.603734</td>
<td>20.225817</td>
<td>348.912745</td>
<td>109.054229</td>
<td>0.100000</td>
<td>0.791232</td>
<td>NaN</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1971-01-01</td>
<td>111.837554</td>
<td>111.837554</td>
<td>0.000000</td>
<td>25.901302</td>
<td>-4.135108</td>
<td>111.188949</td>
<td>29.780410</td>
<td>248.061068</td>
<td>33.048782</td>
<td>1.800000</td>
<td>-0.146706</td>
<td>NaN</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1972-01-01</td>
<td>134.264440</td>
<td>134.264440</td>
<td>0.000000</td>
<td>90.999806</td>
<td>91.499750</td>
<td>-80.389972</td>
<td>17.198975</td>
<td>-5.345936</td>
<td>-224.520986</td>
<td>0.500000</td>
<td>-1.229583</td>
<td>NaN</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1973-01-01</td>
<td>935.749273</td>
<td>935.749273</td>
<td>0.000000</td>
<td>19.425579</td>
<td>118.651006</td>
<td>-380.873704</td>
<td>-3.963247</td>
<td>15.878875</td>
<td>-681.036526</td>
<td>0.000000</td>
<td>1.013650</td>
<td>-0.019092</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-01-01</td>
<td>2389.215812</td>
<td>2389.215812</td>
<td>0.000000</td>
<td>447.066481</td>
<td>61.487767</td>
<td>-34.446183</td>
<td>11.641888</td>
<td>1120.022088</td>
<td>-1731.659902</td>
<td>-0.400000</td>
<td>1.372855</td>
<td>0.009442</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1975-01-01</td>
<td>-132.012493</td>
<td>0.000000</td>
<td>-132.012493</td>
<td>-142.808507</td>
<td>-113.041292</td>
<td>368.955115</td>
<td>-8.643749</td>
<td>946.839909</td>
<td>957.103338</td>
<td>-1.800000</td>
<td>1.997466</td>
<td>-0.022100</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1976-01-01</td>
<td>-4543.189130</td>
<td>0.000000</td>
<td>-4543.189130</td>
<td>-360.039903</td>
<td>112.387516</td>
<td>108.640274</td>
<td>-25.036197</td>
<td>-225.855503</td>
<td>4431.309543</td>
<td>0.700000</td>
<td>0.599003</td>
<td>0.039133</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1977-01-01</td>
<td>4638.656180</td>
<td>4638.656180</td>
<td>0.000000</td>
<td>228.662485</td>
<td>168.603139</td>
<td>-110.168974</td>
<td>-12.866176</td>
<td>215.788591</td>
<td>-4722.830415</td>
<td>-0.308333</td>
<td>21.360088</td>
<td>-0.031192</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1978-01-01</td>
<td>188.307315</td>
<td>188.307315</td>
<td>0.000000</td>
<td>-9.260164</td>
<td>18.423575</td>
<td>-77.027853</td>
<td>2.012553</td>
<td>-236.067116</td>
<td>-354.497436</td>
<td>0.583333</td>
<td>-0.166667</td>
<td>0.077450</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1979-01-01</td>
<td>479.977121</td>
<td>479.977121</td>
<td>0.000000</td>
<td>-203.218170</td>
<td>40.025870</td>
<td>-117.904605</td>
<td>-15.485732</td>
<td>2477.905398</td>
<td>2263.539451</td>
<td>0.275000</td>
<td>0.708333</td>
<td>0.077242</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1980-01-01</td>
<td>-383.891935</td>
<td>0.000000</td>
<td>-383.891935</td>
<td>277.904203</td>
<td>72.684398</td>
<td>151.711140</td>
<td>-1.397977</td>
<td>634.752660</td>
<td>514.946876</td>
<td>-0.783333</td>
<td>1.783333</td>
<td>0.030792</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1981-01-01</td>
<td>-795.958126</td>
<td>0.000000</td>
<td>-795.958126</td>
<td>81.181763</td>
<td>259.795177</td>
<td>2417.616038</td>
<td>78.509306</td>
<td>503.808699</td>
<td>-1380.316848</td>
<td>-0.100000</td>
<td>0.925000</td>
<td>-0.002150</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1982-01-01</td>
<td>-1113.869651</td>
<td>0.000000</td>
<td>-1113.869651</td>
<td>-62.503803</td>
<td>133.912455</td>
<td>-286.318941</td>
<td>-52.169623</td>
<td>1840.418278</td>
<td>3117.028595</td>
<td>0.016667</td>
<td>1.450000</td>
<td>0.029483</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1983-01-01</td>
<td>1114.041596</td>
<td>1114.041596</td>
<td>0.000000</td>
<td>131.933427</td>
<td>-242.707181</td>
<td>5.102961</td>
<td>110.880183</td>
<td>-792.779158</td>
<td>-1690.269779</td>
<td>3.866667</td>
<td>-3.225000</td>
<td>0.034967</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1984-01-01</td>
<td>304.752020</td>
<td>304.752020</td>
<td>0.000000</td>
<td>22.658992</td>
<td>-92.189386</td>
<td>716.410620</td>
<td>49.949560</td>
<td>-168.903301</td>
<td>-1070.585987</td>
<td>3.258333</td>
<td>-2.458333</td>
<td>-0.001275</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1985-01-01</td>
<td>-366.991657</td>
<td>0.000000</td>
<td>-366.991657</td>
<td>-70.104285</td>
<td>14.361613</td>
<td>92.664162</td>
<td>-49.714652</td>
<td>1548.910801</td>
<td>1829.266316</td>
<td>0.400000</td>
<td>0.116667</td>
<td>0.062567</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1986-01-01</td>
<td>-2451.586574</td>
<td>0.000000</td>
<td>-2451.586574</td>
<td>-371.744807</td>
<td>159.793281</td>
<td>-681.904345</td>
<td>95.031719</td>
<td>-1006.031688</td>
<td>2434.442476</td>
<td>-1.633333</td>
<td>1.558333</td>
<td>0.070750</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1987-01-01</td>
<td>743.692037</td>
<td>743.692037</td>
<td>0.000000</td>
<td>153.866579</td>
<td>329.611786</td>
<td>539.538581</td>
<td>222.273420</td>
<td>-1071.281516</td>
<td>-2615.717079</td>
<td>0.233333</td>
<td>-0.141667</td>
<td>0.023867</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1988-01-01</td>
<td>-518.164793</td>
<td>0.000000</td>
<td>-518.164793</td>
<td>67.174276</td>
<td>-224.515238</td>
<td>338.084366</td>
<td>168.910804</td>
<td>-16.895010</td>
<td>489.437183</td>
<td>-0.483333</td>
<td>0.100000</td>
<td>-0.063592</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1989-01-01</td>
<td>25.506344</td>
<td>25.506344</td>
<td>0.000000</td>
<td>-29.373936</td>
<td>293.129430</td>
<td>-101.490177</td>
<td>210.645362</td>
<td>-29.534180</td>
<td>-6.660479</td>
<td>-1.541667</td>
<td>1.475000</td>
<td>-0.095233</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1990-01-01</td>
<td>197.224034</td>
<td>197.224034</td>
<td>0.000000</td>
<td>34.978568</td>
<td>45.208628</td>
<td>-27.139354</td>
<td>57.830682</td>
<td>-130.703028</td>
<td>-323.144222</td>
<td>-0.825000</td>
<td>0.591667</td>
<td>-0.046833</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1991-01-01</td>
<td>-584.846863</td>
<td>0.000000</td>
<td>-584.846863</td>
<td>-89.854509</td>
<td>29.157325</td>
<td>-391.046061</td>
<td>-45.231681</td>
<td>-553.837536</td>
<td>437.520891</td>
<td>-0.241667</td>
<td>-0.016667</td>
<td>-0.017092</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1992-01-01</td>
<td>64.165615</td>
<td>64.165615</td>
<td>0.000000</td>
<td>-75.508867</td>
<td>-231.401242</td>
<td>315.638496</td>
<td>41.940598</td>
<td>429.340791</td>
<td>398.387388</td>
<td>1.333333</td>
<td>-0.908333</td>
<td>-0.021042</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1993-01-01</td>
<td>366.503452</td>
<td>366.503452</td>
<td>0.000000</td>
<td>127.189967</td>
<td>8.224851</td>
<td>-10.051816</td>
<td>126.182874</td>
<td>-922.582134</td>
<td>-1288.265714</td>
<td>1.208333</td>
<td>-1.208333</td>
<td>0.062833</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1994-01-01</td>
<td>298.845156</td>
<td>298.845156</td>
<td>0.000000</td>
<td>120.739891</td>
<td>66.827798</td>
<td>-275.184458</td>
<td>29.220498</td>
<td>-1263.226429</td>
<td>-1445.234319</td>
<td>0.125000</td>
<td>-0.508333</td>
<td>0.081358</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1995-01-01</td>
<td>-424.015919</td>
<td>0.000000</td>
<td>-424.015919</td>
<td>131.202242</td>
<td>2.596401</td>
<td>-439.897302</td>
<td>-74.640409</td>
<td>-762.191041</td>
<td>-106.716872</td>
<td>-0.800000</td>
<td>0.850000</td>
<td>0.075725</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1996-01-01</td>
<td>657.264596</td>
<td>657.264596</td>
<td>0.000000</td>
<td>14.958707</td>
<td>86.803365</td>
<td>-433.673297</td>
<td>-162.251681</td>
<td>-255.745595</td>
<td>-743.350647</td>
<td>-0.941667</td>
<td>0.925000</td>
<td>0.006758</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1997-01-01</td>
<td>-230.011377</td>
<td>0.000000</td>
<td>-230.011377</td>
<td>212.881242</td>
<td>162.512585</td>
<td>96.104917</td>
<td>-109.411649</td>
<td>311.889310</td>
<td>-39.009707</td>
<td>-0.958333</td>
<td>0.666667</td>
<td>-0.008950</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-01-01</td>
<td>-821.938330</td>
<td>0.000000</td>
<td>-821.938330</td>
<td>-135.687474</td>
<td>313.817676</td>
<td>-184.948302</td>
<td>5.789059</td>
<td>49.200923</td>
<td>883.746412</td>
<td>-1.008333</td>
<td>0.608333</td>
<td>0.021167</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1999-01-01</td>
<td>1109.397825</td>
<td>1109.397825</td>
<td>0.000000</td>
<td>-244.269810</td>
<td>148.547641</td>
<td>273.965461</td>
<td>-247.511966</td>
<td>694.792990</td>
<td>-840.360093</td>
<td>-0.291667</td>
<td>0.641667</td>
<td>0.098767</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-01</td>
<td>2757.757519</td>
<td>2757.757519</td>
<td>0.000000</td>
<td>340.139894</td>
<td>-690.661386</td>
<td>-291.566666</td>
<td>-12.745271</td>
<td>367.958900</td>
<td>-1760.455732</td>
<td>0.083333</td>
<td>-0.066667</td>
<td>0.002192</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2001-01-01</td>
<td>-2232.303933</td>
<td>0.000000</td>
<td>-2232.303933</td>
<td>56.816619</td>
<td>35.595123</td>
<td>-27.982751</td>
<td>-114.750162</td>
<td>627.934302</td>
<td>2681.059082</td>
<td>-0.700000</td>
<td>0.175000</td>
<td>-0.000308</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-01</td>
<td>241.138725</td>
<td>241.138725</td>
<td>0.000000</td>
<td>-148.390689</td>
<td>181.531943</td>
<td>-500.759694</td>
<td>-150.597911</td>
<td>-511.790721</td>
<td>-435.908918</td>
<td>-0.241667</td>
<td>0.300000</td>
<td>0.063500</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2003-01-01</td>
<td>38.507474</td>
<td>38.507474</td>
<td>0.000000</td>
<td>-186.762753</td>
<td>-218.560977</td>
<td>1105.700627</td>
<td>-97.357661</td>
<td>63.349341</td>
<td>-772.892691</td>
<td>0.616667</td>
<td>0.000000</td>
<td>0.021575</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-01-01</td>
<td>730.190654</td>
<td>730.190654</td>
<td>0.000000</td>
<td>245.970162</td>
<td>-45.066727</td>
<td>114.727320</td>
<td>8.934454</td>
<td>673.630593</td>
<td>-363.256361</td>
<td>-0.225000</td>
<td>0.766667</td>
<td>-0.169425</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2005-01-01</td>
<td>922.518162</td>
<td>922.518162</td>
<td>0.000000</td>
<td>170.457209</td>
<td>-70.989711</td>
<td>173.905095</td>
<td>-26.011829</td>
<td>689.483910</td>
<td>-532.418673</td>
<td>-0.525000</td>
<td>0.383333</td>
<td>-0.099592</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2006-01-01</td>
<td>-886.089729</td>
<td>0.000000</td>
<td>-886.089729</td>
<td>173.217986</td>
<td>936.866393</td>
<td>-10.610252</td>
<td>-18.073730</td>
<td>238.566715</td>
<td>7.108587</td>
<td>-0.650000</td>
<td>-0.275000</td>
<td>-0.090092</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2007-01-01</td>
<td>-584.342016</td>
<td>0.000000</td>
<td>-584.342016</td>
<td>268.999623</td>
<td>19.207126</td>
<td>-490.926955</td>
<td>-5.875584</td>
<td>601.592831</td>
<td>1382.779468</td>
<td>-0.483333</td>
<td>0.941667</td>
<td>-0.077108</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2008-01-01</td>
<td>393.424107</td>
<td>393.424107</td>
<td>0.000000</td>
<td>-221.427184</td>
<td>-6.663868</td>
<td>-1268.721100</td>
<td>-5.623041</td>
<td>388.103413</td>
<td>1485.868417</td>
<td>0.108333</td>
<td>0.591667</td>
<td>-0.060192</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2009-01-01</td>
<td>-1667.349199</td>
<td>0.000000</td>
<td>-1667.349199</td>
<td>125.550103</td>
<td>-315.651432</td>
<td>1565.111650</td>
<td>46.330578</td>
<td>-289.046007</td>
<td>49.623450</td>
<td>0.125000</td>
<td>0.416667</td>
<td>-0.007417</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2010-01-01</td>
<td>446.933388</td>
<td>446.933388</td>
<td>0.000000</td>
<td>-463.012491</td>
<td>-134.196272</td>
<td>-310.113274</td>
<td>29.969873</td>
<td>216.193180</td>
<td>706.551703</td>
<td>2.883333</td>
<td>-2.383333</td>
<td>0.074675</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2011-01-01</td>
<td>830.161197</td>
<td>830.161197</td>
<td>0.000000</td>
<td>61.104990</td>
<td>181.653671</td>
<td>-172.434726</td>
<td>2.380217</td>
<td>-119.755144</td>
<td>-1017.860060</td>
<td>-0.058333</td>
<td>-1.283333</td>
<td>-0.111317</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2012-01-01</td>
<td>-1186.571695</td>
<td>0.000000</td>
<td>-1186.571695</td>
<td>267.430159</td>
<td>216.577571</td>
<td>116.087749</td>
<td>-0.987183</td>
<td>202.745156</td>
<td>788.234188</td>
<td>-1.083333</td>
<td>1.375000</td>
<td>-0.041100</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2013-01-01</td>
<td>396.701645</td>
<td>396.701645</td>
<td>0.000000</td>
<td>143.733151</td>
<td>139.075529</td>
<td>645.385041</td>
<td>15.257883</td>
<td>311.983040</td>
<td>-997.654445</td>
<td>-0.733333</td>
<td>0.450000</td>
<td>0.010383</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2014-01-01</td>
<td>-289.053915</td>
<td>0.000000</td>
<td>-289.053915</td>
<td>5.088233</td>
<td>-12.268558</td>
<td>-313.237415</td>
<td>23.739849</td>
<td>-796.621934</td>
<td>-163.410431</td>
<td>-0.041667</td>
<td>-0.366667</td>
<td>0.030583</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2015-01-01</td>
<td>-1591.443473</td>
<td>0.000000</td>
<td>-1591.443473</td>
<td>-438.301999</td>
<td>-0.178887</td>
<td>-482.144162</td>
<td>-6.057110</td>
<td>-341.936691</td>
<td>2164.074720</td>
<td>0.116667</td>
<td>-0.533333</td>
<td>0.074692</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2016-01-01</td>
<td>58.768905</td>
<td>58.768905</td>
<td>0.000000</td>
<td>-127.155353</td>
<td>-208.675326</td>
<td>-85.226565</td>
<td>53.886937</td>
<td>658.025579</td>
<td>1074.200854</td>
<td>1.316667</td>
<td>-0.650000</td>
<td>0.174125</td>
<td>0.0</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-98" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>mdfl_err</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">program_expenditure</th>
<th data-quarto-table-cell-role="th">debt_service</th>
<th data-quarto-table-cell-role="th">corporate_income_tax</th>
<th data-quarto-table-cell-role="th">personal_income_tax</th>
<th data-quarto-table-cell-role="th">other_revenue</th>
<th data-quarto-table-cell-role="th">natural_resource_revenue</th>
<th data-quarto-table-cell-role="th">deficit</th>
<th data-quarto-table-cell-role="th">heritage_dummy</th>
<th data-quarto-table-cell-role="th">ur_lag</th>
<th data-quarto-table-cell-role="th">er_lag</th>
<th data-quarto-table-cell-role="th">cad_usd_lag</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">budget_dt</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1964-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1965-01-01</td>
<td>2327.844291</td>
<td>11.272854</td>
<td>174.729232</td>
<td>231.093501</td>
<td>1442.925275</td>
<td>1397.833860</td>
<td>-907.464724</td>
<td>0.0</td>
<td>2.500000</td>
<td>37.935748</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1966-01-01</td>
<td>2891.984579</td>
<td>10.750872</td>
<td>145.136773</td>
<td>301.024417</td>
<td>1542.750138</td>
<td>1290.104645</td>
<td>-376.280521</td>
<td>0.0</td>
<td>2.500000</td>
<td>37.935748</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1967-01-01</td>
<td>4436.875339</td>
<td>10.199713</td>
<td>203.994268</td>
<td>407.988537</td>
<td>2351.033944</td>
<td>1116.868620</td>
<td>367.189683</td>
<td>0.0</td>
<td>2.500000</td>
<td>37.935748</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1968-01-01</td>
<td>4368.535726</td>
<td>19.160244</td>
<td>239.503055</td>
<td>469.425988</td>
<td>2639.323668</td>
<td>1360.377353</td>
<td>-320.934094</td>
<td>0.0</td>
<td>2.700000</td>
<td>38.322148</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1969-01-01</td>
<td>4396.849967</td>
<td>17.909776</td>
<td>286.556413</td>
<td>599.977490</td>
<td>2444.684401</td>
<td>1141.748209</td>
<td>-58.206771</td>
<td>0.0</td>
<td>3.300000</td>
<td>39.041995</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1970-01-01</td>
<td>4745.762712</td>
<td>38.135593</td>
<td>245.762712</td>
<td>771.186441</td>
<td>2737.288136</td>
<td>978.813559</td>
<td>50.847458</td>
<td>0.0</td>
<td>3.400000</td>
<td>39.833226</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1971-01-01</td>
<td>4993.823780</td>
<td>67.916003</td>
<td>271.664014</td>
<td>767.051333</td>
<td>2848.477084</td>
<td>1090.651114</td>
<td>83.896240</td>
<td>0.0</td>
<td>5.200000</td>
<td>39.686520</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1972-01-01</td>
<td>4988.477844</td>
<td>85.114978</td>
<td>362.663820</td>
<td>858.551083</td>
<td>2768.087112</td>
<td>1224.915554</td>
<td>-140.624746</td>
<td>0.0</td>
<td>5.700000</td>
<td>38.456938</td>
<td>1.009883</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1973-01-01</td>
<td>5004.356719</td>
<td>81.151731</td>
<td>382.089398</td>
<td>977.202089</td>
<td>2387.213408</td>
<td>2160.664826</td>
<td>-821.661272</td>
<td>0.0</td>
<td>5.700000</td>
<td>39.470588</td>
<td>0.990792</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-01-01</td>
<td>6124.378806</td>
<td>92.793618</td>
<td>829.155879</td>
<td>1038.689856</td>
<td>2352.767225</td>
<td>4549.880638</td>
<td>-2553.321174</td>
<td>0.0</td>
<td>5.300000</td>
<td>40.843443</td>
<td>1.000233</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1975-01-01</td>
<td>7071.218716</td>
<td>84.149869</td>
<td>686.347373</td>
<td>925.648564</td>
<td>2721.722340</td>
<td>4417.868145</td>
<td>-1596.217836</td>
<td>0.0</td>
<td>3.500000</td>
<td>42.840909</td>
<td>0.978133</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1976-01-01</td>
<td>6845.363213</td>
<td>59.113672</td>
<td>326.307469</td>
<td>1038.036080</td>
<td>2830.362613</td>
<td>4887.518397</td>
<td>-2177.747675</td>
<td>1.0</td>
<td>4.200000</td>
<td>43.439912</td>
<td>1.017267</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1977-01-01</td>
<td>7061.151803</td>
<td>46.247496</td>
<td>554.969954</td>
<td>1206.639219</td>
<td>2720.193639</td>
<td>4513.335196</td>
<td>-1887.738708</td>
<td>1.0</td>
<td>3.891667</td>
<td>64.800000</td>
<td>0.986075</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1978-01-01</td>
<td>6825.084687</td>
<td>48.260049</td>
<td>545.709790</td>
<td>1225.062794</td>
<td>2643.165786</td>
<td>4701.642511</td>
<td>-2242.236144</td>
<td>1.0</td>
<td>4.475000</td>
<td>64.633333</td>
<td>1.063525</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1979-01-01</td>
<td>9302.990086</td>
<td>32.774318</td>
<td>342.491620</td>
<td>1265.088664</td>
<td>2525.261181</td>
<td>5181.619632</td>
<td>21.303307</td>
<td>1.0</td>
<td>4.750000</td>
<td>65.341667</td>
<td>1.140767</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1980-01-01</td>
<td>9937.742745</td>
<td>31.376340</td>
<td>620.395823</td>
<td>1337.773062</td>
<td>2676.972321</td>
<td>4797.727697</td>
<td>536.250183</td>
<td>1.0</td>
<td>3.966667</td>
<td>67.125000</td>
<td>1.171558</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1981-01-01</td>
<td>10441.551444</td>
<td>109.885646</td>
<td>701.577586</td>
<td>1597.568239</td>
<td>5094.588359</td>
<td>4001.769572</td>
<td>-844.066666</td>
<td>1.0</td>
<td>3.866667</td>
<td>68.050000</td>
<td>1.169408</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1982-01-01</td>
<td>12281.969722</td>
<td>57.716023</td>
<td>639.073783</td>
<td>1731.480694</td>
<td>4808.269418</td>
<td>2887.899921</td>
<td>2272.961929</td>
<td>1.0</td>
<td>3.883333</td>
<td>69.500000</td>
<td>1.198892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1983-01-01</td>
<td>11489.190564</td>
<td>168.596206</td>
<td>771.007210</td>
<td>1488.773513</td>
<td>4813.372379</td>
<td>4001.941517</td>
<td>582.692150</td>
<td>1.0</td>
<td>7.750000</td>
<td>66.275000</td>
<td>1.233858</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1984-01-01</td>
<td>11320.287262</td>
<td>218.545766</td>
<td>793.666203</td>
<td>1396.584127</td>
<td>5529.782999</td>
<td>4306.693537</td>
<td>-487.893837</td>
<td>1.0</td>
<td>11.008333</td>
<td>63.816667</td>
<td>1.232583</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1985-01-01</td>
<td>12869.198063</td>
<td>168.831114</td>
<td>723.561918</td>
<td>1410.945740</td>
<td>5622.447161</td>
<td>3939.701880</td>
<td>1341.372479</td>
<td>1.0</td>
<td>11.408333</td>
<td>63.933333</td>
<td>1.295150</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1986-01-01</td>
<td>11863.166376</td>
<td>263.862833</td>
<td>351.817111</td>
<td>1570.739021</td>
<td>4940.542816</td>
<td>1488.115306</td>
<td>3775.814955</td>
<td>1.0</td>
<td>9.775000</td>
<td>65.491667</td>
<td>1.365900</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1987-01-01</td>
<td>10791.884860</td>
<td>486.136253</td>
<td>505.683690</td>
<td>1900.350807</td>
<td>5480.081397</td>
<td>2231.807343</td>
<td>1160.097876</td>
<td>0.0</td>
<td>10.008333</td>
<td>65.350000</td>
<td>1.389767</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1988-01-01</td>
<td>10774.989850</td>
<td>655.047057</td>
<td>572.857965</td>
<td>1675.835569</td>
<td>5818.165763</td>
<td>1713.642551</td>
<td>1649.535059</td>
<td>0.0</td>
<td>9.525000</td>
<td>65.450000</td>
<td>1.326175</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1989-01-01</td>
<td>10745.455671</td>
<td>865.692419</td>
<td>543.484030</td>
<td>1968.964999</td>
<td>5716.675586</td>
<td>1739.148895</td>
<td>1642.874581</td>
<td>0.0</td>
<td>7.983333</td>
<td>66.925000</td>
<td>1.230942</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1990-01-01</td>
<td>10614.752643</td>
<td>923.523101</td>
<td>578.462597</td>
<td>2014.173627</td>
<td>5689.536231</td>
<td>1936.372929</td>
<td>1319.730359</td>
<td>0.0</td>
<td>7.158333</td>
<td>67.516667</td>
<td>1.184108</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1991-01-01</td>
<td>10060.915107</td>
<td>878.291420</td>
<td>488.608088</td>
<td>2043.330951</td>
<td>5298.490171</td>
<td>1351.526066</td>
<td>1757.251250</td>
<td>0.0</td>
<td>6.916667</td>
<td>67.500000</td>
<td>1.167017</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1992-01-01</td>
<td>10490.255898</td>
<td>920.232018</td>
<td>413.099221</td>
<td>1811.929709</td>
<td>5614.128666</td>
<td>1415.691681</td>
<td>2155.638638</td>
<td>0.0</td>
<td>8.250000</td>
<td>66.591667</td>
<td>1.145975</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1993-01-01</td>
<td>9567.673764</td>
<td>1046.414892</td>
<td>540.289188</td>
<td>1820.154561</td>
<td>5604.076850</td>
<td>1782.195133</td>
<td>867.372924</td>
<td>0.0</td>
<td>9.458333</td>
<td>65.383333</td>
<td>1.208808</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1994-01-01</td>
<td>8304.447335</td>
<td>1075.635389</td>
<td>661.029079</td>
<td>1886.982358</td>
<td>5328.892392</td>
<td>2081.040289</td>
<td>-577.861395</td>
<td>0.0</td>
<td>9.583333</td>
<td>64.875000</td>
<td>1.290167</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1995-01-01</td>
<td>7542.256294</td>
<td>1000.994980</td>
<td>792.231321</td>
<td>1889.578759</td>
<td>4888.995090</td>
<td>1657.024370</td>
<td>-684.578266</td>
<td>0.0</td>
<td>8.783333</td>
<td>65.725000</td>
<td>1.365892</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1996-01-01</td>
<td>7286.510699</td>
<td>838.743299</td>
<td>807.190029</td>
<td>1976.382124</td>
<td>4455.321793</td>
<td>2314.288966</td>
<td>-1427.928914</td>
<td>0.0</td>
<td>7.841667</td>
<td>66.650000</td>
<td>1.372650</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1997-01-01</td>
<td>7598.400009</td>
<td>729.331650</td>
<td>1020.071271</td>
<td>2138.894710</td>
<td>4551.426710</td>
<td>2084.277589</td>
<td>-1466.938621</td>
<td>0.0</td>
<td>6.883333</td>
<td>67.316667</td>
<td>1.363700</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-01-01</td>
<td>7647.600932</td>
<td>735.120709</td>
<td>884.383797</td>
<td>2452.712386</td>
<td>4366.478407</td>
<td>1262.339259</td>
<td>-583.192208</td>
<td>0.0</td>
<td>5.875000</td>
<td>67.925000</td>
<td>1.384867</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1999-01-01</td>
<td>8342.393922</td>
<td>487.608742</td>
<td>640.113987</td>
<td>2601.260027</td>
<td>4640.443868</td>
<td>2371.737084</td>
<td>-1423.552301</td>
<td>0.0</td>
<td>5.583333</td>
<td>68.566667</td>
<td>1.483633</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-01</td>
<td>8710.352822</td>
<td>474.863472</td>
<td>980.253881</td>
<td>1910.598641</td>
<td>4348.877202</td>
<td>5129.494603</td>
<td>-3184.008033</td>
<td>0.0</td>
<td>5.666667</td>
<td>68.500000</td>
<td>1.485825</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2001-01-01</td>
<td>9338.287124</td>
<td>360.113309</td>
<td>1037.070500</td>
<td>1946.193764</td>
<td>4320.894451</td>
<td>2897.190669</td>
<td>-502.948950</td>
<td>0.0</td>
<td>4.966667</td>
<td>68.675000</td>
<td>1.485517</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-01</td>
<td>8826.496403</td>
<td>209.515399</td>
<td>888.679810</td>
<td>2127.725707</td>
<td>3820.134757</td>
<td>3138.329395</td>
<td>-938.857868</td>
<td>0.0</td>
<td>4.725000</td>
<td>68.975000</td>
<td>1.549017</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2003-01-01</td>
<td>8889.845744</td>
<td>112.157737</td>
<td>701.917057</td>
<td>1909.164731</td>
<td>4925.835384</td>
<td>3176.836868</td>
<td>-1711.750559</td>
<td>0.0</td>
<td>5.341667</td>
<td>68.975000</td>
<td>1.570592</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-01-01</td>
<td>9563.476337</td>
<td>121.092191</td>
<td>947.887219</td>
<td>1864.098004</td>
<td>5040.562703</td>
<td>3907.027522</td>
<td>-2075.006920</td>
<td>0.0</td>
<td>5.116667</td>
<td>69.741667</td>
<td>1.401167</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2005-01-01</td>
<td>10252.960247</td>
<td>95.080363</td>
<td>1118.344428</td>
<td>1793.108293</td>
<td>5214.467798</td>
<td>4829.545684</td>
<td>-2607.425593</td>
<td>1.0</td>
<td>4.591667</td>
<td>70.125000</td>
<td>1.301575</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2006-01-01</td>
<td>10491.526962</td>
<td>77.006633</td>
<td>1291.562414</td>
<td>2729.974686</td>
<td>5203.857546</td>
<td>3943.455955</td>
<td>-2600.317006</td>
<td>1.0</td>
<td>3.941667</td>
<td>69.850000</td>
<td>1.211483</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2007-01-01</td>
<td>11093.119793</td>
<td>71.131049</td>
<td>1560.562037</td>
<td>2749.181812</td>
<td>4712.930591</td>
<td>3359.113940</td>
<td>-1217.537538</td>
<td>1.0</td>
<td>3.458333</td>
<td>70.791667</td>
<td>1.134375</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2008-01-01</td>
<td>11481.223206</td>
<td>65.508008</td>
<td>1339.134853</td>
<td>2742.517945</td>
<td>3444.209491</td>
<td>3752.538047</td>
<td>268.330878</td>
<td>0.0</td>
<td>3.566667</td>
<td>71.383333</td>
<td>1.074183</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2009-01-01</td>
<td>11192.177199</td>
<td>111.838586</td>
<td>1464.684956</td>
<td>2426.866512</td>
<td>5009.321141</td>
<td>2085.188848</td>
<td>317.954328</td>
<td>0.0</td>
<td>3.691667</td>
<td>71.800000</td>
<td>1.066767</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2010-01-01</td>
<td>11408.370379</td>
<td>141.808459</td>
<td>1001.672465</td>
<td>2292.670240</td>
<td>4699.207866</td>
<td>2532.122236</td>
<td>1024.506031</td>
<td>0.0</td>
<td>6.575000</td>
<td>69.416667</td>
<td>1.141442</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2011-01-01</td>
<td>11288.615235</td>
<td>144.188676</td>
<td>1062.777455</td>
<td>2474.323912</td>
<td>4526.773140</td>
<td>3362.283433</td>
<td>6.645971</td>
<td>0.0</td>
<td>6.516667</td>
<td>68.133333</td>
<td>1.030125</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2012-01-01</td>
<td>11491.360391</td>
<td>143.201492</td>
<td>1330.207614</td>
<td>2690.901483</td>
<td>4642.860889</td>
<td>2175.711738</td>
<td>794.880159</td>
<td>0.0</td>
<td>5.433333</td>
<td>69.508333</td>
<td>0.989025</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2013-01-01</td>
<td>11803.343431</td>
<td>158.459375</td>
<td>1473.940765</td>
<td>2829.977012</td>
<td>5288.245930</td>
<td>2572.413384</td>
<td>-202.774285</td>
<td>0.0</td>
<td>4.700000</td>
<td>69.958333</td>
<td>0.999408</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2014-01-01</td>
<td>11006.721496</td>
<td>182.199224</td>
<td>1479.028999</td>
<td>2817.708454</td>
<td>4975.008515</td>
<td>2283.359468</td>
<td>-366.184716</td>
<td>0.0</td>
<td>4.658333</td>
<td>69.591667</td>
<td>1.029992</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2015-01-01</td>
<td>10664.784806</td>
<td>176.142114</td>
<td>1040.727000</td>
<td>2817.529567</td>
<td>4492.864354</td>
<td>691.915996</td>
<td>1797.890004</td>
<td>0.0</td>
<td>4.775000</td>
<td>69.058333</td>
<td>1.104683</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2016-01-01</td>
<td>11322.810385</td>
<td>230.029051</td>
<td>913.571647</td>
<td>2608.854241</td>
<td>4407.637789</td>
<td>750.684901</td>
<td>2872.090858</td>
<td>0.0</td>
<td>6.091667</td>
<td>68.408333</td>
<td>1.278808</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2017-01-01</td>
<td>11433.853017</td>
<td>319.856119</td>
<td>813.921696</td>
<td>2543.505301</td>
<td>5094.564399</td>
<td>1175.559759</td>
<td>2126.157981</td>
<td>0.0</td>
<td>8.133333</td>
<td>66.250000</td>
<td>1.325583</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018-01-01</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7.883333</td>
<td>66.316667</td>
<td>1.297858</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-99" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>model_df_first_diff(mdfl_err)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">natural_resource_revenue</th>
<th data-quarto-table-cell-role="th">nrri</th>
<th data-quarto-table-cell-role="th">nrrd</th>
<th data-quarto-table-cell-role="th">corporate_income_tax</th>
<th data-quarto-table-cell-role="th">personal_income_tax</th>
<th data-quarto-table-cell-role="th">other_revenue</th>
<th data-quarto-table-cell-role="th">debt_service</th>
<th data-quarto-table-cell-role="th">program_expenditure</th>
<th data-quarto-table-cell-role="th">deficit</th>
<th data-quarto-table-cell-role="th">ur_lag</th>
<th data-quarto-table-cell-role="th">er_lag</th>
<th data-quarto-table-cell-role="th">cad_usd_lag</th>
<th data-quarto-table-cell-role="th">heritage_dummy</th>
<th data-quarto-table-cell-role="th">constant</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">budget_dt</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1970-01-01</td>
<td>-162.934650</td>
<td>0.000000</td>
<td>-162.934650</td>
<td>-40.793701</td>
<td>171.208950</td>
<td>292.603734</td>
<td>20.225817</td>
<td>348.912745</td>
<td>109.054229</td>
<td>0.100000</td>
<td>0.791232</td>
<td>NaN</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1971-01-01</td>
<td>111.837554</td>
<td>111.837554</td>
<td>0.000000</td>
<td>25.901302</td>
<td>-4.135108</td>
<td>111.188949</td>
<td>29.780410</td>
<td>248.061068</td>
<td>33.048782</td>
<td>1.800000</td>
<td>-0.146706</td>
<td>NaN</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1972-01-01</td>
<td>134.264440</td>
<td>134.264440</td>
<td>0.000000</td>
<td>90.999806</td>
<td>91.499750</td>
<td>-80.389972</td>
<td>17.198975</td>
<td>-5.345936</td>
<td>-224.520986</td>
<td>0.500000</td>
<td>-1.229583</td>
<td>NaN</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1973-01-01</td>
<td>935.749273</td>
<td>935.749273</td>
<td>0.000000</td>
<td>19.425579</td>
<td>118.651006</td>
<td>-380.873704</td>
<td>-3.963247</td>
<td>15.878875</td>
<td>-681.036526</td>
<td>0.000000</td>
<td>1.013650</td>
<td>-0.019092</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1974-01-01</td>
<td>2389.215812</td>
<td>2389.215812</td>
<td>0.000000</td>
<td>447.066481</td>
<td>61.487767</td>
<td>-34.446183</td>
<td>11.641888</td>
<td>1120.022088</td>
<td>-1731.659902</td>
<td>-0.400000</td>
<td>1.372855</td>
<td>0.009442</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1975-01-01</td>
<td>-132.012493</td>
<td>0.000000</td>
<td>-132.012493</td>
<td>-142.808507</td>
<td>-113.041292</td>
<td>368.955115</td>
<td>-8.643749</td>
<td>946.839909</td>
<td>957.103338</td>
<td>-1.800000</td>
<td>1.997466</td>
<td>-0.022100</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1976-01-01</td>
<td>469.650252</td>
<td>469.650252</td>
<td>0.000000</td>
<td>-360.039903</td>
<td>112.387516</td>
<td>108.640274</td>
<td>-25.036197</td>
<td>-225.855503</td>
<td>-581.529839</td>
<td>0.700000</td>
<td>0.599003</td>
<td>0.039133</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1977-01-01</td>
<td>-374.183202</td>
<td>0.000000</td>
<td>-374.183202</td>
<td>228.662485</td>
<td>168.603139</td>
<td>-110.168974</td>
<td>-12.866176</td>
<td>215.788591</td>
<td>290.008967</td>
<td>-0.308333</td>
<td>21.360088</td>
<td>-0.031192</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1978-01-01</td>
<td>188.307315</td>
<td>188.307315</td>
<td>0.000000</td>
<td>-9.260164</td>
<td>18.423575</td>
<td>-77.027853</td>
<td>2.012553</td>
<td>-236.067116</td>
<td>-354.497436</td>
<td>0.583333</td>
<td>-0.166667</td>
<td>0.077450</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1979-01-01</td>
<td>479.977121</td>
<td>479.977121</td>
<td>0.000000</td>
<td>-203.218170</td>
<td>40.025870</td>
<td>-117.904605</td>
<td>-15.485732</td>
<td>2477.905398</td>
<td>2263.539451</td>
<td>0.275000</td>
<td>0.708333</td>
<td>0.077242</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1980-01-01</td>
<td>-383.891935</td>
<td>0.000000</td>
<td>-383.891935</td>
<td>277.904203</td>
<td>72.684398</td>
<td>151.711140</td>
<td>-1.397977</td>
<td>634.752660</td>
<td>514.946876</td>
<td>-0.783333</td>
<td>1.783333</td>
<td>0.030792</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1981-01-01</td>
<td>-795.958126</td>
<td>0.000000</td>
<td>-795.958126</td>
<td>81.181763</td>
<td>259.795177</td>
<td>2417.616038</td>
<td>78.509306</td>
<td>503.808699</td>
<td>-1380.316848</td>
<td>-0.100000</td>
<td>0.925000</td>
<td>-0.002150</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1982-01-01</td>
<td>-1113.869651</td>
<td>0.000000</td>
<td>-1113.869651</td>
<td>-62.503803</td>
<td>133.912455</td>
<td>-286.318941</td>
<td>-52.169623</td>
<td>1840.418278</td>
<td>3117.028595</td>
<td>0.016667</td>
<td>1.450000</td>
<td>0.029483</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1983-01-01</td>
<td>1114.041596</td>
<td>1114.041596</td>
<td>0.000000</td>
<td>131.933427</td>
<td>-242.707181</td>
<td>5.102961</td>
<td>110.880183</td>
<td>-792.779158</td>
<td>-1690.269779</td>
<td>3.866667</td>
<td>-3.225000</td>
<td>0.034967</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1984-01-01</td>
<td>304.752020</td>
<td>304.752020</td>
<td>0.000000</td>
<td>22.658992</td>
<td>-92.189386</td>
<td>716.410620</td>
<td>49.949560</td>
<td>-168.903301</td>
<td>-1070.585987</td>
<td>3.258333</td>
<td>-2.458333</td>
<td>-0.001275</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1985-01-01</td>
<td>-366.991657</td>
<td>0.000000</td>
<td>-366.991657</td>
<td>-70.104285</td>
<td>14.361613</td>
<td>92.664162</td>
<td>-49.714652</td>
<td>1548.910801</td>
<td>1829.266316</td>
<td>0.400000</td>
<td>0.116667</td>
<td>0.062567</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1986-01-01</td>
<td>-2451.586574</td>
<td>0.000000</td>
<td>-2451.586574</td>
<td>-371.744807</td>
<td>159.793281</td>
<td>-681.904345</td>
<td>95.031719</td>
<td>-1006.031688</td>
<td>2434.442476</td>
<td>-1.633333</td>
<td>1.558333</td>
<td>0.070750</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1987-01-01</td>
<td>743.692037</td>
<td>743.692037</td>
<td>0.000000</td>
<td>153.866579</td>
<td>329.611786</td>
<td>539.538581</td>
<td>222.273420</td>
<td>-1071.281516</td>
<td>-2615.717079</td>
<td>0.233333</td>
<td>-0.141667</td>
<td>0.023867</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1988-01-01</td>
<td>-518.164793</td>
<td>0.000000</td>
<td>-518.164793</td>
<td>67.174276</td>
<td>-224.515238</td>
<td>338.084366</td>
<td>168.910804</td>
<td>-16.895010</td>
<td>489.437183</td>
<td>-0.483333</td>
<td>0.100000</td>
<td>-0.063592</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1989-01-01</td>
<td>25.506344</td>
<td>25.506344</td>
<td>0.000000</td>
<td>-29.373936</td>
<td>293.129430</td>
<td>-101.490177</td>
<td>210.645362</td>
<td>-29.534180</td>
<td>-6.660479</td>
<td>-1.541667</td>
<td>1.475000</td>
<td>-0.095233</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1990-01-01</td>
<td>197.224034</td>
<td>197.224034</td>
<td>0.000000</td>
<td>34.978568</td>
<td>45.208628</td>
<td>-27.139354</td>
<td>57.830682</td>
<td>-130.703028</td>
<td>-323.144222</td>
<td>-0.825000</td>
<td>0.591667</td>
<td>-0.046833</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1991-01-01</td>
<td>-584.846863</td>
<td>0.000000</td>
<td>-584.846863</td>
<td>-89.854509</td>
<td>29.157325</td>
<td>-391.046061</td>
<td>-45.231681</td>
<td>-553.837536</td>
<td>437.520891</td>
<td>-0.241667</td>
<td>-0.016667</td>
<td>-0.017092</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1992-01-01</td>
<td>64.165615</td>
<td>64.165615</td>
<td>0.000000</td>
<td>-75.508867</td>
<td>-231.401242</td>
<td>315.638496</td>
<td>41.940598</td>
<td>429.340791</td>
<td>398.387388</td>
<td>1.333333</td>
<td>-0.908333</td>
<td>-0.021042</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1993-01-01</td>
<td>366.503452</td>
<td>366.503452</td>
<td>0.000000</td>
<td>127.189967</td>
<td>8.224851</td>
<td>-10.051816</td>
<td>126.182874</td>
<td>-922.582134</td>
<td>-1288.265714</td>
<td>1.208333</td>
<td>-1.208333</td>
<td>0.062833</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1994-01-01</td>
<td>298.845156</td>
<td>298.845156</td>
<td>0.000000</td>
<td>120.739891</td>
<td>66.827798</td>
<td>-275.184458</td>
<td>29.220498</td>
<td>-1263.226429</td>
<td>-1445.234319</td>
<td>0.125000</td>
<td>-0.508333</td>
<td>0.081358</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1995-01-01</td>
<td>-424.015919</td>
<td>0.000000</td>
<td>-424.015919</td>
<td>131.202242</td>
<td>2.596401</td>
<td>-439.897302</td>
<td>-74.640409</td>
<td>-762.191041</td>
<td>-106.716872</td>
<td>-0.800000</td>
<td>0.850000</td>
<td>0.075725</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1996-01-01</td>
<td>657.264596</td>
<td>657.264596</td>
<td>0.000000</td>
<td>14.958707</td>
<td>86.803365</td>
<td>-433.673297</td>
<td>-162.251681</td>
<td>-255.745595</td>
<td>-743.350647</td>
<td>-0.941667</td>
<td>0.925000</td>
<td>0.006758</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1997-01-01</td>
<td>-230.011377</td>
<td>0.000000</td>
<td>-230.011377</td>
<td>212.881242</td>
<td>162.512585</td>
<td>96.104917</td>
<td>-109.411649</td>
<td>311.889310</td>
<td>-39.009707</td>
<td>-0.958333</td>
<td>0.666667</td>
<td>-0.008950</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1998-01-01</td>
<td>-821.938330</td>
<td>0.000000</td>
<td>-821.938330</td>
<td>-135.687474</td>
<td>313.817676</td>
<td>-184.948302</td>
<td>5.789059</td>
<td>49.200923</td>
<td>883.746412</td>
<td>-1.008333</td>
<td>0.608333</td>
<td>0.021167</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1999-01-01</td>
<td>1109.397825</td>
<td>1109.397825</td>
<td>0.000000</td>
<td>-244.269810</td>
<td>148.547641</td>
<td>273.965461</td>
<td>-247.511966</td>
<td>694.792990</td>
<td>-840.360093</td>
<td>-0.291667</td>
<td>0.641667</td>
<td>0.098767</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-01</td>
<td>2757.757519</td>
<td>2757.757519</td>
<td>0.000000</td>
<td>340.139894</td>
<td>-690.661386</td>
<td>-291.566666</td>
<td>-12.745271</td>
<td>367.958900</td>
<td>-1760.455732</td>
<td>0.083333</td>
<td>-0.066667</td>
<td>0.002192</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2001-01-01</td>
<td>-2232.303933</td>
<td>0.000000</td>
<td>-2232.303933</td>
<td>56.816619</td>
<td>35.595123</td>
<td>-27.982751</td>
<td>-114.750162</td>
<td>627.934302</td>
<td>2681.059082</td>
<td>-0.700000</td>
<td>0.175000</td>
<td>-0.000308</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-01</td>
<td>241.138725</td>
<td>241.138725</td>
<td>0.000000</td>
<td>-148.390689</td>
<td>181.531943</td>
<td>-500.759694</td>
<td>-150.597911</td>
<td>-511.790721</td>
<td>-435.908918</td>
<td>-0.241667</td>
<td>0.300000</td>
<td>0.063500</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2003-01-01</td>
<td>38.507474</td>
<td>38.507474</td>
<td>0.000000</td>
<td>-186.762753</td>
<td>-218.560977</td>
<td>1105.700627</td>
<td>-97.357661</td>
<td>63.349341</td>
<td>-772.892691</td>
<td>0.616667</td>
<td>0.000000</td>
<td>0.021575</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2004-01-01</td>
<td>730.190654</td>
<td>730.190654</td>
<td>0.000000</td>
<td>245.970162</td>
<td>-45.066727</td>
<td>114.727320</td>
<td>8.934454</td>
<td>673.630593</td>
<td>-363.256361</td>
<td>-0.225000</td>
<td>0.766667</td>
<td>-0.169425</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2005-01-01</td>
<td>922.518162</td>
<td>922.518162</td>
<td>0.000000</td>
<td>170.457209</td>
<td>-70.989711</td>
<td>173.905095</td>
<td>-26.011829</td>
<td>689.483910</td>
<td>-532.418673</td>
<td>-0.525000</td>
<td>0.383333</td>
<td>-0.099592</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2006-01-01</td>
<td>-886.089729</td>
<td>0.000000</td>
<td>-886.089729</td>
<td>173.217986</td>
<td>936.866393</td>
<td>-10.610252</td>
<td>-18.073730</td>
<td>238.566715</td>
<td>7.108587</td>
<td>-0.650000</td>
<td>-0.275000</td>
<td>-0.090092</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2007-01-01</td>
<td>-584.342016</td>
<td>0.000000</td>
<td>-584.342016</td>
<td>268.999623</td>
<td>19.207126</td>
<td>-490.926955</td>
<td>-5.875584</td>
<td>601.592831</td>
<td>1382.779468</td>
<td>-0.483333</td>
<td>0.941667</td>
<td>-0.077108</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2008-01-01</td>
<td>393.424107</td>
<td>393.424107</td>
<td>0.000000</td>
<td>-221.427184</td>
<td>-6.663868</td>
<td>-1268.721100</td>
<td>-5.623041</td>
<td>388.103413</td>
<td>1485.868417</td>
<td>0.108333</td>
<td>0.591667</td>
<td>-0.060192</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2009-01-01</td>
<td>-1667.349199</td>
<td>0.000000</td>
<td>-1667.349199</td>
<td>125.550103</td>
<td>-315.651432</td>
<td>1565.111650</td>
<td>46.330578</td>
<td>-289.046007</td>
<td>49.623450</td>
<td>0.125000</td>
<td>0.416667</td>
<td>-0.007417</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2010-01-01</td>
<td>446.933388</td>
<td>446.933388</td>
<td>0.000000</td>
<td>-463.012491</td>
<td>-134.196272</td>
<td>-310.113274</td>
<td>29.969873</td>
<td>216.193180</td>
<td>706.551703</td>
<td>2.883333</td>
<td>-2.383333</td>
<td>0.074675</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2011-01-01</td>
<td>830.161197</td>
<td>830.161197</td>
<td>0.000000</td>
<td>61.104990</td>
<td>181.653671</td>
<td>-172.434726</td>
<td>2.380217</td>
<td>-119.755144</td>
<td>-1017.860060</td>
<td>-0.058333</td>
<td>-1.283333</td>
<td>-0.111317</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2012-01-01</td>
<td>-1186.571695</td>
<td>0.000000</td>
<td>-1186.571695</td>
<td>267.430159</td>
<td>216.577571</td>
<td>116.087749</td>
<td>-0.987183</td>
<td>202.745156</td>
<td>788.234188</td>
<td>-1.083333</td>
<td>1.375000</td>
<td>-0.041100</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2013-01-01</td>
<td>396.701645</td>
<td>396.701645</td>
<td>0.000000</td>
<td>143.733151</td>
<td>139.075529</td>
<td>645.385041</td>
<td>15.257883</td>
<td>311.983040</td>
<td>-997.654445</td>
<td>-0.733333</td>
<td>0.450000</td>
<td>0.010383</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2014-01-01</td>
<td>-289.053915</td>
<td>0.000000</td>
<td>-289.053915</td>
<td>5.088233</td>
<td>-12.268558</td>
<td>-313.237415</td>
<td>23.739849</td>
<td>-796.621934</td>
<td>-163.410431</td>
<td>-0.041667</td>
<td>-0.366667</td>
<td>0.030583</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2015-01-01</td>
<td>-1591.443473</td>
<td>0.000000</td>
<td>-1591.443473</td>
<td>-438.301999</td>
<td>-0.178887</td>
<td>-482.144162</td>
<td>-6.057110</td>
<td>-341.936691</td>
<td>2164.074720</td>
<td>0.116667</td>
<td>-0.533333</td>
<td>0.074692</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2016-01-01</td>
<td>58.768905</td>
<td>58.768905</td>
<td>0.000000</td>
<td>-127.155353</td>
<td>-208.675326</td>
<td>-85.226565</td>
<td>53.886937</td>
<td>658.025579</td>
<td>1074.200854</td>
<td>1.316667</td>
<td>-0.650000</td>
<td>0.174125</td>
<td>0.0</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/blog\.ianpreston\.ca");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>